import"./chunks/modulepreload-polyfill.js";import{I as Re,T as Ge,U as r,s as L,j as e,M as Ne,ac as yt,G as ze,u as ie,A as He,S as Ae,a5 as $t,ad as Cs,ae as it,af as Ce,ag as Ct,b as O,ah as kt,ai as _e,aj as Je,t as Oe,ak as ks,m as It,v as Ut,al as Is,p as Pe,am as Ft,a3 as As,an as Rs,L as Le,Q as Mt,e as Bt,ao as Ts,ap as Ve,aq as dt,P as Es,ar as ht,D as pt,O as Ps,F as _t,J as Ds,K as Ns,N as zs,$ as ae,as as ft,i as Ie,k as Ls,l as Os,n as ut,w as Wt,x as Ht,y as Us,f as mt,z as Fs,c as Ms,B as At,at as Vt,q as gt,a0 as Bs,au as _s,av as Ws,aw as Rt,ax as Hs,ay as Vs,az as Js,W as Jt,aA as Ks,aB as Gs,aC as qs,R as Ys,C as Zs,a as Tt,aD as Xs,aE as Et,aa as Qs,ab as en,E as tn,aF as sn,h as nn,aG as on}from"./chunks/vendor.js";import{g as rn}from"./chunks/index.js";const Pt="axhub-admin-active-tab",Dt="axhub-admin-create-mode",Nt="axhub-admin-generate-axure",zt="axhub-admin-create-reference",Lt="axhub-make-dark-mode",lt=[{id:"desktop",name:"电脑",width:0,height:0,type:"desktop"},{id:"mobile",name:"手机",width:10,height:21.7,type:"mobile",ratio:"21.7:10"},{id:"tablet",name:"平板",width:10,height:14.3,type:"tablet",ratio:"10:14.3"}],xt={async deleteItem(o){const d=await fetch("/api/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})});if(!d.ok){const n=await d.json();throw new Error(n.error||"删除失败")}return d.json()},async unsetReference(o){const d=await fetch("/api/unset-reference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})});if(!d.ok){const n=await d.json();throw new Error(n.error||"取消参考失败")}return d.json()},async getWsClients(){const o=await fetch("/api/ws/clients");return o.ok?(await o.json()).clients||[]:[]},async sendWsMessage(o){const d=await fetch("/api/ws/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!d.ok){const n=await d.text();throw new Error(n||"发送失败")}return d.json()},async fetchCode(o){const d=await fetch(o);if(!d.ok)throw new Error(`获取构建代码失败，请让 AI 修复: ${d.statusText}`);return d.text()},async fetchHackCss(o,d){const n=`${window.location.origin}/${o}/${d}/hack.css`;try{const y=await fetch(n);if(y.ok)return await y.text()}catch(y){console.warn("fetch hack.css failed",y)}return""},async fetchSpecMd(o,d){const n=`${window.location.origin}/${o}/${d}/spec.md`;try{const y=await fetch(n);if(y.ok)return await y.text()}catch(y){console.warn("Error fetching spec.md",y)}return""},async reviewCode(o){const d=await fetch("/api/code-review",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})});if(!d.ok){const n=await d.json();throw new Error(n.error||"代码检查失败")}return d.json()}},{TextArea:an}=Re,{Text:Ee}=Ge,ln=({open:o,onClose:d,imageConfig:n,setImageConfig:y,onDimensionChange:f,onSwapDimensions:U,onDimensionBlur:z,isExporting:k,onExport:l,onCopyConfig:V,activeTab:h,itemName:A})=>{const J=h==="elements"?"元素":"页面",[E,Z]=r.useState(null),[X,P]=r.useState(!1),[W,K]=r.useState(!1),[i,F]=L.useMessage(),[B,ee]=r.useState("export"),[te,G]=r.useState(""),[R,q]=r.useState(""),[se,D]=r.useState(!1);r.useEffect(()=>{(async()=>{if(R&&B==="copyConfig"){D(!0);try{if(!await H()){q(""),G(""),D(!1);return}const N=await V(R);G(N)}catch{i.error("加载配置失败"),G("")}finally{D(!1)}}})()},[R,B,V,i]),r.useEffect(()=>{o||(ee("export"),q(""),G(""))},[o]);const H=async()=>{if(!A)return!0;K(!0);try{const c=`${h}/${A}`,T=await xt.reviewCode(c);return T.passed?!0:(Z(T),P(!0),!1)}catch(c){return console.error("代码检查失败:",c),!0}finally{K(!1)}},w=async()=>{await H()&&l()},u=async()=>{if(!te){i.warning("请先选择导出内容");return}try{await navigator.clipboard.writeText(te),i.success("配置已复制到剪贴板")}catch{i.error("复制失败，请检查浏览器剪贴板权限")}},p=c=>{c.target.select()},g=async()=>{if(!E)return;const c=E.issues.filter(j=>j.type==="error"),T=E.issues.filter(j=>j.type==="warning");let N=`代码检查未通过，请帮我修复以下问题：

`;N+=`文件：${E.file}

`,c.length>0&&(N+=`❌ 错误 (${c.length} 个):
`,c.forEach((j,M)=>{N+=`
${M+1}. [${j.rule}] ${j.message}
`,j.suggestion&&(N+=`   建议: ${j.suggestion}
`)})),T.length>0&&(N+=`
⚠️ 警告 (${T.length} 个):
`,T.forEach((j,M)=>{N+=`
${M+1}. [${j.rule}] ${j.message}
`,j.suggestion&&(N+=`   建议: ${j.suggestion}
`)}));try{await navigator.clipboard.writeText(N),i.success("复制成功"),P(!1)}catch{i.error("复制失败，请检查浏览器剪贴板权限")}};return e.jsxs(e.Fragment,{children:[F,e.jsx(Ne,{title:"导出到 Axure",open:o,onCancel:d,footer:B==="export"?[e.jsx(O,{type:"primary",loading:k||W,onClick:w,children:"导出"},"export")]:[e.jsx(O,{type:"primary",disabled:!te,onClick:u,children:"复制配置"},"copy")],width:800,children:e.jsx(yt,{activeKey:B,onChange:ee,items:[{key:"export",label:"导出图片",children:e.jsxs("div",{style:{display:"flex",gap:"20px",height:"400px"},children:[e.jsx("div",{style:{flex:1,border:"1px solid #f0f0f0",borderRadius:"8px",overflow:"hidden",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:n.previewUrl?e.jsx("img",{src:n.previewUrl,alt:"Preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}}):e.jsx(ze,{tip:"正在生成预览..."})}),e.jsxs("div",{style:{width:"240px",display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"8px",fontWeight:500,display:"flex",alignItems:"center",gap:"4px"},children:["导出尺寸",e.jsx(ie,{title:"返回 Axure 双击元素就可以替换图片，双击图片左上角或者在样式面板里点击自适应图片即可更新图片尺寸",children:e.jsx(He,{style:{color:"#999",cursor:"help"}})})]}),e.jsxs(Ae,{children:[e.jsx($t,{value:n.width,onChange:c=>f("width",c),onBlur:z,placeholder:"宽",style:{width:100},min:1}),e.jsx(Cs,{onClick:U,style:{color:"#999",cursor:"pointer",fontSize:14}}),e.jsx($t,{value:n.height,onChange:c=>f("height",c),onBlur:z,placeholder:"高",style:{width:100},min:1})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"8px",fontWeight:500,display:"flex",alignItems:"center",gap:"4px"},children:["图片内容",e.jsx(ie,{title:"标题封面便于在 Axure 内更改尺寸",children:e.jsx(He,{style:{color:"#999",cursor:"help"}})})]}),e.jsx(it.Group,{value:n.contentType,onChange:c=>y(T=>({...T,contentType:c.target.value})),children:e.jsxs(Ae,{direction:"vertical",children:[e.jsxs(it,{value:"title",children:[J,"标题"]}),e.jsxs(it,{value:"screenshot",children:[J,"截图"]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"8px",fontWeight:500,display:"flex",alignItems:"center",gap:"4px"},children:["包含配置",e.jsx(ie,{title:"若包含配置，仅需导入图片到 Axure，一般不需要再复制配置或者代码",children:e.jsx(He,{style:{color:"#999",cursor:"help"}})})]}),e.jsx(Ce,{value:n.includeConfig,onChange:c=>y(T=>({...T,includeConfig:c})),style:{width:"100%"},options:[{label:"无",value:"none"},{label:"原型",value:"code"},{label:"原型 + 文档",value:"codeAndDocs"},{label:"原型 + 文档 + 代码",value:"codeAndDocsAndSource"}]})]})]})]})},{key:"copyConfig",label:"复制配置",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px",height:"400px"},children:[e.jsx(Ct,{message:"导出本地 html 或者发布到 Axure Cloud 时若图片失效可以使用此功能",type:"info",showIcon:!0}),e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"8px",fontWeight:500},children:"导出内容"}),e.jsx(Ce,{value:R||void 0,onChange:q,placeholder:"请选择导出内容",style:{width:"100%"},options:[{label:"请选择导出内容",value:"",disabled:!0},{label:"原型",value:"code"},{label:"原型 + 文档",value:"codeAndDocs"},{label:"原型 + 文档 + 代码",value:"codeAndDocsAndSource"}]})]}),R&&e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{marginBottom:"8px",fontWeight:500},children:"配置内容"}),se?e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #d9d9d9",borderRadius:"6px"},children:e.jsx(ze,{tip:"正在加载配置..."})}):e.jsx(an,{value:te,readOnly:!0,onFocus:p,style:{flex:1,fontFamily:"monospace",fontSize:"12px"},placeholder:"配置内容将显示在这里"})]})]})}]})}),e.jsx(Ne,{title:"代码检查未通过",open:X,onCancel:()=>P(!1),width:600,footer:[e.jsx(O,{onClick:()=>P(!1),children:"取消"},"cancel"),e.jsx(O,{type:"primary",icon:e.jsx(Je,{}),onClick:g,children:"复制给 AI 修复"},"copy")],children:E&&e.jsxs("div",{style:{maxHeight:"500px",overflowY:"auto"},children:[e.jsx(Ct,{description:"代码不符合开发规范，需要修复后才能导出",type:"error",showIcon:!0,style:{marginBottom:"24px"}}),E.issues.filter(c=>c.type==="error").length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(kt,{orientation:"left",style:{margin:"0 0 16px 0",fontSize:"14px"},children:e.jsx(Ee,{type:"danger",children:"错误 (必须修复)"})}),e.jsx(_e,{size:"small",dataSource:E.issues.filter(c=>c.type==="error"),renderItem:c=>e.jsx(_e.Item,{style:{padding:"12px 0",borderBottom:"1px solid #f0f0f0"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{marginBottom:"4px"},children:[e.jsxs(Ee,{strong:!0,children:["[",c.rule,"]"]})," ",e.jsx(Ee,{children:c.message})]}),c.suggestion&&e.jsxs("div",{style:{fontSize:"13px",color:"#8c8c8c",background:"#fafafa",padding:"8px",borderRadius:"4px"},children:["建议: ",c.suggestion]})]})})})]}),E.issues.filter(c=>c.type==="warning").length>0&&e.jsxs("div",{children:[e.jsx(kt,{orientation:"left",style:{margin:"0 0 16px 0",fontSize:"14px"},children:e.jsx(Ee,{type:"warning",children:"警告 (建议修复)"})}),e.jsx(_e,{size:"small",dataSource:E.issues.filter(c=>c.type==="warning"),renderItem:c=>e.jsx(_e.Item,{style:{padding:"12px 0",borderBottom:"1px solid #f0f0f0"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{marginBottom:"4px"},children:[e.jsxs(Ee,{strong:!0,children:["[",c.rule,"]"]})," ",e.jsx(Ee,{children:c.message})]}),c.suggestion&&e.jsxs("div",{style:{fontSize:"13px",color:"#8c8c8c",background:"#fafafa",padding:"8px",borderRadius:"4px"},children:["建议: ",c.suggestion]})]})})})]})]})})]})},{Text:ct}=Ge,{useToken:cn}=Oe;function dn({visible:o,onCancel:d,item:n,activeTab:y}){const{token:f}=cn(),[U,z]=r.useState([]),[k,l]=r.useState(!1),[V,h]=r.useState(""),[A,J]=r.useState(""),[E,Z]=r.useState(!1),[X,P]=r.useState(!1),[W,K]=r.useState(null),[i,F]=r.useState(null),B=w=>{const u=w;let p="";if(u.filePath){const g=u.filePath.indexOf("src/");p=g>=0?u.filePath.substring(g):u.filePath}else p=`${y==="pages"?"src/pages":"src/elements"}/${w.name}`;return p=p.replace(/\/index\.(t|j)sx?$/i,""),p=p.replace(/^\/+/,""),p.startsWith("src/")&&(p=p.substring(4)),p},ee=w=>{const u=new Date(w),p=g=>String(g).padStart(2,"0");return`${u.getFullYear()}/${p(u.getMonth()+1)}/${p(u.getDate())} ${p(u.getHours())}:${p(u.getMinutes())}:${p(u.getSeconds())}`},te=w=>{const u=Math.floor((Date.now()-w)/1e3);let p=u/31536e3;return p>1?Math.floor(p)+" 年前":(p=u/2592e3,p>1?Math.floor(p)+" 个月前":(p=u/86400,p>1?Math.floor(p)+" 天前":(p=u/3600,p>1?Math.floor(p)+" 小时前":(p=u/60,p>1?Math.floor(p)+" 分钟前":"刚刚"))))},G=async()=>{if(n){P(!0);try{const w=B(n);if(!w){L.error("无法获取文件路径"),P(!1);return}const u=await fetch(`/api/git/history?path=${encodeURIComponent(w)}`),p=await u.json();u.ok?(z(p.commits),l(p.hasUncommitted),h(p.uncommittedFiles)):L.error(p.error||"加载版本历史失败")}catch{L.error("加载版本历史失败")}finally{P(!1)}}};r.useEffect(()=>{o&&n&&G()},[o,n]);const R=async w=>{if(n)try{const u=B(n),p=await fetch("/api/git/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:u,commitHash:w})}),g=await p.json();p.ok?(L.success("版本恢复成功"),G()):L.error(g.error||"版本恢复失败")}catch{L.error("版本恢复失败")}},q=async()=>{if(!n||!A.trim()){L.warning("请输入提交信息");return}Z(!0);try{const w=B(n),u=await fetch("/api/git/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:w,message:A})}),p=await u.json();u.ok?(L.success("提交成功"),J(""),G()):L.error(p.error||"提交失败")}catch{L.error("提交失败")}finally{Z(!1)}},se=async()=>{if(n)try{const w=B(n),u=`我需要提交以下目录的更改，请帮我处理：

目标路径: src/${w}

请执行以下步骤：
1. 使用 git status 和 git diff 查看该路径下的变更内容。
2. 分析变更，生成一个简洁明了的中文提交信息（Commit Message）。
3. 向我展示变更摘要和建议的提交信息，并询问是否继续。
4. 获得确认后，执行：
   git add src/${w}
   git commit -m "你的提交信息"

请直接开始执行第 1 步。`;await navigator.clipboard.writeText(u),L.success("AI 指令已复制，请粘贴给助手")}catch{L.error("复制失败，请手动复制")}},D=async w=>{if(n){K(w);try{const u=B(n),p=await fetch("/api/git/build-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:u,commitHash:w})}),g=await p.json();p.ok&&g.hasSpec&&g.specUrl?window.open(g.specUrl,"_blank"):g.hasSpec?L.error(g.error||"无法访问规格文档"):L.warning("该版本没有规格文档")}catch{L.error("加载规格文档失败")}finally{K(null)}}},H=async w=>{if(n){F(w);try{const u=B(n),p=await fetch("/api/git/build-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:u,commitHash:w})}),g=await p.json();p.ok&&g.hasPrototype&&g.prototypeUrl?window.open(g.prototypeUrl,"_blank"):g.hasPrototype?L.error(g.error||"无法访问原型"):L.warning("该版本没有原型文件")}catch{L.error("加载原型失败")}finally{F(null)}}};return e.jsx(Ne,{title:`版本管理 - ${n==null?void 0:n.displayName}`,open:o,onCancel:d,footer:null,width:700,centered:!0,className:"version-dialog",styles:{body:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",paddingTop:12,paddingBottom:12}},destroyOnClose:!0,children:e.jsx(ze,{spinning:X,children:U.length===0&&!k?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:"暂无版本历史"}):e.jsx(ks,{mode:"left",items:[...k?[{children:e.jsx("div",{className:"commit-item uncommitted",style:{paddingBottom:20},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(ct,{strong:!0,style:{fontSize:14,marginRight:8},children:"未提交的更改"}),e.jsx(It,{color:"warning",children:"未保存"})]})}),e.jsxs("div",{style:{background:f.colorFillAlter,padding:12,borderRadius:8,border:`1px solid ${f.colorBorderSecondary}`},children:[e.jsx(Re,{placeholder:"手动输入提交信息...",value:A,onChange:w=>J(w.target.value),onPressEnter:q,style:{marginBottom:12}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:12,color:f.colorTextSecondary},children:V?`${V.split(`
`).filter(Boolean).length} 个文件变更`:"有文件变更"}),e.jsxs(Ae,{children:[e.jsx(O,{size:"small",icon:e.jsx(Ut,{}),onClick:se,style:{color:f.colorPrimary,borderColor:f.colorPrimary},children:"AI 提交"}),e.jsx(O,{type:"primary",size:"small",onClick:q,loading:E,disabled:!A.trim(),children:"提交"})]})]})]})]})}),color:"orange",dot:e.jsx("div",{style:{width:10,height:10,background:f.colorWarning,borderRadius:"50%",border:`2px solid ${f.colorBgContainer}`}})}]:[],...U.map((w,u)=>{const p=u===0&&!k;return{children:e.jsx("div",{className:"commit-item",style:{paddingBottom:20},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{marginBottom:4,display:"flex",alignItems:"center"},children:[e.jsx(ct,{strong:!0,style:{fontSize:14,marginRight:8},children:w.message}),p&&e.jsx(It,{color:"success",children:"当前版本"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:f.colorTextSecondary},children:[e.jsxs(Ae,{size:4,children:[e.jsx(Is,{size:20,style:{backgroundColor:f.colorPrimary,fontSize:12},children:w.author?w.author[0].toUpperCase():"U"}),e.jsx("span",{children:w.author})]}),e.jsx("span",{style:{color:f.colorBorder},children:"|"}),e.jsx(ie,{title:ee(w.timestamp),children:e.jsx("span",{style:{cursor:"help"},children:te(w.timestamp)})}),e.jsx("span",{style:{color:f.colorBorder},children:"|"}),e.jsx(ct,{code:!0,style:{fontSize:12,margin:0},children:w.hash.substring(0,7)})]})]}),!p&&e.jsxs(Ae,{size:0,children:[e.jsx(ie,{title:"查看规格文档",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(Pe,{}),style:{color:f.colorTextSecondary},onClick:()=>D(w.hash),loading:W===w.hash})}),e.jsx(ie,{title:"查看原型",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(Ft,{}),style:{color:f.colorTextSecondary},onClick:()=>H(w.hash),loading:i===w.hash})}),e.jsx(As,{title:"确认恢复",description:"确定要恢复到此版本吗？当前未提交的更改将会丢失。",onConfirm:()=>R(w.hash),okText:"确认",cancelText:"取消",children:e.jsx(ie,{title:"恢复此版本",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(Rs,{}),style:{color:f.colorTextSecondary}})})})]}),p&&e.jsx(Ae,{size:0})]})}),color:p?"green":"gray",dot:p?e.jsx("div",{style:{width:10,height:10,background:f.colorSuccess,borderRadius:"50%",border:`2px solid ${f.colorBgContainer}`}}):void 0}})]})})})}const{Sider:hn}=Le,{useToken:pn}=Oe;function fn({collapsed:o,loading:d,activeTab:n,handleTabChange:y,data:f,searchText:U,setSearchText:z,filteredItems:k,selectedItem:l,handleMenuClick:V,handleDownloadItemSource:h,handleRenameItem:A,handleSetReference:J,handleUnsetReference:E,handleDuplicateItem:Z,handleDeleteItem:X,handleCopyItemPath:P,setCreateDialogVisible:W}){const{token:K}=pn(),[i,F]=r.useState(!1),[B,ee]=r.useState(null),te=R=>{ee(R),F(!0)},G=r.useMemo(()=>k.map(R=>{const q=l&&l.name===R.name,se=[{key:"rename",label:"重命名",icon:e.jsx(Mt,{})},{key:"duplicate",label:"创建副本",icon:e.jsx(Je,{})},{key:"copy-path",label:"复制路径",icon:e.jsx(Bt,{})},{type:"divider"},{key:"version-management",label:"版本管理",icon:e.jsx(Ts,{})},{key:"download-source",label:"导出 ZIP",icon:e.jsx(Ve,{})},{type:"divider"},...R.isReference?[{key:"unset-reference",label:"取消参考",icon:e.jsx(dt,{})}]:[{key:"set-reference",label:"设置为参考",icon:e.jsx(dt,{})}],{key:"delete",label:`删除${n==="elements"?"元素":"页面"}`,icon:e.jsx(Es,{}),danger:!0,disabled:R.isReference}];return{key:R.name,label:e.jsxs("div",{className:`menu-item-wrapper ${q?"is-selected":""}`,style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:6,overflow:"hidden",flex:1},children:e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R.displayName})}),e.jsx(pt,{trigger:["click"],menu:{items:se,onClick:({key:D})=>{D==="download-source"?h(R):D==="rename"?A(R):D==="duplicate"?Z(R):D==="copy-path"?P(R):D==="version-management"?te(R):D==="set-reference"?J(R):D==="unset-reference"?E(R):D==="delete"&&X(R)}},children:e.jsx(O,{type:"text",size:"small",className:"more-btn",icon:e.jsx(Ps,{}),onClick:D=>{D.stopPropagation()}})})]}),icon:n==="elements"?e.jsx(ht,{}):e.jsx(Pe,{})}}),[k,n,l,h,A,J,E,X,P,Z]);return e.jsxs(hn,{trigger:null,collapsible:!0,collapsed:o,width:240,collapsedWidth:0,style:{background:K.colorBgContainer,borderRight:`1px solid ${K.colorBorder}`,overflow:"hidden",height:"calc(100vh - 48px)",position:"sticky",top:48},children:[e.jsxs("div",{style:{height:"100%",position:"relative"},children:[e.jsxs("div",{style:{height:"100%",overflowY:"auto"},children:[e.jsx("div",{style:{padding:"8px"},children:!o&&e.jsxs(e.Fragment,{children:[e.jsx(yt,{activeKey:n,size:"small",centered:!0,onChange:R=>y(R),items:[{key:"pages",label:`页面 (${f.pages.length})`,icon:e.jsx(Pe,{})},{key:"elements",label:`元素 (${f.elements.length})`,icon:e.jsx(ht,{})}]}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:8},children:e.jsx(Re,{placeholder:"搜索...",prefix:e.jsx(_t,{}),value:U,onChange:R=>z(R.target.value),allowClear:!0,style:{flex:1}})})]})}),d?e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(ze,{tip:"加载中..."})}):e.jsxs(e.Fragment,{children:[e.jsx(Ds,{mode:"inline",selectedKeys:l?[l.name]:[],items:G,onClick:V,style:{borderRight:0}}),e.jsx("div",{style:{height:80}})]})]}),!o&&e.jsx(Ns,{icon:e.jsx(zs,{}),type:"primary",style:{position:"absolute",left:24,bottom:24},onClick:()=>W(!0),tooltip:n==="elements"?"新建元素":"新建页面"})]}),e.jsx(dn,{visible:i,onCancel:()=>F(!1),item:B,activeTab:n})]})}function un({open:o,onClose:d}){const[n]=ae.useForm(),[y,f]=r.useState(!1);r.useEffect(()=>{o&&U()},[o]);const U=async()=>{try{const k=await fetch("/api/config");if(!k.ok)throw new Error("Failed to load config");const l=await k.json();n.setFieldsValue({host:l.server.host||"localhost",allowLAN:l.server.allowLAN!==!1,enableCommandAPI:l.server.enableCommandAPI||!1})}catch(k){console.error("Error loading config:",k),L.error("加载配置失败")}},z=async()=>{try{const k=await n.validateFields();f(!0);const l=await fetch("/api/config"),V=l.ok?await l.json():{server:{host:"localhost",port:51720,allowLAN:!0}},h={server:{host:k.host,port:V.server.port||51720,allowLAN:k.allowLAN,enableCommandAPI:k.enableCommandAPI||!1}},A=await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!A.ok){const E=await A.json();throw new Error(E.error||"Failed to save config")}const J=await A.json();L.success(J.message||"配置已保存"),d()}catch(k){console.error("Error saving config:",k),L.error(k.message||"保存配置失败")}finally{f(!1)}};return e.jsx(Ne,{title:"项目设置",open:o,onOk:z,onCancel:d,confirmLoading:y,okText:"保存",cancelText:"取消",width:500,children:e.jsxs(ae,{form:n,layout:"vertical",initialValues:{host:"localhost",allowLAN:!0,enableCommandAPI:!1},children:[e.jsx(ae.Item,{label:"主机地址",name:"host",rules:[{required:!0,message:"请输入主机地址"}],tooltip:"服务器启动的域名或 IP 地址",children:e.jsx(Re,{placeholder:"localhost"})}),e.jsx(ae.Item,{label:"允许局域网访问",name:"allowLAN",valuePropName:"checked",tooltip:"开启后，局域网内的其他设备可以访问此服务器。注意：可能存在安全风险，请确保在可信网络环境中使用",children:e.jsx(ft,{})}),e.jsx(ae.Item,{label:"启用命令 API",name:"enableCommandAPI",valuePropName:"checked",tooltip:"开启后，允许通过 API 执行系统命令。警告：存在严重安全风险，仅在开发环境使用",children:e.jsx(ft,{})})]})})}const{Header:mn}=Le,{useToken:gn}=Oe,xn=o=>e.jsx("span",{role:"img","aria-label":"figma",className:"anticon anticon-figma",...o,children:e.jsxs("svg",{fill:"currentColor",fillRule:"evenodd",height:"1em",width:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",style:{verticalAlign:"middle"},children:[e.jsx("title",{children:"Figma"}),e.jsx("path",{clipRule:"evenodd",d:"M6.082 8.241C4.83 7.441 4 6.057 4 4.483 4 2.007 6.05 0 8.578 0h7.844C18.95 0 21 2.007 21 4.483c0 1.574-.829 2.959-2.082 3.758C20.17 9.041 21 10.426 21 12c0 2.476-2.05 4.483-4.578 4.483h-.084A4.615 4.615 0 0113.24 15.3v4.176C13.24 21.98 11.145 24 8.599 24 6.076 24 4 21.998 4 19.517c0-1.574.829-2.959 2.082-3.758C4.829 14.959 4 13.574 4 12c0-1.574.829-2.959 2.082-3.759zM13.24 12c0 1.676 1.387 3.034 3.098 3.034h.084c1.711 0 3.099-1.358 3.099-3.034 0-1.676-1.388-3.034-3.1-3.034h-.083c-1.71 0-3.098 1.358-3.098 3.034zm-1.48-3.034H8.578C6.867 8.966 5.48 10.324 5.48 12c0 1.672 1.382 3.029 3.089 3.034H11.76V8.966zm-3.182 7.517h-.01c-1.707.005-3.089 1.362-3.089 3.034 0 1.67 1.403 3.034 3.12 3.034 1.74 0 3.161-1.381 3.161-3.075v-2.993H8.578zm3.182-8.966H8.578c-1.711 0-3.099-1.358-3.099-3.034 0-1.676 1.388-3.034 3.1-3.034h3.181v6.068zm4.662 0H13.24V1.45h3.182c1.711 0 3.099 1.358 3.099 3.034 0 1.676-1.388 3.034-3.1 3.034z"})]})});function yn({collapsed:o,setCollapsed:d,selectedItem:n,viewMode:y,setViewMode:f,activeTab:U,selectedDeviceId:z,setSelectedDeviceId:k,deviceSegmentOptions:l,handleOpenInspect:V,handleRefreshElement:h,handleCopyLocalLink:A,handleCopyLANLink:J,handleDownloadZip:E,getLANUrl:Z,qrCodeVisible:X,setQrCodeVisible:P,wsClients:W,checkConnection:K,handlePushToFigma:i,handleDownloadFigmaJson:F,setIsExportModalOpen:B,handleOpenIdeFile:ee,isDarkMode:te,setIsDarkMode:G,currentSpecDocKey:R="spec"}){const[q,se]=Ie.useState(null),[D,H]=Ie.useState(!1),[w,u]=Ie.useState(!0),{token:p}=gn();return Ie.useEffect(()=>{let g=!1;return fetch("/api/version").then(c=>c.ok?c.json():Promise.reject(new Error("Request failed"))).then(c=>{if(g)return;const T=typeof(c==null?void 0:c.version)=="string"?c.version:null;se(T)}).catch(()=>{g||se(null)}),()=>{g=!0}},[]),Ie.useEffect(()=>{let g=!1;return fetch("/api/config").then(c=>c.ok?c.json():Promise.reject(new Error("Request failed"))).then(c=>{var T;g||u(((T=c==null?void 0:c.server)==null?void 0:T.allowLAN)!==!1)}).catch(()=>{g||u(!0)}),()=>{g=!0}},[]),e.jsxs(mn,{hasSider:!0,style:{height:"48px",display:"flex",alignItems:"center",justifyContent:"space-between",background:p.colorBgContainer,padding:"0 16px",position:"sticky",top:0,zIndex:1e3,boxShadow:`0 2px 8px ${p.colorBorderSecondary}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",width:224},children:[e.jsx(O,{type:"text",icon:o?e.jsx(Ls,{}):e.jsx(Os,{}),onClick:()=>d(!o),style:{fontSize:"16px",height:40}}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:e.jsxs("span",{style:{fontSize:"18px",fontWeight:600,color:p.colorText},children:["Axhub ",e.jsx("span",{style:{color:"#008F5D"},children:"Make"})]})})]}),e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center"},children:e.jsx(ut,{value:y,size:"small",style:{fontSize:"12px"},onChange:g=>f(g),options:[{label:"原型",value:"demo",icon:e.jsx(Ft,{})},{label:"文档",value:"spec",icon:e.jsx(dt,{})}]})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ie,{title:te?"切换到浅色模式":"切换到深色模式",children:e.jsx(O,{type:"text",icon:te?e.jsx(Wt,{}):e.jsx(Ht,{}),onClick:()=>G(!te)})}),e.jsx(pt,{menu:{items:[{key:"assets",label:"资产管理",icon:e.jsx(Pe,{}),onClick:()=>window.open(new URL("/assets.html",window.location.origin).toString(),"_blank")},{key:"settings",label:"项目设置",icon:e.jsx(mt,{}),onClick:()=>H(!0)},{type:"divider"},{key:"help",label:"帮助中心",icon:e.jsx(Fs,{}),onClick:()=>window.open("https://axhub-work.feishu.cn/wiki/space/7585489740036606927","_blank")},{key:"training",label:"培训服务",icon:e.jsx(Ms,{}),onClick:()=>window.open("https://axhub-work.feishu.cn/wiki/W8KDwcZ8eiB68Nkw4sFcGL4Wn6e","_blank")},{key:"plugin",label:"编辑器扩展",icon:e.jsx(Vt,{}),extra:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(At,{status:W.some(g=>g.type==="vscode"||g.type==="cursor")?"success":"default"}),e.jsx("span",{style:{marginLeft:4,fontSize:12,color:W.some(g=>g.type==="vscode"||g.type==="cursor")?"#52c41a":p.colorTextSecondary},children:W.some(g=>g.type==="vscode"||g.type==="cursor")?"已连接":"未连接"})]}),onClick:()=>window.open("https://static.axhub.im/chrome/axhub.vsix","_blank")},{key:"site",label:"Axhub 官网",icon:e.jsx(mt,{}),onClick:()=>window.open("https://axhub.im/","_blank")},{type:"divider"},{key:"version",label:"当前版本",icon:e.jsx(He,{}),extra:e.jsx("span",{style:{fontSize:12,color:p.colorTextSecondary},children:q?`v${q}`:"-"})}]},placement:"bottomRight",children:e.jsx(O,{type:"text",icon:e.jsx(Us,{})})})]}),(n||y==="spec")&&e.jsx("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center"},children:e.jsx(Ae,{size:"small",children:y==="spec"?e.jsx(e.Fragment,{children:e.jsx(ie,{title:`在编辑器中打开 ${R==="prd"?"PRD":"SPEC"} 文档`,children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(gt,{}),onClick:ee})})}):n&&e.jsxs(e.Fragment,{children:[U==="pages"&&e.jsx(ut,{value:z,size:"small",shape:"round",onChange:g=>k(g),options:l}),e.jsx(ie,{title:"在编辑器中打开",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(gt,{}),onClick:ee})}),e.jsx(ie,{title:"Inspecta 编辑",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(Mt,{}),onClick:V})}),e.jsx(ie,{title:"刷新",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(Bs,{}),onClick:h})}),e.jsx(_s,{content:e.jsxs("div",{style:{width:160},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx(O,{type:"text",icon:e.jsx(Je,{}),onClick:A,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"复制本地链接"}),w&&e.jsx(O,{type:"text",icon:e.jsx(Je,{}),onClick:J,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"复制局域网链接"}),e.jsx(O,{type:"text",icon:e.jsx(Ve,{}),onClick:E,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"下载项目"}),e.jsx(O,{type:"text",icon:e.jsx(Rt,{}),disabled:!0,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"发布原型"})]}),w&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{height:1,background:p.colorBorder,margin:"8px 0"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"8px 0px 4px"},children:[e.jsx(Hs,{value:Z(),size:128,bordered:!1,style:{marginBottom:8}}),e.jsx(Ge.Text,{type:"secondary",style:{fontSize:12,textAlign:"center"},children:"同 WiFi 的手机扫码预览"})]})]})]}),trigger:"click",placement:"bottomRight",open:X,onOpenChange:P,arrow:!1,children:e.jsx(ie,{title:"分享",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(Ws,{})})})}),e.jsx(pt,{trigger:["click"],placement:"bottomCenter",onOpenChange:g=>{g&&K()},menu:{items:[{key:"push",label:"一键推送",extra:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(At,{status:W.some(g=>g.type==="figma")?"success":"default"}),e.jsx("span",{style:{marginLeft:4},children:W.some(g=>g.type==="figma")?"已连接":"未连接"})]}),icon:e.jsx(Rt,{}),disabled:!W.some(g=>g.type==="figma")},{type:"divider"},{key:"download-json",label:"下载 JSON",icon:e.jsx(Ve,{})},{key:"download-axure",label:"下载 JSON",extra:"适配 Axure",icon:e.jsx(Pe,{})}],onClick:({key:g})=>{g==="push"?i():g==="download-json"?F(!0):g==="download-axure"&&F(!1)}},children:e.jsx(ie,{trigger:["click","hover"],title:"导出到 Figma",children:e.jsx(O,{type:"text",size:"small",icon:e.jsx(xn,{})})})}),e.jsx(O,{type:"primary",size:"small",style:{fontSize:"12px"},icon:e.jsx(Ve,{}),onClick:()=>{B(!0)},children:"导出到 Axure"})]})})}),e.jsx(un,{open:D,onClose:()=>H(!1)})]})}const wn=({width:o,height:d,children:n,scale:y=1})=>e.jsx("div",{style:{position:"relative",padding:"12px",background:"#1f1f1f",borderRadius:"40px",boxShadow:"0 20px 40px rgba(0,0,0,0.2)",border:"4px solid #333",display:"flex",flexDirection:"column",transform:`scale(${y})`,transformOrigin:"center center"},children:e.jsx("div",{style:{width:o,height:d,background:"#fff",borderRadius:"32px",overflow:"hidden",position:"relative"},children:n})}),{Content:jn}=Le,{useToken:bn}=Oe;function vn({containerRef:o,selectedItem:d,activeTab:n,currentDevice:y,displaySize:f,scale:U,elementIframeKey:z,iframeUrl:k,elementIframeSize:l,setElementIframeSize:V,viewMode:h}){const{token:A}=bn();return e.jsx(jn,{ref:o,style:{background:A.colorBgLayout,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:d?h==="spec"?e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none",display:"block"},title:d.displayName},z):n==="pages"&&y.id!=="desktop"?e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(wn,{width:f.width,height:f.height,scale:U,children:e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none"},title:d.displayName},z)})}):n==="elements"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:e.jsx("div",{style:{position:"relative",display:"inline-block"},children:e.jsx(Vs,{size:l,onResize:(J,E,Z)=>{if(Z){const X=Z.getBoundingClientRect();V({width:X.width,height:X.height})}},minWidth:50,minHeight:50,bounds:"window",enable:{top:!1,right:!0,bottom:!0,left:!1,topRight:!1,bottomRight:!0,bottomLeft:!1,topLeft:!1},handleStyles:{right:{width:"8px",right:"-4px",background:"transparent",borderRadius:"4px",transition:"all 0.2s"},bottom:{height:"8px",bottom:"-4px",background:"transparent",borderRadius:"4px",transition:"all 0.2s"},bottomRight:{width:"12px",height:"12px",right:"-6px",bottom:"-6px",background:"transparent",borderRadius:"0 0 6px 0",transition:"all 0.2s"}},handleClasses:{right:"resize-handle-right",bottom:"resize-handle-bottom",bottomRight:"resize-handle-bottomRight"},style:{border:`1px solid ${A.colorBorder}`,borderRadius:6,overflow:"hidden",background:A.colorBgContainer,boxShadow:A.boxShadow,transition:"box-shadow 0.2s"},className:"ant-card-hoverable",children:e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none"},title:d.displayName},z)})})}):e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none",display:"block"},title:d.displayName},z):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:A.colorTextSecondary},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Js,{style:{fontSize:"64px",marginBottom:"16px"}}),e.jsxs("div",{style:{fontSize:"16px"},children:["请从左侧选择一个",n==="elements"?"元素":"页面"]})]})})})}const{Dragger:Sn}=Jt,{Text:$n,Title:Cn}=Ge;function kn({visible:o,onClose:d,onOk:n,onSendPrompt:y,activeTab:f,createName:U,setCreateName:z,createReference:k,setCreateReference:l,createMode:V,setCreateMode:h,generateAxure:A,setGenerateAxure:J,referenceItems:E,selectedThemes:Z,setSelectedThemes:X,availableThemes:P,selectedLibraries:W,setSelectedLibraries:K,availableLibraries:i,selectedDocs:F,setSelectedDocs:B,availableDocs:ee,selectedDataAssets:te,setSelectedDataAssets:G,availableDataAssets:R}){const{token:q}=Oe.useToken(),[se,D]=r.useState(!0),[H,w]=r.useState("create"),[u,p]=r.useState("make"),[g,c]=r.useState([]),[T,N]=r.useState(!1),[j,M]=r.useState(null);r.useEffect(()=>{o&&(D(!0),w("create"),p("make"),c([]),N(!1),M(null))},[o]);const Y=x=>{p(x),c([]),M(null)},ne=x=>["make","axhub","google_stitch"].includes(x),be=x=>["axure_prototype","web_page"].includes(x),ke=async x=>{const{file:he,onSuccess:pe,onError:re}=x,ve=he instanceof File?he:he.originFileObj,ue=new FormData;ue.append("file",ve,ve.name),ue.append("uploadType",u),ue.append("targetType",f),console.log("[前端] customRequest 上传参数:",{uploadType:u,targetType:f,fileName:ve.name,fileSize:ve.size}),N(!0);try{const me=await fetch("/api/upload",{method:"POST",body:ue}),we=await me.json();console.log("[前端] 服务器响应:",we),me.ok&&we.success?(M(we),pe(null,he),ne(u)?(L.success(we.message||"上传并解压成功！"),setTimeout(()=>{d(),window.location.reload()},1500)):L.success("文件已解压，请点击按钮复制 Prompt")):(console.error("[前端] 上传失败:",we),L.error(we.error||"上传失败"),re(new Error(we.error||"上传失败")))}catch(me){console.error("[前端] 上传错误:",me),L.error("上传失败: "+me.message),re(me)}finally{N(!1)}},qe=()=>{const x=Ue.find(re=>re.key===u),he=(x==null?void 0:x.docs)||[];let pe="";if(be(u)){const re=f==="elements"?"元素":"页面",ve=f==="elements"?"src/elements":"src/pages",ue=u==="axure_prototype"?"Axure 原型链接":"网页链接";pe=`**系统指令**：你将作为 Axhub Make 项目的智能助手，协助用户「基于${ue}导入并创建一个${re}」。

**交互要求**：
- 收到本条系统指令后，先用简短中文回复一次，并引导用户提供 ${ue}（URL）
- 未拿到链接前，不要生成任何文件
- 参考下方技能文档，按流程逐步引导用户完成导入与还原/优化
- 仅在用户明确确认后，再获取可选数据
- 资源获取禁止并发，必须一个完成后再进行下一个

**📋 参考技能文档（必须阅读）**：
${he.map(me=>`- \`${me}\``).join(`
`)}

**目标输出**：
- 在本项目中生成一个符合开发规范的${re}（路径：\`${ve}/<name>\`）
- 若用户未指定 name，先给出你推荐的 name，并等待用户确认

**首次回复模板**：
\`\`\`
收到，我将基于${ue}导入并创建一个${re}。

请把链接发我（URL）：
\`\`\``}else{if(!j||!j.prompt){L.error("没有可复制的 Prompt");return}pe=j.prompt,he.length>0&&(pe+=`

📋 参考技能文档：
${he.map(re=>`- \`${re}\``).join(`
`)}`)}navigator.clipboard.writeText(pe).then(()=>{L.success("Prompt 已复制到剪贴板，请粘贴给 AI 完成导入")}).catch(re=>{console.error("复制失败:",re),L.error("复制失败")})},Ye=()=>{if(H==="create")return e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx(O,{onClick:y,disabled:!1,children:"发送到 Cursor"}),e.jsx(O,{type:"primary",onClick:n,disabled:!1,children:"复制 Prompt"})]});if(ne(u))return e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:e.jsx(O,{onClick:d,children:"取消"})});const x=be(u)||j;return e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx(O,{onClick:d,children:"关闭"}),e.jsx(O,{type:"primary",onClick:qe,disabled:!x,children:"复制 Prompt 给 AI 完成导入"})]})},Ze={name:"file",multiple:!1,fileList:g,customRequest:ke,beforeUpload:x=>{var pe;return x.type==="application/zip"||x.type==="application/x-zip-compressed"||((pe=x.name)==null?void 0:pe.endsWith(".zip"))?!0:(L.error("请上传 ZIP 格式的文件"),Jt.LIST_IGNORE)},onChange:x=>{c(x.fileList.slice(-1))},onRemove:()=>{c([]),M(null)},accept:".zip"},de="/skills",Ue=[{key:"make",title:"Axbub Make",description:"支持自己或他人的 ZIP 包",icon:e.jsx(gt,{style:{fontSize:24,color:"#1890ff"}}),isDirect:!0,docs:[`${de}/local-axure-workflow/SKILL.md`]},{key:"axhub",title:"Axhub 扩展",description:"可导出任意网页（静态）",icon:e.jsx(Vt,{style:{fontSize:24,color:"#722ed1"}}),isDirect:!0,docs:[`${de}/screenshot-page-workflow/SKILL.md`]},{key:"google_stitch",title:"Google Stitch",description:"AI 驱动的 UI 设计工具（静态）",icon:e.jsx(Et,{style:{fontSize:24,color:"#f5222d"}}),isDirect:!0,docs:[`${de}/screenshot-page-workflow/SKILL.md`]},{key:"v0",title:"V0 App",description:"在线应用生成平台",icon:e.jsx(Ut,{style:{fontSize:24,color:"#52c41a"}}),isDirect:!1,docs:[`${de}/v0-project-converter/SKILL.md`]},{key:"google_aistudio",title:"Google AIStudio",description:"在线应用生成平台",icon:e.jsx(Et,{style:{fontSize:24,color:"#faad14"}}),isDirect:!1,docs:[`${de}/ai-studio-project-converter/SKILL.md`]},{key:"axure_prototype",title:"Axure 原型链接",description:"支持在线或本地预览的链接",icon:e.jsx(Bt,{style:{fontSize:24,color:"#1890ff"}}),isDirect:!1,docs:[`${de}/axure-prototype-workflow/SKILL.md`,`${de}/axure-prototype-workflow/page-restoration.md`]},{key:"web_page",title:"网页链接",description:"支持任意网页链接",icon:e.jsx(mt,{style:{fontSize:24,color:"#13c2c2"}}),isDirect:!1,docs:[`${de}/web-page-workflow/SKILL.md`,`${de}/web-page-workflow/page-restoration.md`]}],Xe=()=>e.jsxs(ae,{requiredMark:!1,labelCol:{style:{width:"120px"}},wrapperCol:{style:{minWidth:0}},children:[e.jsx(ae.Item,{label:f==="elements"?"元素名称":"页面名称",children:e.jsx(Re,{placeholder:"留空则由 AI 生成，批量生成建议留空",value:U,onChange:x=>z(x.target.value),maxLength:20,showCount:!0})}),E.length>0&&e.jsx(ae.Item,{label:"参考案例",tooltip:`可在${f==="elements"?"元素":"页面"}列表中将其设为或取消为参考案例`,children:e.jsx(Ce,{style:{width:"100%"},placeholder:"不选择参考案例",value:k||void 0,onChange:x=>l(x||""),allowClear:!0,options:E.map(x=>({value:x.name,label:x.displayName}))})}),e.jsx("div",{children:e.jsx(O,{type:"link",onClick:()=>D(!se),icon:se?e.jsx(Gs,{}):e.jsx(qs,{}),style:{padding:0},children:se?"更多配置":"收起配置"})}),!se&&e.jsxs(e.Fragment,{children:[P.length>0&&e.jsx(ae.Item,{label:"主题",tooltip:"AI 会根据所选主题生成原型，主题可在资产管理页面中进行管理",children:e.jsx(Ce,{mode:"multiple",style:{width:"100%"},placeholder:"请选择主题（可多选）",value:Z,onChange:x=>X(x),allowClear:!0,options:P.map(x=>({value:x.name,label:x.displayName}))})}),R.length>0&&e.jsx(ae.Item,{label:"引用数据",tooltip:"AI 会根据所选数据生成原型，数据可在数据管理页面中进行管理",children:e.jsx(Ce,{mode:"multiple",style:{width:"100%"},placeholder:"请选择参考数据（可多选）",value:te,onChange:x=>G(x),allowClear:!0,options:R.map(x=>({value:x.name,label:x.displayName}))})}),i.length>0&&e.jsx(ae.Item,{label:"前端库",tooltip:"AI 会根据所选前端库生成原型，前端库可在资产管理页面中进行管理",children:e.jsx(Ce,{mode:"multiple",style:{width:"100%"},placeholder:"请选择前端库（可多选）",value:W,onChange:x=>K(x),allowClear:!0,options:i.map(x=>({value:x.name,label:x.displayName}))})}),ee.length>0&&e.jsx(ae.Item,{label:"参考文档",tooltip:"AI 会根据所选文档生成原型，文档可在资产管理页面中进行管理",children:e.jsx(Ce,{mode:"multiple",style:{width:"100%"},placeholder:"请选择参考文档（可多选）",value:F,onChange:x=>B(x),options:ee.map(x=>({value:x.name,label:x.displayName}))})}),e.jsx(ae.Item,{label:"生成流程",children:e.jsx(Ce,{style:{width:"100%"},value:V,onChange:x=>h(x),options:[{value:"simultaneous",label:"同时生成规格文档和原型"},{value:"specFirst",label:"按 规格文档 > 原型 顺序"}]})}),e.jsx(ae.Item,{label:"Axure 模式",tooltip:"不影响导出 Axure ，关闭则不生成与 Axure 原生元素交互的功能，但可以提升生成速度",children:e.jsx(ft,{checked:A,onChange:x=>J(x)})})]})]}),Qe=()=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[e.jsxs("div",{children:[e.jsx(Cn,{level:5,style:{marginBottom:16},children:"选择导入来源"}),e.jsx(Ys,{gutter:[16,16],children:Ue.map(x=>e.jsx(Zs,{span:12,children:e.jsx(Tt,{hoverable:!0,bodyStyle:{padding:16,height:"100%",display:"flex",alignItems:"center"},style:{height:"100%",borderColor:u===x.key?q.colorInfo:void 0,backgroundColor:u===x.key?q.colorFillAlter:void 0},onClick:()=>Y(x.key),children:e.jsx(Tt.Meta,{avatar:x.icon,title:e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx($n,{ellipsis:!0,style:{fontSize:13,fontWeight:500},children:x.title})}),description:e.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4},children:x.description}),style:{width:"100%"}})})},x.key))})]}),!be(u)&&e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:e.jsx("div",{style:{flex:1,minHeight:120},children:e.jsx(Sn,{...Ze,style:{background:"#fafafa",border:"1px dashed #d9d9d9",height:"100%"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%",padding:"16px 0"},children:[e.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:8},children:e.jsx(Xs,{style:{color:q.colorInfo,fontSize:36}})}),e.jsx("p",{className:"ant-upload-text",style:{fontSize:14,marginBottom:4},children:"点击或拖拽 ZIP 文件上传"}),e.jsx("p",{className:"ant-upload-hint",style:{color:"#888",fontSize:12,padding:"0 16px"},children:ne(u)?"导入后可通过 AI 进行编辑和优化":"上传后需要 AI 辅助导入"})]})})})})]});return e.jsx(Ks,{placement:"left",destroyOnClose:!0,title:e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsx(ut,{value:H,onChange:x=>w(x),options:[{label:f==="elements"?"新建元素":"新建页面",value:"create"},{label:f==="elements"?"导入元素":"导入页面",value:"upload"}],style:{fontWeight:500}})}),open:o,onClose:d,width:600,footer:Ye(),styles:{body:{padding:24,overflow:"auto"},header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"}},children:H==="create"?Xe():Qe()})}const Ke={simultaneous:{mode:"simultaneous",displayName:"直接生成",description:"同时生成规格文档和原型，适合需求明确的场景",steps:["生成 spec.md 和 index.tsx"],templates:["spec-template.md"],requiresConfirmation:[!1]},specFirst:{mode:"specFirst",displayName:"规格优先",description:"先生成规格文档，确认后再生成原型",steps:["生成 spec.md","生成 index.tsx"],templates:["spec-template.md"],requiresConfirmation:[!0,!1]}};function In(o,d){const n=d==="elements"?"元素":"页面",y=d==="elements"?"elements":"pages",f=`src/${y}/${o.name}`,U=`src/${y}/ref-${o.name}`;return`将 \`${f}\` 设为参考案例：

1. 移动到 \`${U}\`
2. 参考 \`/rules/development-standards.md\`
3. 在 index.tsx 顶部添加：
\`\`\`typescript
/**
 * @name ${o.displayName}
 * 本文件是演示文件，展示 Axhub ${n}开发规范
 * 实际开发时只需保留 @name 注释，不需要详细的规范说明
 */
\`\`\`
4. 在关键代码段添加 \`// 【规范说明】\` 注释：导入顺序、Props处理、State管理、事件处理、useImperativeHandle、JSX渲染
5. 注释解释"为什么"而非"做什么"，重点说明易错点和最佳实践`}function An(o){return Object.prototype.hasOwnProperty.call(Ke,o)}function Rn(o){const{hasName:d,displayName:n,itemType:y,hasReference:f,referenceDisplayName:U}=o,z=f&&U?`
参考案例：${U}`:"";return d?`**系统交互要求**：
- 收到本条系统指令后，必须先向用户回复一次，并等待用户补充信息/确认；未完成对齐前不要生成任何文件、代码或文档
- 首次回复必须严格使用以下模板，不要输出实现内容

**首次回复模板**：
\`\`\`
收到，准备创建 **${n}** ${y}。${z}

请详细描述您的需求：
\`\`\``:`**系统交互要求**：
- 收到本条系统指令后，必须先向用户回复一次，并等待用户补充信息/确认；未完成对齐前不要生成任何文件、代码或文档
- 首次回复必须严格使用以下模板，不要输出实现内容

**首次回复模板**：
\`\`\`
收到，准备创建${y}。${z}

请详细描述您的需求（如需创建多个${y}，请一并说明）：
\`\`\``}function Tn(o){return o?`

**Axure API**：✅ 已启用
- 需要使用 Axure API 实现组件交互功能
- **⚠️ 必须完整阅读 \`/rules/axure-api-guide.md\`，不要跳过！**
- 该文档包含完整的 Axure API 接口规范、使用示例和最佳实践`:`

**Axure API**：❌ 未启用
- 本次使用标准 React 组件即可，不需要 Axure API`}function Ot(){return`   - 文件结构规范（index.tsx/spec.md/style.css）
   - 依赖引用规范、前端库使用、Design Tokens 使用
   - State 管理、样式规范、导出规范
   - 必须导出 Component
   - ⚠️ **验收标准**：完成后必须对照此文档检查实现是否符合所有规范`}function Kt(o){const{createMode:d,modeConfig:n,generateAxure:y}=o;return d==="simultaneous"?`

**生成模式**：${n.displayName}
- ${n.description}
- 流程：${n.steps.join(" → ")}

**📋 必读规范文档**：
1. **\`/rules/development-standards.md\`** ⭐️ 最重要！
${Ot()}

2. **\`/assets/templates/spec-template.md\`** 
   - spec.md 文档模板（包含：简要概述、功能说明、Axure API 说明）
   - 使用此模板生成 spec.md 文档${y?`

3. **\`/rules/axure-api-guide.md\`** ⚠️ Axure API 必读！
   - Axure API 完整使用指南
   - 接口规范、常量定义、Props 处理
   - 事件处理、Container 使用、完整示例`:""}`:d==="specFirst"?`

**生成模式**：${n.displayName}
- ${n.description}
- 流程：${n.steps.join(" → ")}
- **第一步**：完成需求对齐，产出完整的 spec.md（需要用户确认）
- **第二步**：基于 spec.md 生成代码实现（index.tsx）

**📋 必读规范文档**：
1. **\`/rules/development-standards.md\`** ⭐️ 最重要！
${Ot()}

2. **\`/rules/requirements-alignment.md\`**
   - 需求对齐流程和沟通方法
   - 按照此规范与用户进行需求对齐

3. **\`/assets/templates/spec-template.md\`**
   - spec.md 文档模板（包含：简要概述、功能说明、Axure API 说明）
   - 使用此模板生成 spec.md 文档${y?`

4. **\`/rules/axure-api-guide.md\`** ⚠️ Axure API 必读！
   - Axure API 完整使用指南
   - 接口规范、常量定义、Props 处理
   - 事件处理、Container 使用、完整示例`:""}

**确认流程**：
- 完成 spec.md 后，请明确告知用户："spec.md 已完成，请确认是否满足需求。确认后将生成代码实现。"
- 等待用户确认后再生成 index.tsx`:Kt({createMode:"simultaneous",modeConfig:Ke.simultaneous,generateAxure:y})}function En(o){const{referencePath:d,referenceDisplayName:n}=o;return d?`

**📁 参考案例**（⭐️ 优先参考）：
- 路径：\`${d}\`
- 名称：${n}
- **请优先参考此案例的代码结构和实现方式**
- 学习其文件组织、命名规范、代码风格`:""}function We(o){const{title:d,selected:n,available:y,toLine:f}=o;return n.length===0?"":`

${d}${n.map(U=>{const z=y.find(k=>k.name===U);return`
${f(U,z)}`}).join("")}`}function Pn(o){return o.length?`

**🎨 主题文件内容**：${o.map(n=>{const y=[`
- 主题：${n.themeName}`];return n.designToken&&y.push(`
  - designToken.json:
\`\`\`json
${n.designToken}
\`\`\``),n.globalsCss&&y.push(`
  - globals.css:
\`\`\`css
${n.globalsCss}
\`\`\``),n.designSpec&&y.push(`
  - DESIGN-SPEC.md: 请阅读 \`/src/themes/${n.themeName}/DESIGN-SPEC.md\``),y.join("")}).join("")}`:""}function Dn(o,d,n,y,f,U=[],z=[],k=[],l=[],V=[],h=[],A=[],J=[],E=!0,Z=[]){const X=d==="elements",P=X?"元素":"页面",W=X?"elements":"pages",K=o.trim().length>0,i=o.trim(),F=y?f.find(c=>c.name===y):null,B=F?`src/${W}/${F.name}`:null,ee=An(n)?Ke[n]:Ke.simultaneous,te=K?`**系统指令**：你将作为 Axhub Make 原型开发助手，创建 ${P}「**${i}**」原型`:`**系统指令**：你将作为 Axhub Make 原型开发助手，创建一个${P}原型`,G=K?`**重要说明**：
- 显示名称（displayName）：**${i}**
- 文件路径名（name）：请根据显示名称生成合适的英文或拼音路径名（小写字母、数字、连字符）
- 目标路径：\`src/${W}/[生成的路径名]\``:`**重要说明**：
- 显示名称（displayName）：**请根据用户需求自行生成合适的中文名称**
- 文件路径名（name）：请根据显示名称生成合适的英文或拼音路径名（小写字母、数字、连字符）
- 目标路径：\`src/${W}/[生成的路径名]\`
- **如果用户需求涉及多个${P}，请为每个${P}生成对应的名称和路径**`,R=Rn({hasName:K,displayName:i,itemType:P,hasReference:!!F,referenceDisplayName:F==null?void 0:F.displayName}),q=Tn(E),se=Kt({createMode:n,modeConfig:ee,generateAxure:E}),D=En({referencePath:B,referenceDisplayName:F==null?void 0:F.displayName}),H=We({title:"**📚 参考文档**（相对路径 /assets/docs/）：",selected:U,available:z,toLine:(c,T)=>`- **\`/assets/docs/${c}\`** - ${(T==null?void 0:T.displayName)||c}`}),w=We({title:"**🎨 主题配置**（相对路径 /src/themes/）：",selected:k,available:l,toLine:(c,T)=>`- **\`/src/themes/${c}/designToken.json\`** - ${(T==null?void 0:T.displayName)||c} Design Tokens`}),u=Pn(Z),p=We({title:"**📦 前端库文档**（相对路径 /assets/libraries/）：",selected:V,available:h,toLine:(c,T)=>`- **\`/assets/libraries/${c}\`** - ${(T==null?void 0:T.displayName)||c}`}),g=We({title:"**📊 参考数据**（相对路径 /assets/database/）：",selected:A,available:J,toLine:(c,T)=>`- **\`/assets/database/${c}\`** - ${(T==null?void 0:T.displayName)||c}`});return`${te}

⚠️ **重要提示**：请务必完整阅读以下所有规范文档和参考资料，不要偷懒！这些文档包含了关键的开发规范和最佳实践。
${se}${D}${w}${u}${g}${p}${H}${q}

${G}

${R}`}function Nn(o,d,n){const[y,f]=r.useState(!1),[U,z]=r.useState(""),[k,l]=r.useState(()=>localStorage.getItem(zt)||""),[V,h]=r.useState(()=>localStorage.getItem(Dt)||"simultaneous"),[A,J]=r.useState(()=>localStorage.getItem(Nt)==="true"),[E,Z]=r.useState([]),[X,P]=r.useState([]),[W,K]=r.useState([]),[i,F]=r.useState([]),[B,ee]=r.useState([]),[te,G]=r.useState([]),[R,q]=r.useState([]),[se,D]=r.useState([]),[H,w]=r.useState(!1);r.useEffect(()=>{localStorage.setItem(Dt,V)},[V]),r.useEffect(()=>{localStorage.setItem(Nt,String(A))},[A]),r.useEffect(()=>{localStorage.setItem(zt,k)},[k]);const u=r.useMemo(()=>(o==="elements"?d.elements:d.pages).filter(j=>j.isReference),[d,o]);r.useEffect(()=>{if(!H)return;(async()=>{try{const j=await fetch("/api/docs");if(j.ok){const M=await j.json();G(M);const Y=M.find(ne=>ne.name==="设计指导（简约）.md"||ne.name.startsWith("设计指导（简约）"));Y&&B.length===0&&ee([Y.name])}}catch(j){console.error("Failed to load docs:",j)}})()},[H]),r.useEffect(()=>{if(!H)return;(async()=>{try{const j=await fetch("/api/themes");if(j.ok){const M=await j.json();P(M)}}catch(j){console.error("Failed to load themes:",j)}})()},[H]),r.useEffect(()=>{if(!H)return;(async()=>{try{const j=await fetch("/api/libraries");if(j.ok){const M=await j.json();F(M);const Y=M.find(ne=>ne.name==="tailwind-css.md"||ne.name.startsWith("tailwind-css"));Y&&W.length===0&&K([Y.name])}}catch(j){console.error("Failed to load libraries:",j)}})()},[H]),r.useEffect(()=>{if(!H)return;(async()=>{try{const j=await fetch("/api/data/tables");if(j.ok){const Y=(await j.json()).map(ne=>({name:`${ne.fileName}.json`,displayName:ne.tableName}));D(Y)}}catch(j){console.error("Failed to load data assets:",j)}})()},[H]),r.useEffect(()=>{y&&(k&&(u.some(j=>j.name===k)||l("")),w(!0))},[y,u,k]);const p=async()=>{console.log("=== 点击了生成 AI Prompt 按钮 ==="),console.log("createName:",U),console.log("createReference:",k),console.log("createMode:",V),console.log("activeTab:",o);const N=await g();N&&(console.log("开始复制 Prompt 到剪贴板..."),console.log("Prompt 长度:",N.length),navigator.clipboard.writeText(N).then(()=>{console.log("✅ 复制成功"),f(!1),z(""),ee([]),Z([]),K([]),q([]),n.success("复制成功，请返回 IDE 发送给 AI"),w(!1),G([]),P([]),F([]),D([])}))},g=async()=>{let N=[];if(E.length>0)try{N=await Promise.all(E.map(async j=>{const M=await fetch("/api/themes/get-contents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({themeName:j})});if(!M.ok){const ne=await M.json().catch(()=>null);throw new Error((ne==null?void 0:ne.error)||"主题内容获取失败")}const Y=await M.json();return{themeName:j,designToken:(Y==null?void 0:Y.designToken)??null,globalsCss:(Y==null?void 0:Y.globalsCss)??null,designSpec:(Y==null?void 0:Y.designSpec)??null}}))}catch(j){console.error("Failed to load theme contents:",j),n.error((j==null?void 0:j.message)||"主题内容获取失败")}return Dn(U,o,V,k,u,B,te,E,X,W,i,R,se,A,N)};return{createDialogVisible:y,createName:U,createReference:k,createMode:V,generateAxure:A,referenceItems:u,selectedThemes:E,availableThemes:X,selectedLibraries:W,availableLibraries:i,selectedDocs:B,availableDocs:te,selectedDataAssets:R,availableDataAssets:se,setCreateDialogVisible:f,setCreateName:z,setCreateReference:l,setCreateMode:h,setGenerateAxure:J,setSelectedThemes:Z,setSelectedLibraries:K,setSelectedDocs:ee,setSelectedDataAssets:q,handleCreateSubmit:p,handleSendPrompt:async()=>{const N=await g();if(!N)return;const j=n.loading("正在发送 Prompt...",0);try{const M=async(Y,ne)=>{const be=await fetch("/api/ws/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:Y,payload:ne})});if(!be.ok){const ke=await be.json().catch(()=>null);throw new Error((ke==null?void 0:ke.error)||"发送失败")}};await M("handshake","test-client"),await M("insert",N),n.success("已通过 WebSocket 发送"),w(!1),G([]),P([]),F([]),D([])}catch(M){n.error((M==null?void 0:M.message)||"发送失败")}finally{j()}},handleCreateCancel:()=>{f(!1),z(""),ee([]),Z([]),K([]),q([]),w(!1),G([]),P([]),F([]),D([])}}}function zn({isDarkMode:o,setIsDarkMode:d}){const[n,y]=r.useState(!0),[f,U]=r.useState({elements:[],pages:[]}),[z,k]=r.useState(!1),[l,V]=r.useState(()=>{const t=localStorage.getItem(Pt);return t==="elements"||t==="pages"?t:"elements"}),[h,A]=r.useState(null),[J,E]=r.useState("desktop"),[Z,X]=r.useState(1),P=Ie.useRef(null),[W,K]=r.useState(""),[i,F]=L.useMessage(),[B,ee]=Ne.useModal(),[te,G]=r.useState({width:600,height:400}),[R,q]=r.useState(0),[se,D]=r.useState(!1),[H,w]=r.useState("demo"),[u,p]=r.useState("spec"),{createDialogVisible:g,createName:c,createReference:T,createMode:N,generateAxure:j,referenceItems:M,selectedThemes:Y,availableThemes:ne,selectedLibraries:be,availableLibraries:ke,selectedDocs:qe,availableDocs:Ye,selectedDataAssets:Ze,availableDataAssets:de,setCreateDialogVisible:Ue,setCreateName:Xe,setCreateReference:Qe,setCreateMode:x,setGenerateAxure:he,setSelectedThemes:pe,setSelectedLibraries:re,setSelectedDocs:ve,setSelectedDataAssets:ue,handleCreateSubmit:me,handleSendPrompt:we,handleCreateCancel:Gt}=Nn(l,f,i),qt=()=>{const t=`${window.location.protocol}//${window.location.hostname}:${window.location.port}${(h==null?void 0:h.demoUrl)||""}`;navigator.clipboard.writeText(t).then(()=>{i.success("本地链接已复制")}).catch(s=>{i.error("复制失败"),console.error("复制失败:",s)}),D(!1)},Yt=()=>{const t=bt();navigator.clipboard.writeText(t).then(()=>{i.success("局域网链接已复制")}).catch(s=>{i.error("复制失败"),console.error("复制失败:",s)}),D(!1)},Zt=()=>{window.open("/api/download-dist","_blank"),D(!1)},Xt=async()=>{let t="",s="";const a=["vscode","cursor"];if(h){const m=h;if(H==="spec"){const v=u==="prd"?"prd.md":"spec.md";t=`src/${l}/${h.name}/${v}`,s=`[${h.displayName} - ${v==="prd.md"?"PRD":"SPEC"}](${Me(h)}/${v})`}else{if(m.filePath){const v=m.filePath.indexOf("src/");v>=0?t=m.filePath.substring(v):t=m.filePath}else t=`src/${l}/${h.name}/index.tsx`;s=`[${h.displayName}](${Me(h)})`}}else{i.warning("请先选择条目");return}const b=i.loading("正在发送到 IDE...",0);try{s&&await navigator.clipboard.writeText(s);const m=await xt.sendWsMessage({type:"handshake",payload:"prototype-admin",targetClientTypes:a});if(!(m!=null&&m.sent)){i.warning("编辑器未连接，已复制了文件标题，可前往使用");return}const v=await xt.sendWsMessage({type:"open-file",payload:t,targetClientTypes:a});if(!(v!=null&&v.sent)){i.warning("编辑器未连接，已复制了文件标题，可前往使用");return}i.success("已在编辑器中打开，并复制了文件标题，可前往编辑")}catch(m){i.error((m==null?void 0:m.message)||"发送失败")}finally{b()}},Qt=async t=>{let s="";if(H==="spec"){const a=u==="prd"?"prd.md":"spec.md";s=`[${t.displayName} - ${a==="prd.md"?"PRD":"SPEC"}](${Me(t)}/${a})`}else s=`[${t.displayName}](${Me(t)})`;if(!s){i.warning("无法获取路径");return}try{await navigator.clipboard.writeText(s),i.success("路径已复制")}catch(a){console.error("Failed to copy: ",a),i.error("复制失败")}},es=r.useMemo(()=>[{value:"desktop",icon:e.jsx(sn,{})},{value:"mobile",icon:e.jsx(nn,{})},{value:"tablet",icon:e.jsx(on,{})}],[]),[Te,et]=r.useState(!1),[ts,tt]=r.useState(!1),[S,je]=r.useState({width:1920,height:1080,includeConfig:"code",contentType:"title",rawScreenshotUrl:"",screenshotWidth:0,screenshotHeight:0,previewUrl:""});r.useEffect(()=>{De()},[]),r.useEffect(()=>{const t=s=>{s.data&&s.data.type==="SCREENSHOT_CAPTURED"?je(a=>({...a,rawScreenshotUrl:s.data.dataUrl,screenshotWidth:s.data.width,screenshotHeight:s.data.height})):s.data&&s.data.type==="spec-doc-changed"&&(console.log("Spec document changed:",s.data.activeDocKey),p(s.data.activeDocKey))};return window.addEventListener("message",t),()=>window.removeEventListener("message",t)},[]),r.useEffect(()=>{if(!h)return;if(S.contentType==="screenshot"&&!S.rawScreenshotUrl){je(s=>({...s,previewUrl:""}));return}(async()=>{const s=l==="elements"?"元素":"页面",a=st(S.rawScreenshotUrl,S,h.displayName,s),b=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),m=URL.createObjectURL(b);je(v=>({...v,previewUrl:m}))})()},[S.rawScreenshotUrl,S.width,S.height,S.contentType,h,l]);const st=(t,s,a,b)=>{if(s.contentType==="title"){const m=s.width,v=s.height,C=m/2,$=v/2;return`<svg width="${m}" height="${v}" viewBox="0 0 ${m} ${v}" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="100%" height="100%" fill="transparent" />
              <g id="textGroup" transform="translate(${C},${$})">
                <!-- Main Title -->
                <text id="mainTitle"
                      x="0" y="-12"
                      text-anchor="middle"
                      font-family="Arial, Helvetica, sans-serif"
                      font-size="28"
                      font-weight="700"
                      fill="#333">
                  ${a}
                </text>

                <!-- Description -->
                <text id="description"
                      x="0" y="18"
                      text-anchor="middle"
                      font-family="Arial, Helvetica, sans-serif"
                      font-size="14"
                      font-weight="400"
                      fill="#999">
                  Axhub Runtime ${b}
                </text>
              </g>
            </svg>`}else return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="${s.width}" height="${s.height}" viewBox="0 0 ${s.width} ${s.height}">
                <rect width="100%" height="100%" fill="transparent" />
                <image x="0" y="0" width="${s.width}" height="${s.height}" preserveAspectRatio="xMidYMin meet" xlink:href="${t}"/>
            </svg>`},Fe=Ie.useRef(!1);r.useEffect(()=>{if(Fe.current=!1,S.contentType==="screenshot"){const t=l==="pages"?1920:500,s=l==="pages"?1080:300;je(a=>({...a,width:t,height:s,screenshotWidth:0,screenshotHeight:0,rawScreenshotUrl:""}))}else S.contentType==="title"&&je(t=>({...t,width:500,height:300}))},[l,S.contentType]),r.useEffect(()=>{Fe.current||S.contentType==="screenshot"&&(!S.screenshotWidth||!S.screenshotHeight||je(t=>({...t,width:S.screenshotWidth,height:S.screenshotHeight})))},[S.screenshotWidth,S.screenshotHeight]);const ss=(t,s)=>{Fe.current=!0,je(a=>({...a,[t]:s||0}))},ns=()=>{S.contentType==="screenshot"&&Te&&ot()},os=()=>{Fe.current=!0;const t=S.width,s=S.height;je(a=>({...a,width:s,height:t})),setTimeout(()=>{S.contentType==="screenshot"&&Te&&ot(s,t)},0)};r.useEffect(()=>{localStorage.setItem(Pt,l)},[l]),r.useEffect(()=>{if(!n&&f){const t=l==="elements"?f.elements:f.pages;t.length>0?(A(t[0]),l==="elements"&&G({width:600,height:400})):A(null)}},[n,f,l]);async function De(){var t,s;try{const a=await fetch("/api/entries.json");if(!a.ok)throw new Error("Failed to fetch data");const b=await a.json();console.log("Loaded data:",b),console.log("Reference elements:",(t=b.elements)==null?void 0:t.filter(m=>m.isReference)),console.log("Reference pages:",(s=b.pages)==null?void 0:s.filter(m=>m.isReference)),U(b)}catch(a){i.error("加载数据失败: "+a.message)}finally{y(!1)}}const Me=t=>{const s=t;if(s.filePath){const b=s.filePath.indexOf("src/");if(b>=0){let m=s.filePath.substring(b);return m=m.replace(/\/index\.(t|j)sx?$/i,""),m}return s.filePath}return`${l==="pages"?"src/pages":"src/elements"}/${t.name}`},rs=t=>{const s=`${l}/${t.name}`,a=`/api/zip?path=${encodeURIComponent(s)}`;window.open(a,"_blank")},as=t=>{const s=In(t,l);navigator.clipboard.writeText(s),i.success("设置为参考的 Prompt 已复制，请返回 IDE 发送给 AI")},is=t=>{const s=l==="elements"?`elements/${t.name}`:`pages/${t.name}`;B.confirm({title:`确定要取消 "${t.displayName}" 的参考状态吗？`,content:"取消后该项目将不再是参考项目。",okText:"确认",cancelText:"取消",async onOk(){const a=i.loading("正在取消参考...",0);try{const b=await fetch("/api/unset-reference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s})});if(!b.ok){const m=await b.json();throw new Error(m.error||"取消参考失败")}i.success("已取消参考"),A(null),De()}catch(b){i.error(b.message||"取消参考失败")}finally{a()}}})},ls=t=>{const s=l==="elements"?"元素":"页面",a=l==="elements"?`elements/${t.name}`:`pages/${t.name}`;let b=t.displayName;B.confirm({title:`重命名${s}`,content:e.jsx("div",{children:e.jsx(Re,{autoFocus:!0,defaultValue:t.displayName,placeholder:"请输入新的显示名称（支持中文）",onChange:m=>{b=m.target.value}})}),okText:"确认",cancelText:"取消",async onOk(){const m=b.trim();if(!m)return i.error("请输入新的名称"),Promise.reject();if(m===t.displayName)return;const v=i.loading("正在重命名...",0);try{const C=await fetch("/api/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a,newName:m})});if(!C.ok){const $=await C.json().catch(()=>({}));throw new Error($.error||"重命名失败")}i.success("重命名成功"),A(null),De()}catch(C){return i.error(C.message||"重命名失败"),Promise.reject()}finally{v()}}})},cs=async(t,s)=>{const a=await fetch("/api/items/check-references",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemType:t,itemName:s})});if(!a.ok){const b=await a.json().catch(()=>({}));throw new Error(b.error||"检查引用失败")}return a.json()},ds=t=>{if(t.isReference){i.error("参考项目无法删除，请先取消参考状态");return}const s=l,a=l==="elements"?"元素":"页面",b=`${s}/${t.name}`,m=async()=>{const C=i.loading("正在删除...",0);try{const $=await fetch("/api/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:b})});if(!$.ok){const I=await $.json();throw new Error(I.error||"删除失败")}i.success("删除成功"),A(null),De()}catch($){i.error($.message||"删除失败")}finally{C()}};(async()=>{const C=i.loading("正在检查引用...",0);try{const $=await cs(s,t.name),I=Array.isArray($==null?void 0:$.references)?$.references:[];if(I.length>0){const _=I.map(Q=>`- ${Q}`).join(`
`),le=`我希望删除${a} "${t.displayName}" (${t.name})。
该${a}位于项目中的相对路径为：\`src/${s}/${t.name}\`

已检测到以下文件引用了该${a}：
${_}

请帮我执行以下检查和操作：
1. 核对上述引用是否准确，并补充遗漏的引用文件（优先检查 \`src/elements/\` 与 \`src/pages/\`）。
2. 如果确认继续删除，请协助我将该${a}在引用处替换为合适的实现，并更新引用路径，使这些原型不再依赖该目录。
3. 完成上述解耦操作后，再彻底删除目录 \`src/${s}/${t.name}\`。`;B.confirm({title:`检测到${a}引用`,width:720,okText:"复制提示",cancelText:"取消",content:e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:8},children:["已检测到以下文件引用了该",a,"："]}),e.jsx("pre",{style:{maxHeight:260,overflow:"auto",background:"#f6f7f9",padding:12,borderRadius:6},children:_})]}),async onOk(){try{await navigator.clipboard.writeText(le),i.success("已复制处理提示，请返回编辑器让 AI 处理。")}catch(Q){console.error("Failed to copy: ",Q),i.error("复制失败，请手动处理")}}})}else B.confirm({title:`确定要删除${a} "${t.displayName}" 吗？`,content:"未检测到引用文件。删除后无法恢复，请谨慎操作。",okText:"确认删除",okType:"danger",cancelText:"取消",onOk:m})}catch($){i.error($.message||"检查引用失败")}finally{C()}})()},hs=async t=>{const s=l==="elements"?"elements":"pages",a=`src/${s}/${t.name}`,b=(v,C)=>{let $=`${v}-copy`,I=1;for(;C.includes($);)I++,$=`${v}-copy${I}`;return $},m=i.loading("正在创建副本...",0);try{const v=(l==="elements"?f.elements:f.pages).map(_=>_.name),C=b(t.name,v),$=`src/${s}/${C}`,I=await fetch("/api/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourcePath:a,targetPath:$})});if(!I.ok){const _=await I.json();throw new Error(_.error||"创建副本失败")}i.success(`副本 "${C}" 创建成功`),De()}catch(v){i.error(v.message||"创建副本失败")}finally{m()}},Be=r.useMemo(()=>{const t=l==="elements"?f.elements:f.pages;if(!W)return t;const s=W.toLowerCase();return t.filter(a=>a.displayName.toLowerCase().includes(s)||a.name.toLowerCase().includes(s))},[f,l,W]),ps=({key:t})=>{const s=Be.find(a=>a.name===t);s&&(A(s),p("spec"),l==="elements"&&G({width:600,height:400}))},wt=t=>{V(t),K(""),A(null),p("spec")},fs=()=>{q(t=>t+1)},us=()=>{if(!h)return"";const t=window.location.origin+h.demoUrl,s=new URL(t,window.location.origin);if(s.searchParams.set("inspecta","true"),Se.id!=="desktop"){const a=nt.width?Math.round(nt.width):Se.width;a&&s.searchParams.set("width",String(a))}return s.toString()},ms=()=>{const t=us();t&&window.open(t,"_blank")},jt=(t=!0)=>new Promise((s,a)=>{const b=document.querySelectorAll("iframe"),m=b[b.length-1];if(!m||!m.contentWindow){a(new Error("未找到可导出的预览窗口"));return}const v=window.setTimeout(()=>{window.removeEventListener("message",C),a(new Error("导出超时，请重试"))},15e3),C=$=>{if($.source===m.contentWindow&&!(!$.data||$.data.type!=="FIGMA_JSON_READY"))if(window.removeEventListener("message",C),window.clearTimeout(v),$.data.success){const I=$.data.json??$.data.data??$.data.payload;if(I===void 0){a(new Error("导出成功但未返回数据（缺少 json/data/payload 字段）"));return}const _=Array.isArray(I)?I:I.layers||[];s({layers:_,widgetId:$.data.widgetId,pageId:$.data.pageId})}else a(new Error($.data.error||"导出失败"))};window.addEventListener("message",C),m.contentWindow.postMessage({type:"EXPORT_FIGMA_JSON",rootName:(h==null?void 0:h.displayName)||(h==null?void 0:h.name),enableAutoLayout:t},"*")}),gs=async(t=!0)=>{if(!h){i.warning("请先选择一个条目");return}const s=i.loading("正在生成 Figma JSON...",0);try{const{layers:a,widgetId:b,pageId:m}=await jt(t),v={layers:a,...b?{widgetId:b}:{},...m?{pageId:m}:{}},C=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),$=URL.createObjectURL(C),I=document.createElement("a");I.href=$,I.download=`${h.name}-${l}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL($),i.success("JSON 已下载")}catch(a){i.error((a==null?void 0:a.message)||"导出失败")}finally{s()}},bt=()=>{if(!h)return"";const t=h.demoUrl,s=window.__LOCAL_IP__||"localhost",a=window.location.port||(window.location.protocol==="https:"?"443":"80");return`${window.location.protocol}//${s}:${a}${t}`},Se=r.useMemo(()=>lt.find(t=>t.id===J)||lt[0],[J]);r.useEffect(()=>{lt.some(s=>s.id===J)||E("desktop")},[J]);const[nt,vt]=r.useState({width:0,height:0});r.useEffect(()=>{if(Se.id==="desktop"||Se.width===0||!P.current){vt({width:0,height:0}),X(1);return}const t=()=>{if(!P.current)return;const s=P.current.clientWidth*.9,a=P.current.clientHeight*.9,b=Se.width,m=Se.height,$=24+8,I=(s-$)/b,_=(a-$)/m,le=Math.min(I,_),Q=b*le,ge=m*le;vt({width:Q,height:ge}),X(1)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[Se,z]);const ot=(t,s)=>{const a=t??S.width,b=s??S.height,m=document.querySelectorAll("iframe"),v=m[m.length-1];v&&v.contentWindow&&v.contentWindow.postMessage({type:"CAPTURE_SCREENSHOT",targetWidth:a,targetHeight:b},"*")};r.useEffect(()=>{if(Te&&S.contentType==="screenshot"){const t=l==="pages"?1920:500,s=l==="pages"?1080:300;S.width===t&&S.height===s&&ot()}if(!Te){const t=document.querySelectorAll("iframe"),s=t[t.length-1];s&&s.contentWindow&&s.contentWindow.postMessage({type:"RESET_SCREENSHOT_STYLES"},"*")}},[Te,S.contentType,S.width,S.height]);const[xs,rt]=r.useState([]),ys=window.location.port||(window.location.protocol==="https:"?"443":"80"),at=async()=>{try{const t=await fetch("/api/ws/clients");if(t.ok){const a=(await t.json()).clients||[];return rt(a),a}else return rt([]),[]}catch(t){return console.error("Failed to check WS clients",t),rt([]),[]}};r.useEffect(()=>{at()},[]);const ws=async()=>{if(!h){i.warning("请先选择一个条目");return}const t=i.loading("正在检查连接...",0),s=await at();t(),s.length===0?B.confirm({title:"未检测到 Figma 连接",content:e.jsxs("div",{children:[e.jsx("p",{children:"请确保 Figma 插件已打开并连接到当前服务。"}),e.jsxs("p",{style:{color:"#999",fontSize:12},children:["当前服务端口: ",ys]})]}),okText:"仍要推送",cancelText:"取消",onOk:()=>St()}):St()},St=async()=>{const t=i.loading("正在获取数据...",0);try{const{layers:s,widgetId:a,pageId:b}=await jt();if(t(),!s||!Array.isArray(s)||s.length===0){i.error("图层数据为空，无法推送");return}let m;l==="elements"?(a||i.warning("元素缺少 widgetId，可能导致同步失败"),m={type:"sync-widget-content",widgetId:a||`element-${(h==null?void 0:h.name)||"unknown"}-${Date.now()}`,data:{layers:s},blurImages:!1,metadata:{source:"extension",timestamp:Date.now()}}):m={type:"sync-page-content",...b?{pageId:b}:{},data:{layers:s},blurImages:!1,metadata:{source:"extension",timestamp:Date.now()}};const v=i.loading("正在推送到 Figma...",0);try{const C=await fetch("/api/ws/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(C.ok)await C.json(),i.success("推送成功");else{const $=await C.text();throw new Error($||"发送失败")}}catch(C){i.error("推送失败: "+C.message)}finally{v()}}catch(s){t(),i.error((s==null?void 0:s.message)||"获取数据失败")}},js=(t,s,a,b=2)=>new Promise((m,v)=>{const C=new Image,$=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),I=URL.createObjectURL($);C.onload=()=>{const _=document.createElement("canvas");_.width=s*b,_.height=a*b;const le=_.getContext("2d");if(!le){v(new Error("Could not get canvas context"));return}le.drawImage(C,0,0,_.width,_.height),URL.revokeObjectURL(I),m(_.toDataURL("image/png"))},C.onerror=_=>{URL.revokeObjectURL(I),v(_)},C.src=I}),bs=async()=>{if(h){tt(!0);try{const t=window.location.origin+h.jsUrl,s=await fetch(t);if(!s.ok)throw new Error(`Failed to fetch code: ${s.statusText}`);const a=await s.text();let b="";if(h){const v=`${window.location.origin}/${l}/${h.name}/hack.css`;try{const C=await fetch(v);C.ok&&(b=await C.text())}catch(C){console.warn("fetch hack.css failed",C)}}const m=async(v=!1)=>{const C=`${window.location.origin}/${l}/${h.name}`,$=["spec","prd"],I={};for(const Q of $){const ge=`${C}/${Q}.md`;try{const ce=await fetch(ge);if(ce.ok){const fe=await ce.text(),xe={spec:"规格文档",prd:"需求文档"};I[Q]={name:xe[Q],content:fe}}}catch(ce){console.warn(`Failed to fetch ${Q}.md`,ce)}}if(v){const Q=`${l}/${h.name}`,ge=`${window.location.origin}/api/source?path=${encodeURIComponent(Q)}`;try{const ce=await fetch(ge);if(ce.ok){const xe=`\`\`\`tsx
${await ce.text()}
\`\`\`
`;I.code={name:"参考代码",content:xe}}}catch(ce){console.warn("Failed to fetch source code",ce)}}const _=Object.keys(I);return _.length>1?I:_.length===1?I[_[0]].content:null};if(S.contentType==="screenshot"&&!S.rawScreenshotUrl){i.warning("正在生成截图，请稍候..."),tt(!1);return}try{let v="",C="";if(S.includeConfig!=="none"&&(v=a,S.includeConfig==="codeAndDocs"||S.includeConfig==="codeAndDocsAndSource")){const ye=S.includeConfig==="codeAndDocsAndSource",$e=await m(ye);$e&&(C=$e)}const $=l==="elements"?"元素":"页面";let I="";if(S.contentType==="title"){const ye=st("",S,h.displayName,$),$e=await js(ye,S.width,S.height,2);I=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="${S.width}" height="${S.height}" viewBox="0 0 ${S.width} ${S.height}">
                            <rect width="100%" height="100%" fill="transparent" />
                            <image x="0" y="0" width="${S.width}" height="${S.height}" preserveAspectRatio="xMidYMin meet" xlink:href="${$e}"/>
                        </svg>`}else I=st(S.rawScreenshotUrl,S,h.displayName,$);const le=new DOMParser().parseFromString(I,"image/svg+xml"),Q=le.querySelector("svg");if(!Q)throw new Error("SVG generation failed");if(v||C){const ye={code:v,spec:C};Q.setAttribute("AxExtraData",encodeURIComponent(JSON.stringify(ye)))}if(S.includeConfig!=="none"){const ye={time:Math.floor(Date.now()/1e3),config:{codeLink:t,...l==="pages"?{isFullScreen:!0}:{},...b?{hackCss:b}:{}}};Q.setAttribute("AxData",encodeURIComponent(JSON.stringify(ye)))}const ce=new XMLSerializer().serializeToString(le),fe=new Blob([ce],{type:"image/svg+xml;charset=utf-8"}),xe=URL.createObjectURL(fe),oe=document.createElement("a");oe.href=xe,oe.download=`${h.name}.svg`,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe),URL.revokeObjectURL(xe),i.success("SVG 导出成功"),et(!1)}catch(v){console.error("Image export failed:",v),i.error("图片导出失败")}}catch(t){i.error(`导出失败: ${t.message}`),console.error("导出失败:",t)}finally{tt(!1)}}},vs=async t=>{if(!h)throw new Error("未选择项目");const s=window.location.origin+h.jsUrl,a=await fetch(s);if(!a.ok)throw new Error(`Failed to fetch code: ${a.statusText}`);const b=await a.text();let m="";const v=`${window.location.origin}/${l}/${h.name}/hack.css`;try{const I=await fetch(v);I.ok&&(m=await I.text())}catch{}const C=async(I=!1)=>{const _=`${window.location.origin}/${l}/${h.name}`,le=["spec","prd"],Q={};for(const fe of le){const xe=`${_}/${fe}.md`;try{const oe=await fetch(xe);if(oe.ok){const ye=await oe.text(),$e={spec:"规格文档",prd:"需求文档"};Q[fe]={name:$e[fe],content:ye}}}catch(oe){console.warn(`Failed to fetch ${fe}.md`,oe)}}if(I){const fe=`${l}/${h.name}`,xe=`${window.location.origin}/api/source?path=${encodeURIComponent(fe)}`;try{const oe=await fetch(xe);if(oe.ok){const $e=`\`\`\`tsx
${await oe.text()}
\`\`\`
`;Q.code={name:"参考代码",content:$e}}}catch(oe){console.warn("Failed to fetch source code",oe)}}const ge=Object.keys(Q);return ge.length>1?Q:ge.length===1?Q[ge[0]].content:null},$={time:Math.floor(Date.now()/1e3),config:{code:b,...l==="pages"?{isFullScreen:!0}:{},...m?{hackCss:m}:{}}};if(t==="codeAndDocs"||t==="codeAndDocsAndSource"){const _=await C(t==="codeAndDocsAndSource");_&&($.config.spec=_)}return JSON.stringify($,null,2)},Ss=h?H==="spec"?h.specUrl:h.demoUrl:"",$s=t=>{const s=window.location.origin+t.demoUrl;window.open(s,"_blank")};return e.jsxs(Le,{style:{minHeight:"100vh"},children:[F,e.jsx("style",{children:`
                .resize-handle-right {
                    cursor: ew-resize !important;
                    z-index: 100 !important;
                }
                .resize-handle-right::before {
                    content: '';
                    position: absolute;
                    right: 50%;
                    top: 50%;
                    transform: translate(50%, -50%);
                    width: 2px;
                    height: 40px;
                    background: var(--ant-color-border);
                    border-radius: 1px;
                    transition: all 0.2s;
                    z-index: 100;
                }
                .resize-handle-right:hover::before,
                .resize-handle-right:active::before {
                    background: var(--ant-color-text-secondary);
                    width: 3px;
                    height: 50px;
                }
                .resize-handle-bottom {
                    cursor: ns-resize !important;
                    z-index: 100 !important;
                }
                .resize-handle-bottom::before {
                    content: '';
                    position: absolute;
                    left: 50%;
                    bottom: 50%;
                    transform: translate(-50%, 50%);
                    width: 40px;
                    height: 2px;
                    background: var(--ant-color-border);
                    border-radius: 1px;
                    transition: all 0.2s;
                    z-index: 100;
                }
                .resize-handle-bottom:hover::before,
                .resize-handle-bottom:active::before {
                    background: var(--ant-color-text-secondary);
                    width: 50px;
                    height: 3px;
                }
                .resize-handle-bottomRight {
                    cursor: nwse-resize !important;
                    z-index: 100 !important;
                }
                .resize-handle-bottomRight::before {
                    content: '';
                    position: absolute;
                    right: 0;
                    bottom: 0;
                    width: 12px;
                    height: 12px;
                    background: var(--ant-color-border);
                    border-radius: 0 0 6px 0;
                    transition: all 0.2s;
                    z-index: 100;
                }
                .resize-handle-bottomRight:hover::before,
                .resize-handle-bottomRight:active::before {
                    background: var(--ant-color-border-secondary);
                    width: 16px;
                    height: 16px;
                }
                /* 容器悬停时显示手柄 */
                .ant-card-hoverable:hover .resize-handle-right::before,
                .ant-card-hoverable:hover .resize-handle-bottom::before,
                .ant-card-hoverable:hover .resize-handle-bottomRight::before {
                    background: var(--ant-color-border-secondary);
                }

                /* 菜单项 hover 时显示更多按钮 */
                .menu-item-wrapper .more-btn {
                    opacity: 0;
                    transition: opacity 0.2s;
                }
                .menu-item-wrapper:hover .more-btn,
                .menu-item-wrapper.is-selected .more-btn,
                .menu-item-wrapper .more-btn.ant-dropdown-open {
                    opacity: 1;
                }

                /* 移动端响应式样式 */
                @media (max-width: 768px) {
                    /* 隐藏 PC 端的完整布局 */
                    .pc-layout {
                        display: none !important;
                    }
                    
                    /* 显示移动端简化布局 */
                    .mobile-layout {
                        display: block !important;
                    }
                }

                @media (min-width: 769px) {
                    /* PC 端显示完整布局 */
                    .pc-layout {
                        display: block !important;
                    }
                    
                    /* 隐藏移动端布局 */
                    .mobile-layout {
                        display: none !important;
                    }
                }

                /* 移动端列表样式 */
                .mobile-item-card {
                    background: ${o?"#1f1f1f":"#fff"};
                    border: 1px solid ${o?"#303030":"#f0f0f0"};
                    border-radius: 8px;
                    padding: 16px;
                    margin-bottom: 12px;
                    cursor: pointer;
                    transition: all 0.2s;
                }

                .mobile-item-card:hover {
                    border-color: ${o?"#177ddc":"#1890ff"};
                    box-shadow: 0 2px 8px ${o?"rgba(0,0,0,0.3)":"rgba(0,0,0,0.1)"};
                }

                .mobile-item-card:active {
                    transform: scale(0.98);
                }

                .mobile-item-title {
                    font-size: 16px;
                    font-weight: 500;
                    color: ${o?"#fff":"#000"};
                    margin-bottom: 4px;
                }

                .mobile-item-name {
                    font-size: 12px;
                    color: ${o?"#8c8c8c":"#999"};
                }
            `}),e.jsxs("div",{className:"pc-layout",children:[e.jsx(yn,{collapsed:z,setCollapsed:k,selectedItem:h,viewMode:H,setViewMode:w,activeTab:l,selectedDeviceId:J,setSelectedDeviceId:E,deviceSegmentOptions:es,handleOpenInspect:ms,handleRefreshElement:fs,handleCopyLocalLink:qt,handleCopyLANLink:Yt,handleDownloadZip:Zt,getLANUrl:bt,qrCodeVisible:se,setQrCodeVisible:D,wsClients:xs,checkConnection:at,handlePushToFigma:ws,handleDownloadFigmaJson:gs,setIsExportModalOpen:et,handleOpenIdeFile:Xt,isDarkMode:o,setIsDarkMode:d,currentSpecDocKey:u}),e.jsxs(Le,{children:[e.jsx(fn,{collapsed:z,loading:n,activeTab:l,handleTabChange:wt,data:f,searchText:W,setSearchText:K,filteredItems:Be,selectedItem:h,handleMenuClick:ps,handleDownloadItemSource:rs,handleRenameItem:ls,handleSetReference:as,handleUnsetReference:is,handleDuplicateItem:hs,handleDeleteItem:ds,handleCopyItemPath:Qt,setCreateDialogVisible:Ue}),e.jsx(vn,{containerRef:P,selectedItem:h,activeTab:l,currentDevice:Se,displaySize:nt,scale:Z,elementIframeKey:R,iframeUrl:Ss,elementIframeSize:te,setElementIframeSize:G,viewMode:H})]}),e.jsx(kn,{visible:g,onClose:Gt,onOk:me,onSendPrompt:we,activeTab:l,createName:c,setCreateName:Xe,createReference:T,setCreateReference:Qe,createMode:N,setCreateMode:x,generateAxure:j,setGenerateAxure:he,referenceItems:M,selectedDocs:qe,setSelectedDocs:ve,availableDocs:Ye,selectedThemes:Y,setSelectedThemes:pe,availableThemes:ne,selectedDataAssets:Ze,setSelectedDataAssets:ue,availableDataAssets:de,selectedLibraries:be,setSelectedLibraries:re,availableLibraries:ke}),e.jsx(ln,{open:Te,onClose:()=>et(!1),imageConfig:S,setImageConfig:je,onDimensionChange:ss,onSwapDimensions:os,onDimensionBlur:ns,isExporting:ts,onExport:bs,onCopyConfig:vs,activeTab:l,itemName:h==null?void 0:h.name})]}),e.jsx("div",{className:"mobile-layout",style:{display:"none"},children:e.jsxs("div",{style:{padding:"16px",minHeight:"100vh",background:o?"#141414":"#f5f5f5"},children:[e.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("div",{children:e.jsxs("h1",{style:{margin:0,fontSize:"24px",fontWeight:600,color:o?"#fff":"#000"},children:["Axhub ",e.jsx("span",{style:{color:"#008F5D"},children:"Make"})]})}),e.jsx(O,{type:"text",icon:o?e.jsx(Wt,{}):e.jsx(Ht,{}),onClick:()=>d(!o)})]}),e.jsx(yt,{activeKey:l,onChange:t=>wt(t),style:{marginBottom:"16px"},items:[{key:"pages",label:`页面 (${f.pages.length})`,icon:e.jsx(Pe,{})},{key:"elements",label:`元素 (${f.elements.length})`,icon:e.jsx(ht,{})}]}),e.jsx(Re,{placeholder:"搜索...",prefix:e.jsx(_t,{}),value:W,onChange:t=>K(t.target.value),allowClear:!0,style:{marginBottom:"16px"}}),n?e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(ze,{tip:"加载中..."})}):e.jsx("div",{children:Be.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:o?"#8c8c8c":"#999"},children:["暂无",l==="elements"?"元素":"页面"]}):Be.map(t=>e.jsxs("div",{className:"mobile-item-card",onClick:()=>$s(t),children:[e.jsx("div",{className:"mobile-item-title",children:t.displayName}),e.jsx("div",{className:"mobile-item-name",children:t.name})]},t.name))})]})}),F,ee]})}function Ln(){const[o,d]=r.useState(()=>{try{return localStorage.getItem(Lt)==="true"}catch{return!1}}),n=y=>{d(y);try{localStorage.setItem(Lt,String(y))}catch(f){console.error("Failed to save dark mode preference:",f)}};return e.jsx(en,{theme:rn(o),children:e.jsx(tn,{children:e.jsx(zn,{isDarkMode:o,setIsDarkMode:n})})})}const On=Qs.createRoot(document.getElementById("root"));On.render(e.jsx(Ln,{}));
