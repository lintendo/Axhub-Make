import"./chunks/modulepreload-polyfill.js";import{I as Se,T as Oe,U as r,s as M,j as e,M as Pe,ac as gt,G as Ne,u as ae,A as He,S as ge,a5 as vt,ad as $s,ae as rt,af as me,ag as St,b as U,ah as Ct,ai as Re,aj as Ve,t as Le,ak as ks,m as $t,v as Ot,al as Is,p as Ee,am as Lt,a3 as Ts,an as As,L as ze,Q as Ut,e as Rs,ao as Ps,ap as _e,aq as lt,P as Es,ar as ct,D as dt,O as Ds,F as Mt,J as Ns,K as zs,N as Os,a as ht,as as Ls,at as Ft,$ as re,au as pt,i as je,k as Us,l as Ms,n as ut,w as Bt,x as Wt,y as Fs,f as kt,z as Bs,c as Ws,B as It,av as Ht,q as ft,a0 as Hs,aw as _s,ax as Vs,ay as Tt,az as Js,aA as Gs,aB as Ks,W as _t,aC as qs,aD as Ys,aE as Zs,R as Xs,C as Qs,aF as en,aG as At,aa as tn,ab as sn,E as nn,aH as on,h as rn,aI as an}from"./chunks/vendor.js";import{g as ln}from"./chunks/index.js";const Rt="axhub-admin-active-tab",Pt="axhub-admin-create-mode",Et="axhub-admin-generate-axure",Dt="axhub-admin-create-reference",Nt="axhub-make-dark-mode",at=[{id:"desktop",name:"ç”µè„‘",width:0,height:0,type:"desktop"},{id:"mobile",name:"æ‰‹æœº",width:10,height:21.7,type:"mobile",ratio:"21.7:10"},{id:"tablet",name:"å¹³æ¿",width:10,height:14.3,type:"tablet",ratio:"10:14.3"}],mt={async deleteItem(o){const i=await fetch("/api/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})});if(!i.ok){const n=await i.json();throw new Error(n.error||"åˆ é™¤å¤±è´¥")}return i.json()},async unsetReference(o){const i=await fetch("/api/unset-reference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})});if(!i.ok){const n=await i.json();throw new Error(n.error||"å–æ¶ˆå‚è€ƒå¤±è´¥")}return i.json()},async getWsClients(){const o=await fetch("/api/ws/clients");return o.ok?(await o.json()).clients||[]:[]},async sendWsMessage(o){const i=await fetch("/api/ws/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!i.ok){const n=await i.text();throw new Error(n||"å‘é€å¤±è´¥")}return i.json()},async fetchCode(o){const i=await fetch(o);if(!i.ok)throw new Error(`è·å–æ„å»ºä»£ç å¤±è´¥ï¼Œè¯·è®© AI ä¿®å¤: ${i.statusText}`);return i.text()},async fetchHackCss(o,i){const n=`${window.location.origin}/${o}/${i}/hack.css`;try{const g=await fetch(n);if(g.ok)return await g.text()}catch(g){console.warn("fetch hack.css failed",g)}return""},async fetchSpecMd(o,i){const n=`${window.location.origin}/${o}/${i}/spec.md`;try{const g=await fetch(n);if(g.ok)return await g.text()}catch(g){console.warn("Error fetching spec.md",g)}return""},async reviewCode(o){const i=await fetch("/api/code-review",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})});if(!i.ok){const n=await i.json();throw new Error(n.error||"ä»£ç æ£€æŸ¥å¤±è´¥")}return i.json()}},{TextArea:cn}=Se,{Text:Ae}=Oe,dn=({open:o,onClose:i,imageConfig:n,setImageConfig:g,onDimensionChange:p,onSwapDimensions:D,onDimensionBlur:P,isExporting:k,onExport:l,onCopyConfig:E,activeTab:c,itemName:A})=>{const J=c==="elements"?"å…ƒç´ ":"é¡µé¢",[N,Z]=r.useState(null),[X,z]=r.useState(!1),[_,G]=r.useState(!1),[d,F]=M.useMessage(),[W,ee]=r.useState("export"),[te,K]=r.useState(""),[R,q]=r.useState(""),[se,O]=r.useState(!1);r.useEffect(()=>{(async()=>{if(R&&W==="copyConfig"){O(!0);try{if(!await V()){q(""),K(""),O(!1);return}const $=await E(R);K($)}catch{d.error("åŠ è½½é…ç½®å¤±è´¥"),K("")}finally{O(!1)}}})()},[R,W,E,d]),r.useEffect(()=>{o||(ee("export"),q(""),K(""))},[o]);const V=async()=>{if(!A)return!0;G(!0);try{const u=`${c}/${A}`,f=await mt.reviewCode(u);return f.passed?!0:(Z(f),z(!0),!1)}catch(u){return console.error("ä»£ç æ£€æŸ¥å¤±è´¥:",u),!0}finally{G(!1)}},w=async()=>{await V()&&l()},x=async()=>{if(!te){d.warning("è¯·å…ˆé€‰æ‹©å¯¼å‡ºå†…å®¹");return}try{await navigator.clipboard.writeText(te),d.success("é…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{d.error("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å‰ªè´´æ¿æƒé™")}},h=u=>{u.target.select()},L=async()=>{if(!N)return;const u=N.issues.filter(y=>y.type==="error"),f=N.issues.filter(y=>y.type==="warning");let $=`ä»£ç æ£€æŸ¥æœªé€šè¿‡ï¼Œè¯·å¸®æˆ‘ä¿®å¤ä»¥ä¸‹é—®é¢˜ï¼š

`;$+=`æ–‡ä»¶ï¼š${N.file}

`,u.length>0&&($+=`âŒ é”™è¯¯ (${u.length} ä¸ª):
`,u.forEach((y,B)=>{$+=`
${B+1}. [${y.rule}] ${y.message}
`,y.suggestion&&($+=`   å»ºè®®: ${y.suggestion}
`)})),f.length>0&&($+=`
âš ï¸ è­¦å‘Š (${f.length} ä¸ª):
`,f.forEach((y,B)=>{$+=`
${B+1}. [${y.rule}] ${y.message}
`,y.suggestion&&($+=`   å»ºè®®: ${y.suggestion}
`)}));try{await navigator.clipboard.writeText($),d.success("å¤åˆ¶æˆåŠŸ"),z(!1)}catch{d.error("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å‰ªè´´æ¿æƒé™")}};return e.jsxs(e.Fragment,{children:[F,e.jsx(Pe,{title:"å¯¼å‡ºåˆ° Axure",open:o,onCancel:i,footer:W==="export"?[e.jsx(U,{type:"primary",loading:k||_,onClick:w,children:"å¯¼å‡º"},"export")]:[e.jsx(U,{type:"primary",disabled:!te,onClick:x,children:"å¤åˆ¶é…ç½®"},"copy")],width:800,children:e.jsx(gt,{activeKey:W,onChange:ee,items:[{key:"export",label:"å¯¼å‡ºå›¾ç‰‡",children:e.jsxs("div",{style:{display:"flex",gap:"20px",height:"400px"},children:[e.jsx("div",{style:{flex:1,border:"1px solid #f0f0f0",borderRadius:"8px",overflow:"hidden",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:n.previewUrl?e.jsx("img",{src:n.previewUrl,alt:"Preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}}):e.jsx(Ne,{tip:"æ­£åœ¨ç”Ÿæˆé¢„è§ˆ..."})}),e.jsxs("div",{style:{width:"240px",display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"8px",fontWeight:500,display:"flex",alignItems:"center",gap:"4px"},children:["å¯¼å‡ºå°ºå¯¸",e.jsx(ae,{title:"è¿”å› Axure åŒå‡»å…ƒç´ å°±å¯ä»¥æ›¿æ¢å›¾ç‰‡ï¼ŒåŒå‡»å›¾ç‰‡å·¦ä¸Šè§’æˆ–è€…åœ¨æ ·å¼é¢æ¿é‡Œç‚¹å‡»è‡ªé€‚åº”å›¾ç‰‡å³å¯æ›´æ–°å›¾ç‰‡å°ºå¯¸",children:e.jsx(He,{style:{color:"#999",cursor:"help"}})})]}),e.jsxs(ge,{children:[e.jsx(vt,{value:n.width,onChange:u=>p("width",u),onBlur:P,placeholder:"å®½",style:{width:100},min:1}),e.jsx($s,{onClick:D,style:{color:"#999",cursor:"pointer",fontSize:14}}),e.jsx(vt,{value:n.height,onChange:u=>p("height",u),onBlur:P,placeholder:"é«˜",style:{width:100},min:1})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"8px",fontWeight:500,display:"flex",alignItems:"center",gap:"4px"},children:["å›¾ç‰‡å†…å®¹",e.jsx(ae,{title:"æ ‡é¢˜å°é¢ä¾¿äºåœ¨ Axure å†…æ›´æ”¹å°ºå¯¸",children:e.jsx(He,{style:{color:"#999",cursor:"help"}})})]}),e.jsx(rt.Group,{value:n.contentType,onChange:u=>g(f=>({...f,contentType:u.target.value})),children:e.jsxs(ge,{direction:"vertical",children:[e.jsxs(rt,{value:"title",children:[J,"æ ‡é¢˜"]}),e.jsxs(rt,{value:"screenshot",children:[J,"æˆªå›¾"]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"8px",fontWeight:500,display:"flex",alignItems:"center",gap:"4px"},children:["åŒ…å«é…ç½®",e.jsx(ae,{title:"è‹¥åŒ…å«é…ç½®ï¼Œä»…éœ€å¯¼å…¥å›¾ç‰‡åˆ° Axureï¼Œä¸€èˆ¬ä¸éœ€è¦å†å¤åˆ¶é…ç½®æˆ–è€…ä»£ç ",children:e.jsx(He,{style:{color:"#999",cursor:"help"}})})]}),e.jsx(me,{value:n.includeConfig,onChange:u=>g(f=>({...f,includeConfig:u})),style:{width:"100%"},options:[{label:"æ— ",value:"none"},{label:"åŸå‹",value:"code"},{label:"åŸå‹ + æ–‡æ¡£",value:"codeAndDocs"},{label:"åŸå‹ + æ–‡æ¡£ + ä»£ç ",value:"codeAndDocsAndSource"}]})]})]})]})},{key:"copyConfig",label:"å¤åˆ¶é…ç½®",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px",height:"400px"},children:[e.jsx(St,{message:"å¯¼å‡ºæœ¬åœ° html æˆ–è€…å‘å¸ƒåˆ° Axure Cloud æ—¶è‹¥å›¾ç‰‡å¤±æ•ˆå¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½",type:"info",showIcon:!0}),e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"8px",fontWeight:500},children:"å¯¼å‡ºå†…å®¹"}),e.jsx(me,{value:R||void 0,onChange:q,placeholder:"è¯·é€‰æ‹©å¯¼å‡ºå†…å®¹",style:{width:"100%"},options:[{label:"è¯·é€‰æ‹©å¯¼å‡ºå†…å®¹",value:"",disabled:!0},{label:"åŸå‹",value:"code"},{label:"åŸå‹ + æ–‡æ¡£",value:"codeAndDocs"},{label:"åŸå‹ + æ–‡æ¡£ + ä»£ç ",value:"codeAndDocsAndSource"}]})]}),R&&e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{marginBottom:"8px",fontWeight:500},children:"é…ç½®å†…å®¹"}),se?e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #d9d9d9",borderRadius:"6px"},children:e.jsx(Ne,{tip:"æ­£åœ¨åŠ è½½é…ç½®..."})}):e.jsx(cn,{value:te,readOnly:!0,onFocus:h,style:{flex:1,fontFamily:"monospace",fontSize:"12px"},placeholder:"é…ç½®å†…å®¹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ"})]})]})}]})}),e.jsx(Pe,{title:"ä»£ç æ£€æŸ¥æœªé€šè¿‡",open:X,onCancel:()=>z(!1),width:600,footer:[e.jsx(U,{onClick:()=>z(!1),children:"å–æ¶ˆ"},"cancel"),e.jsx(U,{type:"primary",icon:e.jsx(Ve,{}),onClick:L,children:"å¤åˆ¶ç»™ AI ä¿®å¤"},"copy")],children:N&&e.jsxs("div",{style:{maxHeight:"500px",overflowY:"auto"},children:[e.jsx(St,{description:"ä»£ç ä¸ç¬¦åˆå¼€å‘è§„èŒƒï¼Œéœ€è¦ä¿®å¤åæ‰èƒ½å¯¼å‡º",type:"error",showIcon:!0,style:{marginBottom:"24px"}}),N.issues.filter(u=>u.type==="error").length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx(Ct,{orientation:"left",style:{margin:"0 0 16px 0",fontSize:"14px"},children:e.jsx(Ae,{type:"danger",children:"é”™è¯¯ (å¿…é¡»ä¿®å¤)"})}),e.jsx(Re,{size:"small",dataSource:N.issues.filter(u=>u.type==="error"),renderItem:u=>e.jsx(Re.Item,{style:{padding:"12px 0",borderBottom:"1px solid #f0f0f0"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{marginBottom:"4px"},children:[e.jsxs(Ae,{strong:!0,children:["[",u.rule,"]"]})," ",e.jsx(Ae,{children:u.message})]}),u.suggestion&&e.jsxs("div",{style:{fontSize:"13px",color:"#8c8c8c",background:"#fafafa",padding:"8px",borderRadius:"4px"},children:["å»ºè®®: ",u.suggestion]})]})})})]}),N.issues.filter(u=>u.type==="warning").length>0&&e.jsxs("div",{children:[e.jsx(Ct,{orientation:"left",style:{margin:"0 0 16px 0",fontSize:"14px"},children:e.jsx(Ae,{type:"warning",children:"è­¦å‘Š (å»ºè®®ä¿®å¤)"})}),e.jsx(Re,{size:"small",dataSource:N.issues.filter(u=>u.type==="warning"),renderItem:u=>e.jsx(Re.Item,{style:{padding:"12px 0",borderBottom:"1px solid #f0f0f0"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{marginBottom:"4px"},children:[e.jsxs(Ae,{strong:!0,children:["[",u.rule,"]"]})," ",e.jsx(Ae,{children:u.message})]}),u.suggestion&&e.jsxs("div",{style:{fontSize:"13px",color:"#8c8c8c",background:"#fafafa",padding:"8px",borderRadius:"4px"},children:["å»ºè®®: ",u.suggestion]})]})})})]})]})})]})},{Text:it}=Oe,{useToken:hn}=Le;function pn({visible:o,onCancel:i,item:n,activeTab:g}){const{token:p}=hn(),[D,P]=r.useState([]),[k,l]=r.useState(!1),[E,c]=r.useState(""),[A,J]=r.useState(""),[N,Z]=r.useState(!1),[X,z]=r.useState(!1),[_,G]=r.useState(null),[d,F]=r.useState(null),W=w=>{const x=w;let h="";if(x.filePath){const L=x.filePath.indexOf("src/");h=L>=0?x.filePath.substring(L):x.filePath}else h=`${g==="pages"?"src/pages":"src/elements"}/${w.name}`;return h=h.replace(/\/index\.(t|j)sx?$/i,""),h=h.replace(/^\/+/,""),h.startsWith("src/")&&(h=h.substring(4)),h},ee=w=>{const x=new Date(w),h=L=>String(L).padStart(2,"0");return`${x.getFullYear()}/${h(x.getMonth()+1)}/${h(x.getDate())} ${h(x.getHours())}:${h(x.getMinutes())}:${h(x.getSeconds())}`},te=w=>{const x=Math.floor((Date.now()-w)/1e3);let h=x/31536e3;return h>1?Math.floor(h)+" å¹´å‰":(h=x/2592e3,h>1?Math.floor(h)+" ä¸ªæœˆå‰":(h=x/86400,h>1?Math.floor(h)+" å¤©å‰":(h=x/3600,h>1?Math.floor(h)+" å°æ—¶å‰":(h=x/60,h>1?Math.floor(h)+" åˆ†é’Ÿå‰":"åˆšåˆš"))))},K=async()=>{if(n){z(!0);try{const w=W(n);if(!w){M.error("æ— æ³•è·å–æ–‡ä»¶è·¯å¾„"),z(!1);return}const x=await fetch(`/api/git/history?path=${encodeURIComponent(w)}`),h=await x.json();x.ok?(P(h.commits),l(h.hasUncommitted),c(h.uncommittedFiles)):M.error(h.error||"åŠ è½½ç‰ˆæœ¬å†å²å¤±è´¥")}catch{M.error("åŠ è½½ç‰ˆæœ¬å†å²å¤±è´¥")}finally{z(!1)}}};r.useEffect(()=>{o&&n&&K()},[o,n]);const R=async w=>{if(n)try{const x=W(n),h=await fetch("/api/git/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:x,commitHash:w})}),L=await h.json();h.ok?(M.success("ç‰ˆæœ¬æ¢å¤æˆåŠŸ"),K()):M.error(L.error||"ç‰ˆæœ¬æ¢å¤å¤±è´¥")}catch{M.error("ç‰ˆæœ¬æ¢å¤å¤±è´¥")}},q=async()=>{if(!n||!A.trim()){M.warning("è¯·è¾“å…¥æäº¤ä¿¡æ¯");return}Z(!0);try{const w=W(n),x=await fetch("/api/git/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:w,message:A})}),h=await x.json();x.ok?(M.success("æäº¤æˆåŠŸ"),J(""),K()):M.error(h.error||"æäº¤å¤±è´¥")}catch{M.error("æäº¤å¤±è´¥")}finally{Z(!1)}},se=async()=>{if(n)try{const w=W(n),x=`æˆ‘éœ€è¦æäº¤ä»¥ä¸‹ç›®å½•çš„æ›´æ”¹ï¼Œè¯·å¸®æˆ‘å¤„ç†ï¼š

ç›®æ ‡è·¯å¾„: src/${w}

è¯·æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
1. ä½¿ç”¨ git status å’Œ git diff æŸ¥çœ‹è¯¥è·¯å¾„ä¸‹çš„å˜æ›´å†…å®¹ã€‚
2. åˆ†æå˜æ›´ï¼Œç”Ÿæˆä¸€ä¸ªç®€æ´æ˜äº†çš„ä¸­æ–‡æäº¤ä¿¡æ¯ï¼ˆCommit Messageï¼‰ã€‚
3. å‘æˆ‘å±•ç¤ºå˜æ›´æ‘˜è¦å’Œå»ºè®®çš„æäº¤ä¿¡æ¯ï¼Œå¹¶è¯¢é—®æ˜¯å¦ç»§ç»­ã€‚
4. è·å¾—ç¡®è®¤åï¼Œæ‰§è¡Œï¼š
   git add src/${w}
   git commit -m "ä½ çš„æäº¤ä¿¡æ¯"

è¯·ç›´æ¥å¼€å§‹æ‰§è¡Œç¬¬ 1 æ­¥ã€‚`;await navigator.clipboard.writeText(x),M.success("AI æŒ‡ä»¤å·²å¤åˆ¶ï¼Œè¯·ç²˜è´´ç»™åŠ©æ‰‹")}catch{M.error("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶")}},O=async w=>{if(n){G(w);try{const x=W(n),h=await fetch("/api/git/build-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:x,commitHash:w})}),L=await h.json();h.ok&&L.hasSpec&&L.specUrl?window.open(L.specUrl,"_blank"):L.hasSpec?M.error(L.error||"æ— æ³•è®¿é—®è§„æ ¼æ–‡æ¡£"):M.warning("è¯¥ç‰ˆæœ¬æ²¡æœ‰è§„æ ¼æ–‡æ¡£")}catch{M.error("åŠ è½½è§„æ ¼æ–‡æ¡£å¤±è´¥")}finally{G(null)}}},V=async w=>{if(n){F(w);try{const x=W(n),h=await fetch("/api/git/build-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:x,commitHash:w})}),L=await h.json();h.ok&&L.hasPrototype&&L.prototypeUrl?window.open(L.prototypeUrl,"_blank"):L.hasPrototype?M.error(L.error||"æ— æ³•è®¿é—®åŸå‹"):M.warning("è¯¥ç‰ˆæœ¬æ²¡æœ‰åŸå‹æ–‡ä»¶")}catch{M.error("åŠ è½½åŸå‹å¤±è´¥")}finally{F(null)}}};return e.jsx(Pe,{title:`ç‰ˆæœ¬ç®¡ç† - ${n==null?void 0:n.displayName}`,open:o,onCancel:i,footer:null,width:700,centered:!0,className:"version-dialog",styles:{body:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",paddingTop:12,paddingBottom:12}},destroyOnClose:!0,children:e.jsx(Ne,{spinning:X,children:D.length===0&&!k?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:"æš‚æ— ç‰ˆæœ¬å†å²"}):e.jsx(ks,{mode:"left",items:[...k?[{children:e.jsx("div",{className:"commit-item uncommitted",style:{paddingBottom:20},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(it,{strong:!0,style:{fontSize:14,marginRight:8},children:"æœªæäº¤çš„æ›´æ”¹"}),e.jsx($t,{color:"warning",children:"æœªä¿å­˜"})]})}),e.jsxs("div",{style:{background:p.colorFillAlter,padding:12,borderRadius:8,border:`1px solid ${p.colorBorderSecondary}`},children:[e.jsx(Se,{placeholder:"æ‰‹åŠ¨è¾“å…¥æäº¤ä¿¡æ¯...",value:A,onChange:w=>J(w.target.value),onPressEnter:q,style:{marginBottom:12}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:12,color:p.colorTextSecondary},children:E?`${E.split(`
`).filter(Boolean).length} ä¸ªæ–‡ä»¶å˜æ›´`:"æœ‰æ–‡ä»¶å˜æ›´"}),e.jsxs(ge,{children:[e.jsx(U,{size:"small",icon:e.jsx(Ot,{}),onClick:se,style:{color:p.colorPrimary,borderColor:p.colorPrimary},children:"AI æäº¤"}),e.jsx(U,{type:"primary",size:"small",onClick:q,loading:N,disabled:!A.trim(),children:"æäº¤"})]})]})]})]})}),color:"orange",dot:e.jsx("div",{style:{width:10,height:10,background:p.colorWarning,borderRadius:"50%",border:`2px solid ${p.colorBgContainer}`}})}]:[],...D.map((w,x)=>{const h=x===0&&!k;return{children:e.jsx("div",{className:"commit-item",style:{paddingBottom:20},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{marginBottom:4,display:"flex",alignItems:"center"},children:[e.jsx(it,{strong:!0,style:{fontSize:14,marginRight:8},children:w.message}),h&&e.jsx($t,{color:"success",children:"å½“å‰ç‰ˆæœ¬"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:p.colorTextSecondary},children:[e.jsxs(ge,{size:4,children:[e.jsx(Is,{size:20,style:{backgroundColor:p.colorPrimary,fontSize:12},children:w.author?w.author[0].toUpperCase():"U"}),e.jsx("span",{children:w.author})]}),e.jsx("span",{style:{color:p.colorBorder},children:"|"}),e.jsx(ae,{title:ee(w.timestamp),children:e.jsx("span",{style:{cursor:"help"},children:te(w.timestamp)})}),e.jsx("span",{style:{color:p.colorBorder},children:"|"}),e.jsx(it,{code:!0,style:{fontSize:12,margin:0},children:w.hash.substring(0,7)})]})]}),!h&&e.jsxs(ge,{size:0,children:[e.jsx(ae,{title:"æŸ¥çœ‹è§„æ ¼æ–‡æ¡£",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(Ee,{}),style:{color:p.colorTextSecondary},onClick:()=>O(w.hash),loading:_===w.hash})}),e.jsx(ae,{title:"æŸ¥çœ‹åŸå‹",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(Lt,{}),style:{color:p.colorTextSecondary},onClick:()=>V(w.hash),loading:d===w.hash})}),e.jsx(Ts,{title:"ç¡®è®¤æ¢å¤",description:"ç¡®å®šè¦æ¢å¤åˆ°æ­¤ç‰ˆæœ¬å—ï¼Ÿå½“å‰æœªæäº¤çš„æ›´æ”¹å°†ä¼šä¸¢å¤±ã€‚",onConfirm:()=>R(w.hash),okText:"ç¡®è®¤",cancelText:"å–æ¶ˆ",children:e.jsx(ae,{title:"æ¢å¤æ­¤ç‰ˆæœ¬",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(As,{}),style:{color:p.colorTextSecondary}})})})]}),h&&e.jsx(ge,{size:0})]})}),color:h?"green":"gray",dot:h?e.jsx("div",{style:{width:10,height:10,background:p.colorSuccess,borderRadius:"50%",border:`2px solid ${p.colorBgContainer}`}}):void 0}})]})})})}const{Sider:un}=ze,{useToken:fn}=Le;function mn({collapsed:o,loading:i,activeTab:n,handleTabChange:g,data:p,searchText:D,setSearchText:P,filteredItems:k,selectedItem:l,handleMenuClick:E,handleDownloadItemSource:c,handleRenameItem:A,handleSetReference:J,handleUnsetReference:N,handleDuplicateItem:Z,handleDeleteItem:X,handleCopyItemPath:z,setCreateDialogVisible:_}){const{token:G}=fn(),[d,F]=r.useState(!1),[W,ee]=r.useState(null),te=R=>{ee(R),F(!0)},K=r.useMemo(()=>k.map(R=>{const q=l&&l.name===R.name,se=[{key:"rename",label:"é‡å‘½å",icon:e.jsx(Ut,{})},{key:"duplicate",label:"åˆ›å»ºå‰¯æœ¬",icon:e.jsx(Ve,{})},{key:"copy-path",label:"å¤åˆ¶è·¯å¾„",icon:e.jsx(Rs,{})},{type:"divider"},{key:"version-management",label:"ç‰ˆæœ¬ç®¡ç†",icon:e.jsx(Ps,{})},{key:"download-source",label:"å¯¼å‡º ZIP",icon:e.jsx(_e,{})},{type:"divider"},...R.isReference?[{key:"unset-reference",label:"å–æ¶ˆå‚è€ƒ",icon:e.jsx(lt,{})}]:[{key:"set-reference",label:"è®¾ç½®ä¸ºå‚è€ƒ",icon:e.jsx(lt,{})}],{key:"delete",label:`åˆ é™¤${n==="elements"?"å…ƒç´ ":"é¡µé¢"}`,icon:e.jsx(Es,{}),danger:!0,disabled:R.isReference}];return{key:R.name,label:e.jsxs("div",{className:`menu-item-wrapper ${q?"is-selected":""}`,style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:6,overflow:"hidden",flex:1},children:e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R.displayName})}),e.jsx(dt,{trigger:["click"],menu:{items:se,onClick:({key:O})=>{O==="download-source"?c(R):O==="rename"?A(R):O==="duplicate"?Z(R):O==="copy-path"?z(R):O==="version-management"?te(R):O==="set-reference"?J(R):O==="unset-reference"?N(R):O==="delete"&&X(R)}},children:e.jsx(U,{type:"text",size:"small",className:"more-btn",icon:e.jsx(Ds,{}),onClick:O=>{O.stopPropagation()}})})]}),icon:n==="elements"?e.jsx(ct,{}):e.jsx(Ee,{})}}),[k,n,l,c,A,J,N,X,z,Z]);return e.jsxs(un,{trigger:null,collapsible:!0,collapsed:o,width:240,collapsedWidth:0,style:{background:G.colorBgContainer,borderRight:`1px solid ${G.colorBorder}`,overflow:"hidden",height:"calc(100vh - 48px)",position:"sticky",top:48},children:[e.jsxs("div",{style:{height:"100%",position:"relative"},children:[e.jsxs("div",{style:{height:"100%",overflowY:"auto"},children:[e.jsx("div",{style:{padding:"8px"},children:!o&&e.jsxs(e.Fragment,{children:[e.jsx(gt,{activeKey:n,size:"small",centered:!0,onChange:R=>g(R),items:[{key:"pages",label:`é¡µé¢ (${p.pages.length})`,icon:e.jsx(Ee,{})},{key:"elements",label:`å…ƒç´  (${p.elements.length})`,icon:e.jsx(ct,{})}]}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:8},children:e.jsx(Se,{placeholder:"æœç´¢...",prefix:e.jsx(Mt,{}),value:D,onChange:R=>P(R.target.value),allowClear:!0,style:{flex:1}})})]})}),i?e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(Ne,{tip:"åŠ è½½ä¸­..."})}):e.jsxs(e.Fragment,{children:[e.jsx(Ns,{mode:"inline",selectedKeys:l?[l.name]:[],items:K,onClick:E,style:{borderRight:0}}),e.jsx("div",{style:{height:80}})]})]}),!o&&e.jsx(zs,{icon:e.jsx(Os,{}),type:"primary",style:{position:"absolute",left:24,bottom:24},onClick:()=>_(!0),tooltip:n==="elements"?"æ–°å»ºå…ƒç´ ":"æ–°å»ºé¡µé¢"})]}),e.jsx(pn,{visible:d,onCancel:()=>F(!1),item:W,activeTab:n})]})}const{Text:gn,Paragraph:xn}=Oe,yn=[{name:"Axhub",description:"è¿æ¥ Axure åŸå‹æ•°æ®ï¼Œå…è®¸ AI ç›´æ¥è¯»å–å’Œæ“ä½œåŸå‹èµ„äº§ã€‚",type:"Streamable HTTP",url:"http://127.0.0.1:12308/mcp"},{name:"DeepWiki",description:"ä¸ºAI åº”ç”¨æä¾›è®¿é—®å’Œæœç´¢ GitHub ä»£ç åº“",type:"SSE",url:"https://mcp.deepwiki.com/sse"},{name:"Chrome DevTools",description:"å…è®¸ AI åŠ©æ‰‹æ§åˆ¶å’Œæ£€æŸ¥ Chrome æµè§ˆå™¨ï¼Œæ”¯æŒè‡ªåŠ¨åŒ–æµ‹è¯•å’Œé¡µé¢åˆ†æã€‚",type:"Command",command:"npx -y chrome-devtools-mcp@latest"},{name:"Playwright",description:"é€šè¿‡ Playwright æä¾›æµè§ˆå™¨è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œæ”¯æŒç½‘é¡µæˆªå›¾ã€äº¤äº’å’Œçˆ¬å–ã€‚",type:"Command",command:"npx @playwright/mcp@latest"},{name:"æ›´å¤š MCP",description:"æ›´å¤šæ¨èç”¨äºåŸå‹çš„ MCP å¯ä»¥å‚è€ƒç¤¾ç¾¤å¸®åŠ©æ–‡æ¡£ã€‚",type:"Info",url:""}],wn=[{label:"Trae (å›½å†…ç‰ˆ)",value:"trae"},{label:"Trae (å›½é™…ç‰ˆ)",value:"trae-global"},{label:"Cursor",value:"cursor"},{label:"Windsurf",value:"windsurf"}],jn=({open:o,onClose:i})=>{const[n,g]=r.useState("trae-global"),[p,D]=r.useState(!1),[P,k]=M.useMessage(),l=async()=>{if(!n){P.warning("è¯·é€‰æ‹©è¦å®‰è£…çš„å®¢æˆ·ç«¯");return}D(!0);try{const E=await fetch("/api/install-mcp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client:n,override:!0})}),c=await E.json();if(E.ok&&c.success)P.success({content:"å®‰è£…æˆåŠŸï¼è¯·é‡å¯æˆ–åˆ·æ–°æ‚¨çš„å®¢æˆ·ç«¯ä»¥ç”Ÿæ•ˆã€‚",duration:5});else throw new Error(c.error||"å®‰è£…å¤±è´¥")}catch(E){console.error("MCP Install Error:",E),P.error(`å®‰è£…å¤±è´¥: ${E.message}`)}finally{D(!1)}};return e.jsxs(Pe,{title:e.jsxs(ge,{children:[e.jsx(Ft,{}),e.jsx("span",{children:"MCP å®‰è£…"})]}),open:o,onCancel:i,footer:[e.jsx(U,{onClick:i,children:"å–æ¶ˆ"},"close"),e.jsx(U,{type:"primary",icon:e.jsx(Ls,{}),loading:p,onClick:l,children:"å®‰è£…åˆ°æ‰€é€‰å®¢æˆ·ç«¯"},"install")],width:720,children:[k,e.jsxs("div",{style:{marginBottom:16,marginTop:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[e.jsx("span",{children:"å®¢æˆ·ç«¯"}),e.jsx(me,{style:{width:240},placeholder:"é€‰æ‹© AI å®¢æˆ·ç«¯",options:wn,value:n,onChange:g})]}),e.jsx(gn,{type:"secondary",style:{fontSize:"12px"},children:"æç¤ºï¼šå®‰è£…å°†æ›´æ–°å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨å°†åˆå¹¶é…ç½®ã€‚"})]}),e.jsx(Re,{grid:{gutter:16,column:2},dataSource:yn,renderItem:E=>e.jsx(Re.Item,{children:e.jsx(ht,{size:"small",title:e.jsx(ge,{size:4,children:E.name}),style:{height:"100%"},bodyStyle:{padding:"12px"},children:e.jsx(xn,{type:"secondary",style:{fontSize:"13px",marginBottom:0,height:"40px",lineHeight:"20px"},ellipsis:{rows:2},children:E.description})})}),style:{marginBottom:0}})]})};function bn({open:o,onClose:i}){const[n]=re.useForm(),[g,p]=r.useState(!1);r.useEffect(()=>{o&&D()},[o]);const D=async()=>{try{const k=await fetch("/api/config");if(!k.ok)throw new Error("Failed to load config");const l=await k.json();n.setFieldsValue({host:l.server.host||"localhost",allowLAN:l.server.allowLAN!==!1,enableCommandAPI:l.server.enableCommandAPI||!1})}catch(k){console.error("Error loading config:",k),M.error("åŠ è½½é…ç½®å¤±è´¥")}},P=async()=>{try{const k=await n.validateFields();p(!0);const l=await fetch("/api/config"),E=l.ok?await l.json():{server:{host:"localhost",port:51720,allowLAN:!0}},c={server:{host:k.host,port:E.server.port||51720,allowLAN:k.allowLAN,enableCommandAPI:k.enableCommandAPI||!1}},A=await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!A.ok){const N=await A.json();throw new Error(N.error||"Failed to save config")}const J=await A.json();M.success(J.message||"é…ç½®å·²ä¿å­˜"),i()}catch(k){console.error("Error saving config:",k),M.error(k.message||"ä¿å­˜é…ç½®å¤±è´¥")}finally{p(!1)}};return e.jsx(Pe,{title:"é¡¹ç›®è®¾ç½®",open:o,onOk:P,onCancel:i,confirmLoading:g,okText:"ä¿å­˜",cancelText:"å–æ¶ˆ",width:500,children:e.jsxs(re,{form:n,layout:"vertical",initialValues:{host:"localhost",allowLAN:!0,enableCommandAPI:!1},children:[e.jsx(re.Item,{label:"ä¸»æœºåœ°å€",name:"host",rules:[{required:!0,message:"è¯·è¾“å…¥ä¸»æœºåœ°å€"}],tooltip:"æœåŠ¡å™¨å¯åŠ¨çš„åŸŸåæˆ– IP åœ°å€",children:e.jsx(Se,{placeholder:"localhost"})}),e.jsx(re.Item,{label:"å…è®¸å±€åŸŸç½‘è®¿é—®",name:"allowLAN",valuePropName:"checked",tooltip:"å¼€å¯åï¼Œå±€åŸŸç½‘å†…çš„å…¶ä»–è®¾å¤‡å¯ä»¥è®¿é—®æ­¤æœåŠ¡å™¨ã€‚æ³¨æ„ï¼šå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œè¯·ç¡®ä¿åœ¨å¯ä¿¡ç½‘ç»œç¯å¢ƒä¸­ä½¿ç”¨",children:e.jsx(pt,{})}),e.jsx(re.Item,{label:"å¯ç”¨å‘½ä»¤ API",name:"enableCommandAPI",valuePropName:"checked",tooltip:"å¼€å¯åï¼Œå…è®¸é€šè¿‡ API æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚è­¦å‘Šï¼šå­˜åœ¨ä¸¥é‡å®‰å…¨é£é™©ï¼Œä»…åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨",children:e.jsx(pt,{})})]})})}const{Header:vn}=ze,{useToken:Sn}=Le,Cn=o=>e.jsx("span",{role:"img","aria-label":"figma",className:"anticon anticon-figma",...o,children:e.jsxs("svg",{fill:"currentColor",fillRule:"evenodd",height:"1em",width:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",style:{verticalAlign:"middle"},children:[e.jsx("title",{children:"Figma"}),e.jsx("path",{clipRule:"evenodd",d:"M6.082 8.241C4.83 7.441 4 6.057 4 4.483 4 2.007 6.05 0 8.578 0h7.844C18.95 0 21 2.007 21 4.483c0 1.574-.829 2.959-2.082 3.758C20.17 9.041 21 10.426 21 12c0 2.476-2.05 4.483-4.578 4.483h-.084A4.615 4.615 0 0113.24 15.3v4.176C13.24 21.98 11.145 24 8.599 24 6.076 24 4 21.998 4 19.517c0-1.574.829-2.959 2.082-3.758C4.829 14.959 4 13.574 4 12c0-1.574.829-2.959 2.082-3.759zM13.24 12c0 1.676 1.387 3.034 3.098 3.034h.084c1.711 0 3.099-1.358 3.099-3.034 0-1.676-1.388-3.034-3.1-3.034h-.083c-1.71 0-3.098 1.358-3.098 3.034zm-1.48-3.034H8.578C6.867 8.966 5.48 10.324 5.48 12c0 1.672 1.382 3.029 3.089 3.034H11.76V8.966zm-3.182 7.517h-.01c-1.707.005-3.089 1.362-3.089 3.034 0 1.67 1.403 3.034 3.12 3.034 1.74 0 3.161-1.381 3.161-3.075v-2.993H8.578zm3.182-8.966H8.578c-1.711 0-3.099-1.358-3.099-3.034 0-1.676 1.388-3.034 3.1-3.034h3.181v6.068zm4.662 0H13.24V1.45h3.182c1.711 0 3.099 1.358 3.099 3.034 0 1.676-1.388 3.034-3.1 3.034z"})]})});function $n({collapsed:o,setCollapsed:i,selectedItem:n,viewMode:g,setViewMode:p,activeTab:D,selectedDeviceId:P,setSelectedDeviceId:k,deviceSegmentOptions:l,handleOpenInspect:E,handleRefreshElement:c,handleCopyLocalLink:A,handleCopyLANLink:J,handleDownloadZip:N,getLANUrl:Z,qrCodeVisible:X,setQrCodeVisible:z,wsClients:_,checkConnection:G,handlePushToFigma:d,handleDownloadFigmaJson:F,setIsExportModalOpen:W,handleOpenIdeFile:ee,isDarkMode:te,setIsDarkMode:K,currentSpecDocKey:R="spec"}){const[q,se]=je.useState(null),[O,V]=je.useState(!1),[w,x]=je.useState(!1),[h,L]=je.useState(!0),{token:u}=Sn();return je.useEffect(()=>{let f=!1;return fetch("/api/version").then($=>$.ok?$.json():Promise.reject(new Error("Request failed"))).then($=>{if(f)return;const y=typeof($==null?void 0:$.version)=="string"?$.version:null;se(y)}).catch(()=>{f||se(null)}),()=>{f=!0}},[]),je.useEffect(()=>{let f=!1;return fetch("/api/config").then($=>$.ok?$.json():Promise.reject(new Error("Request failed"))).then($=>{var y;f||L(((y=$==null?void 0:$.server)==null?void 0:y.allowLAN)!==!1)}).catch(()=>{f||L(!0)}),()=>{f=!0}},[]),e.jsxs(vn,{hasSider:!0,style:{height:"48px",display:"flex",alignItems:"center",justifyContent:"space-between",background:u.colorBgContainer,padding:"0 16px",position:"sticky",top:0,zIndex:1e3,boxShadow:`0 2px 8px ${u.colorBorderSecondary}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",width:224},children:[e.jsx(U,{type:"text",icon:o?e.jsx(Us,{}):e.jsx(Ms,{}),onClick:()=>i(!o),style:{fontSize:"16px",height:40}}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:e.jsxs("span",{style:{fontSize:"18px",fontWeight:600,color:u.colorText},children:["Axhub ",e.jsx("span",{style:{color:"#008F5D"},children:"Make"})]})})]}),e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center"},children:e.jsx(ut,{value:g,size:"small",style:{fontSize:"12px"},onChange:f=>p(f),options:[{label:"åŸå‹",value:"demo",icon:e.jsx(Lt,{})},{label:"æ–‡æ¡£",value:"spec",icon:e.jsx(lt,{})}]})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ae,{title:te?"åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼":"åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼",children:e.jsx(U,{type:"text",icon:te?e.jsx(Bt,{}):e.jsx(Wt,{}),onClick:()=>K(!te)})}),e.jsx(dt,{menu:{items:[{key:"assets",label:"èµ„äº§ç®¡ç†",icon:e.jsx(Ee,{}),onClick:()=>window.open(new URL("/assets.html",window.location.origin).toString(),"_blank")},{key:"mcp",label:"MCP ç®¡ç†",icon:e.jsx(Ft,{}),onClick:()=>V(!0)},{key:"settings",label:"é¡¹ç›®è®¾ç½®",icon:e.jsx(kt,{}),onClick:()=>x(!0)},{type:"divider"},{key:"help",label:"å¸®åŠ©ä¸­å¿ƒ",icon:e.jsx(Bs,{}),onClick:()=>window.open("https://axhub-work.feishu.cn/wiki/space/7585489740036606927","_blank")},{key:"training",label:"åŸ¹è®­æœåŠ¡",icon:e.jsx(Ws,{}),onClick:()=>window.open("https://axhub-work.feishu.cn/wiki/W8KDwcZ8eiB68Nkw4sFcGL4Wn6e","_blank")},{key:"plugin",label:"ç¼–è¾‘å™¨æ‰©å±•",icon:e.jsx(Ht,{}),extra:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(It,{status:_.some(f=>f.type==="vscode"||f.type==="cursor")?"success":"default"}),e.jsx("span",{style:{marginLeft:4,fontSize:12,color:_.some(f=>f.type==="vscode"||f.type==="cursor")?"#52c41a":u.colorTextSecondary},children:_.some(f=>f.type==="vscode"||f.type==="cursor")?"å·²è¿æ¥":"æœªè¿æ¥"})]}),onClick:()=>window.open("https://static.axhub.im/chrome/axhub.vsix","_blank")},{key:"site",label:"Axhub å®˜ç½‘",icon:e.jsx(kt,{}),onClick:()=>window.open("https://axhub.im/","_blank")},{type:"divider"},{key:"version",label:"å½“å‰ç‰ˆæœ¬",icon:e.jsx(He,{}),extra:e.jsx("span",{style:{fontSize:12,color:u.colorTextSecondary},children:q?`v${q}`:"-"})}]},placement:"bottomRight",children:e.jsx(U,{type:"text",icon:e.jsx(Fs,{})})})]}),(n||g==="spec")&&e.jsx("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:"small",children:g==="spec"?e.jsx(e.Fragment,{children:e.jsx(ae,{title:`åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ ${R==="prd"?"PRD":"SPEC"} æ–‡æ¡£`,children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(ft,{}),onClick:ee})})}):n&&e.jsxs(e.Fragment,{children:[D==="pages"&&e.jsx(ut,{value:P,size:"small",shape:"round",onChange:f=>k(f),options:l}),e.jsx(ae,{title:"åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(ft,{}),onClick:ee})}),e.jsx(ae,{title:"Inspecta ç¼–è¾‘",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(Ut,{}),onClick:E})}),e.jsx(ae,{title:"åˆ·æ–°",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(Hs,{}),onClick:c})}),e.jsx(_s,{content:e.jsxs("div",{style:{width:160},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx(U,{type:"text",icon:e.jsx(Ve,{}),onClick:A,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"å¤åˆ¶æœ¬åœ°é“¾æ¥"}),h&&e.jsx(U,{type:"text",icon:e.jsx(Ve,{}),onClick:J,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"å¤åˆ¶å±€åŸŸç½‘é“¾æ¥"}),e.jsx(U,{type:"text",icon:e.jsx(_e,{}),onClick:N,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"ä¸‹è½½é¡¹ç›®"}),e.jsx(U,{type:"text",icon:e.jsx(Tt,{}),disabled:!0,style:{justifyContent:"flex-start",padding:"4px 8px",height:32},block:!0,children:"å‘å¸ƒåŸå‹"})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{height:1,background:u.colorBorder,margin:"8px 0"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"8px 0px 4px"},children:[e.jsx(Js,{value:Z(),size:128,bordered:!1,style:{marginBottom:8}}),e.jsx(Oe.Text,{type:"secondary",style:{fontSize:12,textAlign:"center"},children:"åŒ WiFi çš„æ‰‹æœºæ‰«ç é¢„è§ˆ"})]})]})]}),trigger:"click",placement:"bottomRight",open:X,onOpenChange:z,arrow:!1,children:e.jsx(ae,{title:"åˆ†äº«",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(Vs,{})})})}),e.jsx(dt,{trigger:["click"],placement:"bottomCenter",onOpenChange:f=>{f&&G()},menu:{items:[{key:"push",label:"ä¸€é”®æ¨é€",extra:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(It,{status:_.some(f=>f.type==="figma")?"success":"default"}),e.jsx("span",{style:{marginLeft:4},children:_.some(f=>f.type==="figma")?"å·²è¿æ¥":"æœªè¿æ¥"})]}),icon:e.jsx(Tt,{}),disabled:!_.some(f=>f.type==="figma")},{type:"divider"},{key:"download-json",label:"ä¸‹è½½ JSON",icon:e.jsx(_e,{})},{key:"download-axure",label:"ä¸‹è½½ JSON",extra:"é€‚é… Axure",icon:e.jsx(Ee,{})}],onClick:({key:f})=>{f==="push"?d():f==="download-json"?F(!0):f==="download-axure"&&F(!1)}},children:e.jsx(ae,{trigger:["click","hover"],title:"å¯¼å‡ºåˆ° Figma",children:e.jsx(U,{type:"text",size:"small",icon:e.jsx(Cn,{})})})}),e.jsx(U,{type:"primary",size:"small",style:{fontSize:"12px"},icon:e.jsx(_e,{}),onClick:()=>{W(!0)},children:"å¯¼å‡ºåˆ° Axure"})]})})}),e.jsx(jn,{open:O,onClose:()=>V(!1)}),e.jsx(bn,{open:w,onClose:()=>x(!1)})]})}const kn=({width:o,height:i,children:n,scale:g=1})=>e.jsx("div",{style:{position:"relative",padding:"12px",background:"#1f1f1f",borderRadius:"40px",boxShadow:"0 20px 40px rgba(0,0,0,0.2)",border:"4px solid #333",display:"flex",flexDirection:"column",transform:`scale(${g})`,transformOrigin:"center center"},children:e.jsx("div",{style:{width:o,height:i,background:"#fff",borderRadius:"32px",overflow:"hidden",position:"relative"},children:n})}),{Content:In}=ze,{useToken:Tn}=Le;function An({containerRef:o,selectedItem:i,activeTab:n,currentDevice:g,displaySize:p,scale:D,elementIframeKey:P,iframeUrl:k,elementIframeSize:l,setElementIframeSize:E,viewMode:c}){const{token:A}=Tn();return e.jsx(In,{ref:o,style:{background:A.colorBgLayout,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:i?c==="spec"?e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none",display:"block"},title:i.displayName},P):n==="pages"&&g.id!=="desktop"?e.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(kn,{width:p.width,height:p.height,scale:D,children:e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none"},title:i.displayName},P)})}):n==="elements"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:e.jsx("div",{style:{position:"relative",display:"inline-block"},children:e.jsx(Gs,{size:l,onResize:(J,N,Z)=>{if(Z){const X=Z.getBoundingClientRect();E({width:X.width,height:X.height})}},minWidth:50,minHeight:50,bounds:"window",enable:{top:!1,right:!0,bottom:!0,left:!1,topRight:!1,bottomRight:!0,bottomLeft:!1,topLeft:!1},handleStyles:{right:{width:"8px",right:"-4px",background:"transparent",borderRadius:"4px",transition:"all 0.2s"},bottom:{height:"8px",bottom:"-4px",background:"transparent",borderRadius:"4px",transition:"all 0.2s"},bottomRight:{width:"12px",height:"12px",right:"-6px",bottom:"-6px",background:"transparent",borderRadius:"0 0 6px 0",transition:"all 0.2s"}},handleClasses:{right:"resize-handle-right",bottom:"resize-handle-bottom",bottomRight:"resize-handle-bottomRight"},style:{border:`1px solid ${A.colorBorder}`,borderRadius:6,overflow:"hidden",background:A.colorBgContainer,boxShadow:A.boxShadow,transition:"box-shadow 0.2s"},className:"ant-card-hoverable",children:e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none"},title:i.displayName},P)})})}):e.jsx("iframe",{src:k,style:{width:"100%",height:"100%",border:"none",display:"block"},title:i.displayName},P):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:A.colorTextSecondary},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Ks,{style:{fontSize:"64px",marginBottom:"16px"}}),e.jsxs("div",{style:{fontSize:"16px"},children:["è¯·ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ª",n==="elements"?"å…ƒç´ ":"é¡µé¢"]})]})})})}const{Dragger:Rn}=_t,{Text:Pn,Title:En}=Oe;function Dn({visible:o,onClose:i,onOk:n,onSendPrompt:g,activeTab:p,createName:D,setCreateName:P,createReference:k,setCreateReference:l,createMode:E,setCreateMode:c,generateAxure:A,setGenerateAxure:J,referenceItems:N,selectedThemes:Z,setSelectedThemes:X,availableThemes:z,selectedLibraries:_,setSelectedLibraries:G,availableLibraries:d,selectedDocs:F,setSelectedDocs:W,availableDocs:ee,selectedDataAssets:te,setSelectedDataAssets:K,availableDataAssets:R}){const{token:q}=Le.useToken(),[se,O]=r.useState(!0),[V,w]=r.useState("create"),[x,h]=r.useState("make"),[L,u]=r.useState([]),[f,$]=r.useState(!1),[y,B]=r.useState(null);r.useEffect(()=>{o&&(O(!0),w("create"),h("make"),u([]),$(!1),B(null))},[o]);const Y=j=>{h(j),u([]),B(null)},ne=j=>["make","axhub","google_stitch"].includes(j),Ce=async j=>{const{file:ve,onSuccess:$e,onError:Ue}=j,ke=ve instanceof File?ve:ve.originFileObj,Ie=new FormData;Ie.append("file",ke,ke.name),Ie.append("uploadType",x),Ie.append("targetType",p),console.log("[å‰ç«¯] customRequest ä¸Šä¼ å‚æ•°:",{uploadType:x,targetType:p,fileName:ke.name,fileSize:ke.size}),$(!0);try{const xe=await fetch("/api/upload",{method:"POST",body:Ie}),ue=await xe.json();console.log("[å‰ç«¯] æœåŠ¡å™¨å“åº”:",ue),xe.ok&&ue.success?(B(ue),$e(null,ve),ne(x)?(M.success(ue.message||"ä¸Šä¼ å¹¶è§£å‹æˆåŠŸï¼"),setTimeout(()=>{i(),window.location.reload()},1500)):M.success("æ–‡ä»¶å·²è§£å‹ï¼Œè¯·ç‚¹å‡»æŒ‰é’®å¤åˆ¶ Prompt")):(console.error("[å‰ç«¯] ä¸Šä¼ å¤±è´¥:",ue),M.error(ue.error||"ä¸Šä¼ å¤±è´¥"),Ue(new Error(ue.error||"ä¸Šä¼ å¤±è´¥")))}catch(xe){console.error("[å‰ç«¯] ä¸Šä¼ é”™è¯¯:",xe),M.error("ä¸Šä¼ å¤±è´¥: "+xe.message),Ue(xe)}finally{$(!1)}},be=()=>{if(!y||!y.prompt){M.error("æ²¡æœ‰å¯å¤åˆ¶çš„ Prompt");return}navigator.clipboard.writeText(y.prompt).then(()=>{M.success("Prompt å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œè¯·ç²˜è´´ç»™ AI å®Œæˆå¯¼å…¥")}).catch(j=>{console.error("å¤åˆ¶å¤±è´¥:",j),M.error("å¤åˆ¶å¤±è´¥")})},Ge=()=>V==="create"?e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx(U,{onClick:g,disabled:!1,children:"å‘é€åˆ° Cursor"}),e.jsx(U,{type:"primary",onClick:n,disabled:!1,children:"å¤åˆ¶ Prompt"})]}):ne(x)?e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:e.jsx(U,{onClick:i,children:"å–æ¶ˆ"})}):e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx(U,{onClick:i,children:"å…³é—­"}),e.jsx(U,{type:"primary",onClick:be,disabled:!y,children:"å¤åˆ¶ Prompt ç»™ AI å®Œæˆå¯¼å…¥"})]}),Ke={name:"file",multiple:!1,fileList:L,customRequest:Ce,beforeUpload:j=>{var $e;return j.type==="application/zip"||j.type==="application/x-zip-compressed"||(($e=j.name)==null?void 0:$e.endsWith(".zip"))?!0:(M.error("è¯·ä¸Šä¼  ZIP æ ¼å¼çš„æ–‡ä»¶"),_t.LIST_IGNORE)},onChange:j=>{u(j.fileList.slice(-1))},onRemove:()=>{u([]),B(null)},accept:".zip"},qe=[{key:"make",title:"Axbub Make",description:"æ”¯æŒè‡ªå·±æˆ–ä»–äººçš„ ZIP åŒ…",icon:e.jsx(ft,{style:{fontSize:24,color:"#1890ff"}}),isDirect:!0},{key:"axhub",title:"Axhub æ‰©å±•",description:"å¯å¯¼å‡ºä»»æ„ç½‘é¡µï¼ˆé™æ€ï¼‰",icon:e.jsx(Ht,{style:{fontSize:24,color:"#722ed1"}}),isDirect:!0},{key:"google_stitch",title:"Google Stitch",description:"AI é©±åŠ¨çš„ UI è®¾è®¡å·¥å…·ï¼ˆé™æ€ï¼‰",icon:e.jsx(At,{style:{fontSize:24,color:"#f5222d"}}),isDirect:!0},{key:"v0",title:"V0 App",description:"åœ¨çº¿åº”ç”¨ç”Ÿæˆå¹³å°",icon:e.jsx(Ot,{style:{fontSize:24,color:"#52c41a"}}),isDirect:!1},{key:"google_aistudio",title:"Google AIStudio",description:"åœ¨çº¿åº”ç”¨ç”Ÿæˆå¹³å°",icon:e.jsx(At,{style:{fontSize:24,color:"#faad14"}}),isDirect:!1}],Ye=()=>e.jsxs(re,{requiredMark:!1,labelCol:{style:{width:"120px"}},wrapperCol:{style:{minWidth:0}},children:[e.jsx(re.Item,{label:p==="elements"?"å…ƒç´ åç§°":"é¡µé¢åç§°",children:e.jsx(Se,{placeholder:"ç•™ç©ºåˆ™ç”± AI ç”Ÿæˆï¼Œæ‰¹é‡ç”Ÿæˆå»ºè®®ç•™ç©º",value:D,onChange:j=>P(j.target.value),maxLength:20,showCount:!0})}),N.length>0&&e.jsx(re.Item,{label:"å‚è€ƒæ¡ˆä¾‹",tooltip:`å¯åœ¨${p==="elements"?"å…ƒç´ ":"é¡µé¢"}åˆ—è¡¨ä¸­å°†å…¶è®¾ä¸ºæˆ–å–æ¶ˆä¸ºå‚è€ƒæ¡ˆä¾‹`,children:e.jsx(me,{style:{width:"100%"},placeholder:"ä¸é€‰æ‹©å‚è€ƒæ¡ˆä¾‹",value:k||void 0,onChange:j=>l(j||""),allowClear:!0,options:N.map(j=>({value:j.name,label:j.displayName}))})}),e.jsx("div",{children:e.jsx(U,{type:"link",onClick:()=>O(!se),icon:se?e.jsx(Ys,{}):e.jsx(Zs,{}),style:{padding:0},children:se?"æ›´å¤šé…ç½®":"æ”¶èµ·é…ç½®"})}),!se&&e.jsxs(e.Fragment,{children:[z.length>0&&e.jsx(re.Item,{label:"ä¸»é¢˜",tooltip:"AI ä¼šæ ¹æ®æ‰€é€‰ä¸»é¢˜ç”ŸæˆåŸå‹ï¼Œä¸»é¢˜å¯åœ¨èµ„äº§ç®¡ç†é¡µé¢ä¸­è¿›è¡Œç®¡ç†",children:e.jsx(me,{mode:"multiple",style:{width:"100%"},placeholder:"è¯·é€‰æ‹©ä¸»é¢˜ï¼ˆå¯å¤šé€‰ï¼‰",value:Z,onChange:j=>X(j),allowClear:!0,options:z.map(j=>({value:j.name,label:j.displayName}))})}),R.length>0&&e.jsx(re.Item,{label:"å¼•ç”¨æ•°æ®",tooltip:"AI ä¼šæ ¹æ®æ‰€é€‰æ•°æ®ç”ŸæˆåŸå‹ï¼Œæ•°æ®å¯åœ¨æ•°æ®ç®¡ç†é¡µé¢ä¸­è¿›è¡Œç®¡ç†",children:e.jsx(me,{mode:"multiple",style:{width:"100%"},placeholder:"è¯·é€‰æ‹©å‚è€ƒæ•°æ®ï¼ˆå¯å¤šé€‰ï¼‰",value:te,onChange:j=>K(j),allowClear:!0,options:R.map(j=>({value:j.name,label:j.displayName}))})}),d.length>0&&e.jsx(re.Item,{label:"å‰ç«¯åº“",tooltip:"AI ä¼šæ ¹æ®æ‰€é€‰å‰ç«¯åº“ç”ŸæˆåŸå‹ï¼Œå‰ç«¯åº“å¯åœ¨èµ„äº§ç®¡ç†é¡µé¢ä¸­è¿›è¡Œç®¡ç†",children:e.jsx(me,{mode:"multiple",style:{width:"100%"},placeholder:"è¯·é€‰æ‹©å‰ç«¯åº“ï¼ˆå¯å¤šé€‰ï¼‰",value:_,onChange:j=>G(j),allowClear:!0,options:d.map(j=>({value:j.name,label:j.displayName}))})}),ee.length>0&&e.jsx(re.Item,{label:"å‚è€ƒæ–‡æ¡£",tooltip:"AI ä¼šæ ¹æ®æ‰€é€‰æ–‡æ¡£ç”ŸæˆåŸå‹ï¼Œæ–‡æ¡£å¯åœ¨èµ„äº§ç®¡ç†é¡µé¢ä¸­è¿›è¡Œç®¡ç†",children:e.jsx(me,{mode:"multiple",style:{width:"100%"},placeholder:"è¯·é€‰æ‹©å‚è€ƒæ–‡æ¡£ï¼ˆå¯å¤šé€‰ï¼‰",value:F,onChange:j=>W(j),options:ee.map(j=>({value:j.name,label:j.displayName}))})}),e.jsx(re.Item,{label:"ç”Ÿæˆæµç¨‹",children:e.jsx(me,{style:{width:"100%"},value:E,onChange:j=>c(j),options:[{value:"simultaneous",label:"åŒæ—¶ç”Ÿæˆè§„æ ¼æ–‡æ¡£å’ŒåŸå‹"},{value:"specFirst",label:"æŒ‰ è§„æ ¼æ–‡æ¡£ > åŸå‹ é¡ºåº"}]})}),e.jsx(re.Item,{label:"Axure æ¨¡å¼",tooltip:"ä¸å½±å“å¯¼å‡º Axure ï¼Œå…³é—­åˆ™ä¸ç”Ÿæˆä¸ Axure åŸç”Ÿå…ƒç´ äº¤äº’çš„åŠŸèƒ½ï¼Œä½†å¯ä»¥æå‡ç”Ÿæˆé€Ÿåº¦",children:e.jsx(pt,{checked:A,onChange:j=>J(j)})})]})]}),Ze=()=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[e.jsxs("div",{children:[e.jsx(En,{level:5,style:{marginBottom:16},children:"é€‰æ‹©å¯¼å…¥æ¥æº"}),e.jsx(Xs,{gutter:[16,16],children:qe.map(j=>e.jsx(Qs,{span:12,children:e.jsx(ht,{hoverable:!0,bodyStyle:{padding:16,height:"100%",display:"flex",alignItems:"center"},style:{height:"100%",borderColor:x===j.key?q.colorInfo:void 0,backgroundColor:x===j.key?q.colorFillAlter:void 0},onClick:()=>Y(j.key),children:e.jsx(ht.Meta,{avatar:j.icon,title:e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx(Pn,{ellipsis:!0,style:{fontSize:13,fontWeight:500},children:j.title})}),description:e.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4},children:j.description}),style:{width:"100%"}})})},j.key))})]}),e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:e.jsx("div",{style:{flex:1,minHeight:120},children:e.jsx(Rn,{...Ke,style:{background:"#fafafa",border:"1px dashed #d9d9d9",height:"100%"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"100%",padding:"16px 0"},children:[e.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:8},children:e.jsx(en,{style:{color:q.colorInfo,fontSize:36}})}),e.jsx("p",{className:"ant-upload-text",style:{fontSize:14,marginBottom:4},children:"ç‚¹å‡»æˆ–æ‹–æ‹½ ZIP æ–‡ä»¶ä¸Šä¼ "}),e.jsx("p",{className:"ant-upload-hint",style:{color:"#888",fontSize:12,padding:"0 16px"},children:ne(x)?"å¯¼å…¥åå¯é€šè¿‡ AI è¿›è¡Œç¼–è¾‘å’Œä¼˜åŒ–":"ä¸Šä¼ åéœ€è¦ AI è¾…åŠ©å¯¼å…¥"})]})})})})]});return e.jsx(qs,{placement:"left",destroyOnClose:!0,title:e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsx(ut,{value:V,onChange:j=>w(j),options:[{label:p==="elements"?"æ–°å»ºå…ƒç´ ":"æ–°å»ºé¡µé¢",value:"create"},{label:p==="elements"?"ä¸Šä¼ å…ƒç´ ":"ä¸Šä¼ é¡µé¢",value:"upload"}],style:{fontWeight:500}})}),open:o,onClose:i,width:600,footer:Ge(),styles:{body:{padding:24,overflow:"auto"},header:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"}},children:V==="create"?Ye():Ze()})}const Je={simultaneous:{mode:"simultaneous",displayName:"ç›´æ¥ç”Ÿæˆ",description:"åŒæ—¶ç”Ÿæˆè§„æ ¼æ–‡æ¡£å’ŒåŸå‹ï¼Œé€‚åˆéœ€æ±‚æ˜ç¡®çš„åœºæ™¯",steps:["ç”Ÿæˆ spec.md å’Œ index.tsx"],templates:["spec-template.md"],requiresConfirmation:[!1]},specFirst:{mode:"specFirst",displayName:"è§„æ ¼ä¼˜å…ˆ",description:"å…ˆç”Ÿæˆè§„æ ¼æ–‡æ¡£ï¼Œç¡®è®¤åå†ç”ŸæˆåŸå‹",steps:["ç”Ÿæˆ spec.md","ç”Ÿæˆ index.tsx"],templates:["spec-template.md"],requiresConfirmation:[!0,!1]}};function Nn(o,i){const n=i==="elements"?"å…ƒç´ ":"é¡µé¢",g=i==="elements"?"elements":"pages",p=`src/${g}/${o.name}`,D=`src/${g}/ref-${o.name}`;return`å°† \`${p}\` è®¾ä¸ºå‚è€ƒæ¡ˆä¾‹ï¼š

1. ç§»åŠ¨åˆ° \`${D}\`
2. å‚è€ƒ \`/rules/development-standards.md\`
3. åœ¨ index.tsx é¡¶éƒ¨æ·»åŠ ï¼š
\`\`\`typescript
/**
 * @name ${o.displayName}
 * æœ¬æ–‡ä»¶æ˜¯æ¼”ç¤ºæ–‡ä»¶ï¼Œå±•ç¤º Axhub ${n}å¼€å‘è§„èŒƒ
 * å®é™…å¼€å‘æ—¶åªéœ€ä¿ç•™ @name æ³¨é‡Šï¼Œä¸éœ€è¦è¯¦ç»†çš„è§„èŒƒè¯´æ˜
 */
\`\`\`
4. åœ¨å…³é”®ä»£ç æ®µæ·»åŠ  \`// ã€è§„èŒƒè¯´æ˜ã€‘\` æ³¨é‡Šï¼šå¯¼å…¥é¡ºåºã€Propså¤„ç†ã€Stateç®¡ç†ã€äº‹ä»¶å¤„ç†ã€useImperativeHandleã€JSXæ¸²æŸ“
5. æ³¨é‡Šè§£é‡Š"ä¸ºä»€ä¹ˆ"è€Œé"åšä»€ä¹ˆ"ï¼Œé‡ç‚¹è¯´æ˜æ˜“é”™ç‚¹å’Œæœ€ä½³å®è·µ`}function zn(o){return Object.prototype.hasOwnProperty.call(Je,o)}function On(o){const{hasName:i,displayName:n,itemType:g,hasReference:p,referenceDisplayName:D}=o,P=p&&D?`
å‚è€ƒæ¡ˆä¾‹ï¼š${D}`:"";return i?`**ç³»ç»Ÿäº¤äº’è¦æ±‚**ï¼š
- æ”¶åˆ°æœ¬æ¡ç³»ç»ŸæŒ‡ä»¤åï¼Œå¿…é¡»å…ˆå‘ç”¨æˆ·å›å¤ä¸€æ¬¡ï¼Œå¹¶ç­‰å¾…ç”¨æˆ·è¡¥å……ä¿¡æ¯/ç¡®è®¤ï¼›æœªå®Œæˆå¯¹é½å‰ä¸è¦ç”Ÿæˆä»»ä½•æ–‡ä»¶ã€ä»£ç æˆ–æ–‡æ¡£
- é¦–æ¬¡å›å¤å¿…é¡»ä¸¥æ ¼ä½¿ç”¨ä»¥ä¸‹æ¨¡æ¿ï¼Œä¸è¦è¾“å‡ºå®ç°å†…å®¹

**é¦–æ¬¡å›å¤æ¨¡æ¿**ï¼š
\`\`\`
æ”¶åˆ°ï¼Œå‡†å¤‡åˆ›å»º **${n}** ${g}ã€‚${P}

è¯·è¯¦ç»†æè¿°æ‚¨çš„éœ€æ±‚ï¼š
\`\`\``:`**ç³»ç»Ÿäº¤äº’è¦æ±‚**ï¼š
- æ”¶åˆ°æœ¬æ¡ç³»ç»ŸæŒ‡ä»¤åï¼Œå¿…é¡»å…ˆå‘ç”¨æˆ·å›å¤ä¸€æ¬¡ï¼Œå¹¶ç­‰å¾…ç”¨æˆ·è¡¥å……ä¿¡æ¯/ç¡®è®¤ï¼›æœªå®Œæˆå¯¹é½å‰ä¸è¦ç”Ÿæˆä»»ä½•æ–‡ä»¶ã€ä»£ç æˆ–æ–‡æ¡£
- é¦–æ¬¡å›å¤å¿…é¡»ä¸¥æ ¼ä½¿ç”¨ä»¥ä¸‹æ¨¡æ¿ï¼Œä¸è¦è¾“å‡ºå®ç°å†…å®¹

**é¦–æ¬¡å›å¤æ¨¡æ¿**ï¼š
\`\`\`
æ”¶åˆ°ï¼Œå‡†å¤‡åˆ›å»º${g}ã€‚${P}

è¯·è¯¦ç»†æè¿°æ‚¨çš„éœ€æ±‚ï¼ˆå¦‚éœ€åˆ›å»ºå¤šä¸ª${g}ï¼Œè¯·ä¸€å¹¶è¯´æ˜ï¼‰ï¼š
\`\`\``}function Ln(o){return o?`

**Axure API**ï¼šâœ… å·²å¯ç”¨
- éœ€è¦ä½¿ç”¨ Axure API å®ç°ç»„ä»¶äº¤äº’åŠŸèƒ½
- **âš ï¸ å¿…é¡»å®Œæ•´é˜…è¯» \`/rules/axure-api-guide.md\`ï¼Œä¸è¦è·³è¿‡ï¼**
- è¯¥æ–‡æ¡£åŒ…å«å®Œæ•´çš„ Axure API æ¥å£è§„èŒƒã€ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ`:`

**Axure API**ï¼šâŒ æœªå¯ç”¨
- æœ¬æ¬¡ä½¿ç”¨æ ‡å‡† React ç»„ä»¶å³å¯ï¼Œä¸éœ€è¦ Axure API`}function zt(){return`   - æ–‡ä»¶ç»“æ„è§„èŒƒï¼ˆindex.tsx/spec.md/style.cssï¼‰
   - ä¾èµ–å¼•ç”¨è§„èŒƒã€å‰ç«¯åº“ä½¿ç”¨ã€Design Tokens ä½¿ç”¨
   - State ç®¡ç†ã€æ ·å¼è§„èŒƒã€å¯¼å‡ºè§„èŒƒ
   - å¿…é¡»å¯¼å‡º Component
   - âš ï¸ **éªŒæ”¶æ ‡å‡†**ï¼šå®Œæˆåå¿…é¡»å¯¹ç…§æ­¤æ–‡æ¡£æ£€æŸ¥å®ç°æ˜¯å¦ç¬¦åˆæ‰€æœ‰è§„èŒƒ`}function Vt(o){const{createMode:i,modeConfig:n,generateAxure:g}=o;return i==="simultaneous"?`

**ç”Ÿæˆæ¨¡å¼**ï¼š${n.displayName}
- ${n.description}
- æµç¨‹ï¼š${n.steps.join(" â†’ ")}

**ğŸ“‹ å¿…è¯»è§„èŒƒæ–‡æ¡£**ï¼š
1. **\`/rules/development-standards.md\`** â­ï¸ æœ€é‡è¦ï¼
${zt()}

2. **\`/assets/templates/spec-template.md\`** 
   - spec.md æ–‡æ¡£æ¨¡æ¿ï¼ˆåŒ…å«ï¼šç®€è¦æ¦‚è¿°ã€åŠŸèƒ½è¯´æ˜ã€Axure API è¯´æ˜ï¼‰
   - ä½¿ç”¨æ­¤æ¨¡æ¿ç”Ÿæˆ spec.md æ–‡æ¡£${g?`

3. **\`/rules/axure-api-guide.md\`** âš ï¸ Axure API å¿…è¯»ï¼
   - Axure API å®Œæ•´ä½¿ç”¨æŒ‡å—
   - æ¥å£è§„èŒƒã€å¸¸é‡å®šä¹‰ã€Props å¤„ç†
   - äº‹ä»¶å¤„ç†ã€Container ä½¿ç”¨ã€å®Œæ•´ç¤ºä¾‹`:""}`:i==="specFirst"?`

**ç”Ÿæˆæ¨¡å¼**ï¼š${n.displayName}
- ${n.description}
- æµç¨‹ï¼š${n.steps.join(" â†’ ")}
- **ç¬¬ä¸€æ­¥**ï¼šå®Œæˆéœ€æ±‚å¯¹é½ï¼Œäº§å‡ºå®Œæ•´çš„ spec.mdï¼ˆéœ€è¦ç”¨æˆ·ç¡®è®¤ï¼‰
- **ç¬¬äºŒæ­¥**ï¼šåŸºäº spec.md ç”Ÿæˆä»£ç å®ç°ï¼ˆindex.tsxï¼‰

**ğŸ“‹ å¿…è¯»è§„èŒƒæ–‡æ¡£**ï¼š
1. **\`/rules/development-standards.md\`** â­ï¸ æœ€é‡è¦ï¼
${zt()}

2. **\`/rules/requirements-alignment.md\`**
   - éœ€æ±‚å¯¹é½æµç¨‹å’Œæ²Ÿé€šæ–¹æ³•
   - æŒ‰ç…§æ­¤è§„èŒƒä¸ç”¨æˆ·è¿›è¡Œéœ€æ±‚å¯¹é½

3. **\`/assets/templates/spec-template.md\`**
   - spec.md æ–‡æ¡£æ¨¡æ¿ï¼ˆåŒ…å«ï¼šç®€è¦æ¦‚è¿°ã€åŠŸèƒ½è¯´æ˜ã€Axure API è¯´æ˜ï¼‰
   - ä½¿ç”¨æ­¤æ¨¡æ¿ç”Ÿæˆ spec.md æ–‡æ¡£${g?`

4. **\`/rules/axure-api-guide.md\`** âš ï¸ Axure API å¿…è¯»ï¼
   - Axure API å®Œæ•´ä½¿ç”¨æŒ‡å—
   - æ¥å£è§„èŒƒã€å¸¸é‡å®šä¹‰ã€Props å¤„ç†
   - äº‹ä»¶å¤„ç†ã€Container ä½¿ç”¨ã€å®Œæ•´ç¤ºä¾‹`:""}

**ç¡®è®¤æµç¨‹**ï¼š
- å®Œæˆ spec.md åï¼Œè¯·æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·ï¼š"spec.md å·²å®Œæˆï¼Œè¯·ç¡®è®¤æ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚ç¡®è®¤åå°†ç”Ÿæˆä»£ç å®ç°ã€‚"
- ç­‰å¾…ç”¨æˆ·ç¡®è®¤åå†ç”Ÿæˆ index.tsx`:Vt({createMode:"simultaneous",modeConfig:Je.simultaneous,generateAxure:g})}function Un(o){const{referencePath:i,referenceDisplayName:n}=o;return i?`

**ğŸ“ å‚è€ƒæ¡ˆä¾‹**ï¼ˆâ­ï¸ ä¼˜å…ˆå‚è€ƒï¼‰ï¼š
- è·¯å¾„ï¼š\`${i}\`
- åç§°ï¼š${n}
- **è¯·ä¼˜å…ˆå‚è€ƒæ­¤æ¡ˆä¾‹çš„ä»£ç ç»“æ„å’Œå®ç°æ–¹å¼**
- å­¦ä¹ å…¶æ–‡ä»¶ç»„ç»‡ã€å‘½åè§„èŒƒã€ä»£ç é£æ ¼`:""}function We(o){const{title:i,selected:n,available:g,toLine:p}=o;return n.length===0?"":`

${i}${n.map(D=>{const P=g.find(k=>k.name===D);return`
${p(D,P)}`}).join("")}`}function Mn(o){return o.length?`

**ğŸ¨ ä¸»é¢˜æ–‡ä»¶å†…å®¹**ï¼š${o.map(n=>{const g=[`
- ä¸»é¢˜ï¼š${n.themeName}`];return n.designToken&&g.push(`
  - designToken.json:
\`\`\`json
${n.designToken}
\`\`\``),n.globalsCss&&g.push(`
  - globals.css:
\`\`\`css
${n.globalsCss}
\`\`\``),n.designSpec&&g.push(`
  - DESIGN-SPEC.md: è¯·é˜…è¯» \`/src/themes/${n.themeName}/DESIGN-SPEC.md\``),g.join("")}).join("")}`:""}function Fn(o,i,n,g,p,D=[],P=[],k=[],l=[],E=[],c=[],A=[],J=[],N=!0,Z=[]){const X=i==="elements",z=X?"å…ƒç´ ":"é¡µé¢",_=X?"elements":"pages",G=o.trim().length>0,d=o.trim(),F=g?p.find(u=>u.name===g):null,W=F?`src/${_}/${F.name}`:null,ee=zn(n)?Je[n]:Je.simultaneous,te=G?`**ç³»ç»ŸæŒ‡ä»¤**ï¼šä½ å°†ä½œä¸º Axhub Make åŸå‹å¼€å‘åŠ©æ‰‹ï¼Œåˆ›å»º ${z}ã€Œ**${d}**ã€åŸå‹`:`**ç³»ç»ŸæŒ‡ä»¤**ï¼šä½ å°†ä½œä¸º Axhub Make åŸå‹å¼€å‘åŠ©æ‰‹ï¼Œåˆ›å»ºä¸€ä¸ª${z}åŸå‹`,K=G?`**é‡è¦è¯´æ˜**ï¼š
- æ˜¾ç¤ºåç§°ï¼ˆdisplayNameï¼‰ï¼š**${d}**
- æ–‡ä»¶è·¯å¾„åï¼ˆnameï¼‰ï¼šè¯·æ ¹æ®æ˜¾ç¤ºåç§°ç”Ÿæˆåˆé€‚çš„è‹±æ–‡æˆ–æ‹¼éŸ³è·¯å¾„åï¼ˆå°å†™å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦ï¼‰
- ç›®æ ‡è·¯å¾„ï¼š\`src/${_}/[ç”Ÿæˆçš„è·¯å¾„å]\``:`**é‡è¦è¯´æ˜**ï¼š
- æ˜¾ç¤ºåç§°ï¼ˆdisplayNameï¼‰ï¼š**è¯·æ ¹æ®ç”¨æˆ·éœ€æ±‚è‡ªè¡Œç”Ÿæˆåˆé€‚çš„ä¸­æ–‡åç§°**
- æ–‡ä»¶è·¯å¾„åï¼ˆnameï¼‰ï¼šè¯·æ ¹æ®æ˜¾ç¤ºåç§°ç”Ÿæˆåˆé€‚çš„è‹±æ–‡æˆ–æ‹¼éŸ³è·¯å¾„åï¼ˆå°å†™å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦ï¼‰
- ç›®æ ‡è·¯å¾„ï¼š\`src/${_}/[ç”Ÿæˆçš„è·¯å¾„å]\`
- **å¦‚æœç”¨æˆ·éœ€æ±‚æ¶‰åŠå¤šä¸ª${z}ï¼Œè¯·ä¸ºæ¯ä¸ª${z}ç”Ÿæˆå¯¹åº”çš„åç§°å’Œè·¯å¾„**`,R=On({hasName:G,displayName:d,itemType:z,hasReference:!!F,referenceDisplayName:F==null?void 0:F.displayName}),q=Ln(N),se=Vt({createMode:n,modeConfig:ee,generateAxure:N}),O=Un({referencePath:W,referenceDisplayName:F==null?void 0:F.displayName}),V=We({title:"**ğŸ“š å‚è€ƒæ–‡æ¡£**ï¼ˆç›¸å¯¹è·¯å¾„ /assets/docs/ï¼‰ï¼š",selected:D,available:P,toLine:(u,f)=>`- **\`/assets/docs/${u}\`** - ${(f==null?void 0:f.displayName)||u}`}),w=We({title:"**ğŸ¨ ä¸»é¢˜é…ç½®**ï¼ˆç›¸å¯¹è·¯å¾„ /src/themes/ï¼‰ï¼š",selected:k,available:l,toLine:(u,f)=>`- **\`/src/themes/${u}/designToken.json\`** - ${(f==null?void 0:f.displayName)||u} Design Tokens`}),x=Mn(Z),h=We({title:"**ğŸ“¦ å‰ç«¯åº“æ–‡æ¡£**ï¼ˆç›¸å¯¹è·¯å¾„ /assets/libraries/ï¼‰ï¼š",selected:E,available:c,toLine:(u,f)=>`- **\`/assets/libraries/${u}\`** - ${(f==null?void 0:f.displayName)||u}`}),L=We({title:"**ğŸ“Š å‚è€ƒæ•°æ®**ï¼ˆç›¸å¯¹è·¯å¾„ /assets/database/ï¼‰ï¼š",selected:A,available:J,toLine:(u,f)=>`- **\`/assets/database/${u}\`** - ${(f==null?void 0:f.displayName)||u}`});return`${te}

âš ï¸ **é‡è¦æç¤º**ï¼šè¯·åŠ¡å¿…å®Œæ•´é˜…è¯»ä»¥ä¸‹æ‰€æœ‰è§„èŒƒæ–‡æ¡£å’Œå‚è€ƒèµ„æ–™ï¼Œä¸è¦å·æ‡’ï¼è¿™äº›æ–‡æ¡£åŒ…å«äº†å…³é”®çš„å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µã€‚
${se}${O}${w}${x}${L}${h}${V}${q}

${K}

${R}`}function Bn(o,i,n){const[g,p]=r.useState(!1),[D,P]=r.useState(""),[k,l]=r.useState(()=>localStorage.getItem(Dt)||""),[E,c]=r.useState(()=>localStorage.getItem(Pt)||"simultaneous"),[A,J]=r.useState(()=>localStorage.getItem(Et)==="true"),[N,Z]=r.useState([]),[X,z]=r.useState([]),[_,G]=r.useState([]),[d,F]=r.useState([]),[W,ee]=r.useState([]),[te,K]=r.useState([]),[R,q]=r.useState([]),[se,O]=r.useState([]),[V,w]=r.useState(!1);r.useEffect(()=>{localStorage.setItem(Pt,E)},[E]),r.useEffect(()=>{localStorage.setItem(Et,String(A))},[A]),r.useEffect(()=>{localStorage.setItem(Dt,k)},[k]);const x=r.useMemo(()=>(o==="elements"?i.elements:i.pages).filter(y=>y.isReference),[i,o]);r.useEffect(()=>{if(!V)return;(async()=>{try{const y=await fetch("/api/docs");if(y.ok){const B=await y.json();K(B);const Y=B.find(ne=>ne.name==="è®¾è®¡æŒ‡å¯¼ï¼ˆç®€çº¦ï¼‰.md"||ne.name.startsWith("è®¾è®¡æŒ‡å¯¼ï¼ˆç®€çº¦ï¼‰"));Y&&W.length===0&&ee([Y.name])}}catch(y){console.error("Failed to load docs:",y)}})()},[V]),r.useEffect(()=>{if(!V)return;(async()=>{try{const y=await fetch("/api/themes");if(y.ok){const B=await y.json();z(B)}}catch(y){console.error("Failed to load themes:",y)}})()},[V]),r.useEffect(()=>{if(!V)return;(async()=>{try{const y=await fetch("/api/libraries");if(y.ok){const B=await y.json();F(B);const Y=B.find(ne=>ne.name==="tailwind-css.md"||ne.name.startsWith("tailwind-css"));Y&&_.length===0&&G([Y.name])}}catch(y){console.error("Failed to load libraries:",y)}})()},[V]),r.useEffect(()=>{if(!V)return;(async()=>{try{const y=await fetch("/api/data/tables");if(y.ok){const Y=(await y.json()).map(ne=>({name:`${ne.fileName}.json`,displayName:ne.tableName}));O(Y)}}catch(y){console.error("Failed to load data assets:",y)}})()},[V]),r.useEffect(()=>{g&&(k&&(x.some(y=>y.name===k)||l("")),w(!0))},[g,x,k]);const h=async()=>{console.log("=== ç‚¹å‡»äº†ç”Ÿæˆ AI Prompt æŒ‰é’® ==="),console.log("createName:",D),console.log("createReference:",k),console.log("createMode:",E),console.log("activeTab:",o);const $=await L();$&&(console.log("å¼€å§‹å¤åˆ¶ Prompt åˆ°å‰ªè´´æ¿..."),console.log("Prompt é•¿åº¦:",$.length),navigator.clipboard.writeText($).then(()=>{console.log("âœ… å¤åˆ¶æˆåŠŸ"),p(!1),P(""),ee([]),Z([]),G([]),q([]),n.success("å¤åˆ¶æˆåŠŸï¼Œè¯·è¿”å› IDE å‘é€ç»™ AI"),w(!1),K([]),z([]),F([]),O([])}))},L=async()=>{let $=[];if(N.length>0)try{$=await Promise.all(N.map(async y=>{const B=await fetch("/api/themes/get-contents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({themeName:y})});if(!B.ok){const ne=await B.json().catch(()=>null);throw new Error((ne==null?void 0:ne.error)||"ä¸»é¢˜å†…å®¹è·å–å¤±è´¥")}const Y=await B.json();return{themeName:y,designToken:(Y==null?void 0:Y.designToken)??null,globalsCss:(Y==null?void 0:Y.globalsCss)??null,designSpec:(Y==null?void 0:Y.designSpec)??null}}))}catch(y){console.error("Failed to load theme contents:",y),n.error((y==null?void 0:y.message)||"ä¸»é¢˜å†…å®¹è·å–å¤±è´¥")}return Fn(D,o,E,k,x,W,te,N,X,_,d,R,se,A,$)};return{createDialogVisible:g,createName:D,createReference:k,createMode:E,generateAxure:A,referenceItems:x,selectedThemes:N,availableThemes:X,selectedLibraries:_,availableLibraries:d,selectedDocs:W,availableDocs:te,selectedDataAssets:R,availableDataAssets:se,setCreateDialogVisible:p,setCreateName:P,setCreateReference:l,setCreateMode:c,setGenerateAxure:J,setSelectedThemes:Z,setSelectedLibraries:G,setSelectedDocs:ee,setSelectedDataAssets:q,handleCreateSubmit:h,handleSendPrompt:async()=>{const $=await L();if(!$)return;const y=n.loading("æ­£åœ¨å‘é€ Prompt...",0);try{const B=async(Y,ne)=>{const Ce=await fetch("/api/ws/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:Y,payload:ne})});if(!Ce.ok){const be=await Ce.json().catch(()=>null);throw new Error((be==null?void 0:be.error)||"å‘é€å¤±è´¥")}};await B("handshake","test-client"),await B("insert",$),n.success("å·²é€šè¿‡ WebSocket å‘é€"),w(!1),K([]),z([]),F([]),O([])}catch(B){n.error((B==null?void 0:B.message)||"å‘é€å¤±è´¥")}finally{y()}},handleCreateCancel:()=>{p(!1),P(""),ee([]),Z([]),G([]),q([]),w(!1),K([]),z([]),F([]),O([])}}}function Wn({isDarkMode:o,setIsDarkMode:i}){const[n,g]=r.useState(!0),[p,D]=r.useState({elements:[],pages:[]}),[P,k]=r.useState(!1),[l,E]=r.useState(()=>{const t=localStorage.getItem(Rt);return t==="elements"||t==="pages"?t:"elements"}),[c,A]=r.useState(null),[J,N]=r.useState("desktop"),[Z,X]=r.useState(1),z=je.useRef(null),[_,G]=r.useState(""),[d,F]=M.useMessage(),[W,ee]=Pe.useModal(),[te,K]=r.useState({width:600,height:400}),[R,q]=r.useState(0),[se,O]=r.useState(!1),[V,w]=r.useState("demo"),[x,h]=r.useState("spec"),{createDialogVisible:L,createName:u,createReference:f,createMode:$,generateAxure:y,referenceItems:B,selectedThemes:Y,availableThemes:ne,selectedLibraries:Ce,availableLibraries:be,selectedDocs:Ge,availableDocs:Ke,selectedDataAssets:qe,availableDataAssets:Ye,setCreateDialogVisible:Ze,setCreateName:j,setCreateReference:ve,setCreateMode:$e,setGenerateAxure:Ue,setSelectedThemes:ke,setSelectedLibraries:Ie,setSelectedDocs:xe,setSelectedDataAssets:ue,handleCreateSubmit:Jt,handleSendPrompt:Gt,handleCreateCancel:Kt}=Bn(l,p,d),qt=()=>{const t=`${window.location.protocol}//${window.location.hostname}:${window.location.port}${(c==null?void 0:c.demoUrl)||""}`;navigator.clipboard.writeText(t).then(()=>{d.success("æœ¬åœ°é“¾æ¥å·²å¤åˆ¶")}).catch(s=>{d.error("å¤åˆ¶å¤±è´¥"),console.error("å¤åˆ¶å¤±è´¥:",s)}),O(!1)},Yt=()=>{const t=wt();navigator.clipboard.writeText(t).then(()=>{d.success("å±€åŸŸç½‘é“¾æ¥å·²å¤åˆ¶")}).catch(s=>{d.error("å¤åˆ¶å¤±è´¥"),console.error("å¤åˆ¶å¤±è´¥:",s)}),O(!1)},Zt=()=>{window.open("/api/download-dist","_blank"),O(!1)},Xt=async()=>{let t="",s="";const a=["vscode","cursor"];if(c){const m=c;if(V==="spec"){const v=x==="prd"?"prd.md":"spec.md";t=`src/${l}/${c.name}/${v}`,s=`[${c.displayName} - ${v==="prd.md"?"PRD":"SPEC"}](${Fe(c)}/${v})`}else{if(m.filePath){const v=m.filePath.indexOf("src/");v>=0?t=m.filePath.substring(v):t=m.filePath}else t=`src/${l}/${c.name}/index.tsx`;s=`[${c.displayName}](${Fe(c)})`}}else{d.warning("è¯·å…ˆé€‰æ‹©æ¡ç›®");return}const b=d.loading("æ­£åœ¨å‘é€åˆ° IDE...",0);try{s&&await navigator.clipboard.writeText(s);const m=await mt.sendWsMessage({type:"handshake",payload:"prototype-admin",targetClientTypes:a});if(!(m!=null&&m.sent)){d.warning("ç¼–è¾‘å™¨æœªè¿æ¥ï¼Œå·²å¤åˆ¶äº†æ–‡ä»¶æ ‡é¢˜ï¼Œå¯å‰å¾€ä½¿ç”¨");return}const v=await mt.sendWsMessage({type:"open-file",payload:t,targetClientTypes:a});if(!(v!=null&&v.sent)){d.warning("ç¼–è¾‘å™¨æœªè¿æ¥ï¼Œå·²å¤åˆ¶äº†æ–‡ä»¶æ ‡é¢˜ï¼Œå¯å‰å¾€ä½¿ç”¨");return}d.success("å·²åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ï¼Œå¹¶å¤åˆ¶äº†æ–‡ä»¶æ ‡é¢˜ï¼Œå¯å‰å¾€ç¼–è¾‘")}catch(m){d.error((m==null?void 0:m.message)||"å‘é€å¤±è´¥")}finally{b()}},Qt=async t=>{let s="";if(V==="spec"){const a=x==="prd"?"prd.md":"spec.md";s=`[${t.displayName} - ${a==="prd.md"?"PRD":"SPEC"}](${Fe(t)}/${a})`}else s=`[${t.displayName}](${Fe(t)})`;if(!s){d.warning("æ— æ³•è·å–è·¯å¾„");return}try{await navigator.clipboard.writeText(s),d.success("è·¯å¾„å·²å¤åˆ¶")}catch(a){console.error("Failed to copy: ",a),d.error("å¤åˆ¶å¤±è´¥")}},es=r.useMemo(()=>[{value:"desktop",icon:e.jsx(on,{})},{value:"mobile",icon:e.jsx(rn,{})},{value:"tablet",icon:e.jsx(an,{})}],[]),[Te,Xe]=r.useState(!1),[ts,Qe]=r.useState(!1),[S,fe]=r.useState({width:1920,height:1080,includeConfig:"code",contentType:"title",rawScreenshotUrl:"",screenshotWidth:0,screenshotHeight:0,previewUrl:""});r.useEffect(()=>{De()},[]),r.useEffect(()=>{const t=s=>{s.data&&s.data.type==="SCREENSHOT_CAPTURED"?fe(a=>({...a,rawScreenshotUrl:s.data.dataUrl,screenshotWidth:s.data.width,screenshotHeight:s.data.height})):s.data&&s.data.type==="spec-doc-changed"&&(console.log("Spec document changed:",s.data.activeDocKey),h(s.data.activeDocKey))};return window.addEventListener("message",t),()=>window.removeEventListener("message",t)},[]),r.useEffect(()=>{if(!c)return;if(S.contentType==="screenshot"&&!S.rawScreenshotUrl){fe(s=>({...s,previewUrl:""}));return}(async()=>{const s=l==="elements"?"å…ƒç´ ":"é¡µé¢",a=et(S.rawScreenshotUrl,S,c.displayName,s),b=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),m=URL.createObjectURL(b);fe(v=>({...v,previewUrl:m}))})()},[S.rawScreenshotUrl,S.width,S.height,S.contentType,c,l]);const et=(t,s,a,b)=>{if(s.contentType==="title"){const m=s.width,v=s.height,I=m/2,C=v/2;return`<svg width="${m}" height="${v}" viewBox="0 0 ${m} ${v}" xmlns="http://www.w3.org/2000/svg" role="img">
              <rect width="100%" height="100%" fill="transparent" />
              <g id="textGroup" transform="translate(${I},${C})">
                <!-- Main Title -->
                <text id="mainTitle"
                      x="0" y="-12"
                      text-anchor="middle"
                      font-family="Arial, Helvetica, sans-serif"
                      font-size="28"
                      font-weight="700"
                      fill="#333">
                  ${a}
                </text>

                <!-- Description -->
                <text id="description"
                      x="0" y="18"
                      text-anchor="middle"
                      font-family="Arial, Helvetica, sans-serif"
                      font-size="14"
                      font-weight="400"
                      fill="#999">
                  Axhub Runtime ${b}
                </text>
              </g>
            </svg>`}else return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="${s.width}" height="${s.height}" viewBox="0 0 ${s.width} ${s.height}">
                <rect width="100%" height="100%" fill="transparent" />
                <image x="0" y="0" width="${s.width}" height="${s.height}" preserveAspectRatio="xMidYMin meet" xlink:href="${t}"/>
            </svg>`},Me=je.useRef(!1);r.useEffect(()=>{if(Me.current=!1,S.contentType==="screenshot"){const t=l==="pages"?1920:500,s=l==="pages"?1080:300;fe(a=>({...a,width:t,height:s,screenshotWidth:0,screenshotHeight:0,rawScreenshotUrl:""}))}else S.contentType==="title"&&fe(t=>({...t,width:500,height:300}))},[l,S.contentType]),r.useEffect(()=>{Me.current||S.contentType==="screenshot"&&(!S.screenshotWidth||!S.screenshotHeight||fe(t=>({...t,width:S.screenshotWidth,height:S.screenshotHeight})))},[S.screenshotWidth,S.screenshotHeight]);const ss=(t,s)=>{Me.current=!0,fe(a=>({...a,[t]:s||0}))},ns=()=>{S.contentType==="screenshot"&&Te&&st()},os=()=>{Me.current=!0;const t=S.width,s=S.height;fe(a=>({...a,width:s,height:t})),setTimeout(()=>{S.contentType==="screenshot"&&Te&&st(s,t)},0)};r.useEffect(()=>{localStorage.setItem(Rt,l)},[l]),r.useEffect(()=>{if(!n&&p){const t=l==="elements"?p.elements:p.pages;t.length>0?(A(t[0]),l==="elements"&&K({width:600,height:400})):A(null)}},[n,p,l]);async function De(){var t,s;try{const a=await fetch("/api/entries.json");if(!a.ok)throw new Error("Failed to fetch data");const b=await a.json();console.log("Loaded data:",b),console.log("Reference elements:",(t=b.elements)==null?void 0:t.filter(m=>m.isReference)),console.log("Reference pages:",(s=b.pages)==null?void 0:s.filter(m=>m.isReference)),D(b)}catch(a){d.error("åŠ è½½æ•°æ®å¤±è´¥: "+a.message)}finally{g(!1)}}const Fe=t=>{const s=t;if(s.filePath){const b=s.filePath.indexOf("src/");if(b>=0){let m=s.filePath.substring(b);return m=m.replace(/\/index\.(t|j)sx?$/i,""),m}return s.filePath}return`${l==="pages"?"src/pages":"src/elements"}/${t.name}`},rs=t=>{const s=`${l}/${t.name}`,a=`/api/zip?path=${encodeURIComponent(s)}`;window.open(a,"_blank")},as=t=>{const s=Nn(t,l);navigator.clipboard.writeText(s),d.success("è®¾ç½®ä¸ºå‚è€ƒçš„ Prompt å·²å¤åˆ¶ï¼Œè¯·è¿”å› IDE å‘é€ç»™ AI")},is=t=>{const s=l==="elements"?`elements/${t.name}`:`pages/${t.name}`;W.confirm({title:`ç¡®å®šè¦å–æ¶ˆ "${t.displayName}" çš„å‚è€ƒçŠ¶æ€å—ï¼Ÿ`,content:"å–æ¶ˆåè¯¥é¡¹ç›®å°†ä¸å†æ˜¯å‚è€ƒé¡¹ç›®ã€‚",okText:"ç¡®è®¤",cancelText:"å–æ¶ˆ",async onOk(){const a=d.loading("æ­£åœ¨å–æ¶ˆå‚è€ƒ...",0);try{const b=await fetch("/api/unset-reference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s})});if(!b.ok){const m=await b.json();throw new Error(m.error||"å–æ¶ˆå‚è€ƒå¤±è´¥")}d.success("å·²å–æ¶ˆå‚è€ƒ"),A(null),De()}catch(b){d.error(b.message||"å–æ¶ˆå‚è€ƒå¤±è´¥")}finally{a()}}})},ls=t=>{const s=l==="elements"?"å…ƒç´ ":"é¡µé¢",a=l==="elements"?`elements/${t.name}`:`pages/${t.name}`;let b=t.displayName;W.confirm({title:`é‡å‘½å${s}`,content:e.jsx("div",{children:e.jsx(Se,{autoFocus:!0,defaultValue:t.displayName,placeholder:"è¯·è¾“å…¥æ–°çš„æ˜¾ç¤ºåç§°ï¼ˆæ”¯æŒä¸­æ–‡ï¼‰",onChange:m=>{b=m.target.value}})}),okText:"ç¡®è®¤",cancelText:"å–æ¶ˆ",async onOk(){const m=b.trim();if(!m)return d.error("è¯·è¾“å…¥æ–°çš„åç§°"),Promise.reject();if(m===t.displayName)return;const v=d.loading("æ­£åœ¨é‡å‘½å...",0);try{const I=await fetch("/api/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a,newName:m})});if(!I.ok){const C=await I.json().catch(()=>({}));throw new Error(C.error||"é‡å‘½åå¤±è´¥")}d.success("é‡å‘½åæˆåŠŸ"),A(null),De()}catch(I){return d.error(I.message||"é‡å‘½åå¤±è´¥"),Promise.reject()}finally{v()}}})},cs=async(t,s)=>{const a=await fetch("/api/items/check-references",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemType:t,itemName:s})});if(!a.ok){const b=await a.json().catch(()=>({}));throw new Error(b.error||"æ£€æŸ¥å¼•ç”¨å¤±è´¥")}return a.json()},ds=t=>{if(t.isReference){d.error("å‚è€ƒé¡¹ç›®æ— æ³•åˆ é™¤ï¼Œè¯·å…ˆå–æ¶ˆå‚è€ƒçŠ¶æ€");return}const s=l,a=l==="elements"?"å…ƒç´ ":"é¡µé¢",b=`${s}/${t.name}`,m=async()=>{const I=d.loading("æ­£åœ¨åˆ é™¤...",0);try{const C=await fetch("/api/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:b})});if(!C.ok){const T=await C.json();throw new Error(T.error||"åˆ é™¤å¤±è´¥")}d.success("åˆ é™¤æˆåŠŸ"),A(null),De()}catch(C){d.error(C.message||"åˆ é™¤å¤±è´¥")}finally{I()}};(async()=>{const I=d.loading("æ­£åœ¨æ£€æŸ¥å¼•ç”¨...",0);try{const C=await cs(s,t.name),T=Array.isArray(C==null?void 0:C.references)?C.references:[];if(T.length>0){const H=T.map(Q=>`- ${Q}`).join(`
`),ie=`æˆ‘å¸Œæœ›åˆ é™¤${a} "${t.displayName}" (${t.name})ã€‚
è¯¥${a}ä½äºé¡¹ç›®ä¸­çš„ç›¸å¯¹è·¯å¾„ä¸ºï¼š\`src/${s}/${t.name}\`

å·²æ£€æµ‹åˆ°ä»¥ä¸‹æ–‡ä»¶å¼•ç”¨äº†è¯¥${a}ï¼š
${H}

è¯·å¸®æˆ‘æ‰§è¡Œä»¥ä¸‹æ£€æŸ¥å’Œæ“ä½œï¼š
1. æ ¸å¯¹ä¸Šè¿°å¼•ç”¨æ˜¯å¦å‡†ç¡®ï¼Œå¹¶è¡¥å……é—æ¼çš„å¼•ç”¨æ–‡ä»¶ï¼ˆä¼˜å…ˆæ£€æŸ¥ \`src/elements/\` ä¸ \`src/pages/\`ï¼‰ã€‚
2. å¦‚æœç¡®è®¤ç»§ç»­åˆ é™¤ï¼Œè¯·ååŠ©æˆ‘å°†è¯¥${a}åœ¨å¼•ç”¨å¤„æ›¿æ¢ä¸ºåˆé€‚çš„å®ç°ï¼Œå¹¶æ›´æ–°å¼•ç”¨è·¯å¾„ï¼Œä½¿è¿™äº›åŸå‹ä¸å†ä¾èµ–è¯¥ç›®å½•ã€‚
3. å®Œæˆä¸Šè¿°è§£è€¦æ“ä½œåï¼Œå†å½»åº•åˆ é™¤ç›®å½• \`src/${s}/${t.name}\`ã€‚`;W.confirm({title:`æ£€æµ‹åˆ°${a}å¼•ç”¨`,width:720,okText:"å¤åˆ¶æç¤º",cancelText:"å–æ¶ˆ",content:e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:8},children:["å·²æ£€æµ‹åˆ°ä»¥ä¸‹æ–‡ä»¶å¼•ç”¨äº†è¯¥",a,"ï¼š"]}),e.jsx("pre",{style:{maxHeight:260,overflow:"auto",background:"#f6f7f9",padding:12,borderRadius:6},children:H})]}),async onOk(){try{await navigator.clipboard.writeText(ie),d.success("å·²å¤åˆ¶å¤„ç†æç¤ºï¼Œè¯·è¿”å›ç¼–è¾‘å™¨è®© AI å¤„ç†ã€‚")}catch(Q){console.error("Failed to copy: ",Q),d.error("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤„ç†")}}})}else W.confirm({title:`ç¡®å®šè¦åˆ é™¤${a} "${t.displayName}" å—ï¼Ÿ`,content:"æœªæ£€æµ‹åˆ°å¼•ç”¨æ–‡ä»¶ã€‚åˆ é™¤åæ— æ³•æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œã€‚",okText:"ç¡®è®¤åˆ é™¤",okType:"danger",cancelText:"å–æ¶ˆ",onOk:m})}catch(C){d.error(C.message||"æ£€æŸ¥å¼•ç”¨å¤±è´¥")}finally{I()}})()},hs=async t=>{const s=l==="elements"?"elements":"pages",a=`src/${s}/${t.name}`,b=(v,I)=>{let C=`${v}-copy`,T=1;for(;I.includes(C);)T++,C=`${v}-copy${T}`;return C},m=d.loading("æ­£åœ¨åˆ›å»ºå‰¯æœ¬...",0);try{const v=(l==="elements"?p.elements:p.pages).map(H=>H.name),I=b(t.name,v),C=`src/${s}/${I}`,T=await fetch("/api/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourcePath:a,targetPath:C})});if(!T.ok){const H=await T.json();throw new Error(H.error||"åˆ›å»ºå‰¯æœ¬å¤±è´¥")}d.success(`å‰¯æœ¬ "${I}" åˆ›å»ºæˆåŠŸ`),De()}catch(v){d.error(v.message||"åˆ›å»ºå‰¯æœ¬å¤±è´¥")}finally{m()}},Be=r.useMemo(()=>{const t=l==="elements"?p.elements:p.pages;if(!_)return t;const s=_.toLowerCase();return t.filter(a=>a.displayName.toLowerCase().includes(s)||a.name.toLowerCase().includes(s))},[p,l,_]),ps=({key:t})=>{const s=Be.find(a=>a.name===t);s&&(A(s),h("spec"),l==="elements"&&K({width:600,height:400}))},xt=t=>{E(t),G(""),A(null),h("spec")},us=()=>{q(t=>t+1)},fs=()=>{if(!c)return"";const t=window.location.origin+c.demoUrl,s=new URL(t,window.location.origin);if(s.searchParams.set("inspecta","true"),ye.id!=="desktop"){const a=tt.width?Math.round(tt.width):ye.width;a&&s.searchParams.set("width",String(a))}return s.toString()},ms=()=>{const t=fs();t&&window.open(t,"_blank")},yt=(t=!0)=>new Promise((s,a)=>{const b=document.querySelectorAll("iframe"),m=b[b.length-1];if(!m||!m.contentWindow){a(new Error("æœªæ‰¾åˆ°å¯å¯¼å‡ºçš„é¢„è§ˆçª—å£"));return}const v=window.setTimeout(()=>{window.removeEventListener("message",I),a(new Error("å¯¼å‡ºè¶…æ—¶ï¼Œè¯·é‡è¯•"))},15e3),I=C=>{if(C.source===m.contentWindow&&!(!C.data||C.data.type!=="FIGMA_JSON_READY"))if(window.removeEventListener("message",I),window.clearTimeout(v),C.data.success){const T=C.data.json??C.data.data??C.data.payload;if(T===void 0){a(new Error("å¯¼å‡ºæˆåŠŸä½†æœªè¿”å›æ•°æ®ï¼ˆç¼ºå°‘ json/data/payload å­—æ®µï¼‰"));return}const H=Array.isArray(T)?T:T.layers||[];s({layers:H,widgetId:C.data.widgetId,pageId:C.data.pageId})}else a(new Error(C.data.error||"å¯¼å‡ºå¤±è´¥"))};window.addEventListener("message",I),m.contentWindow.postMessage({type:"EXPORT_FIGMA_JSON",rootName:(c==null?void 0:c.displayName)||(c==null?void 0:c.name),enableAutoLayout:t},"*")}),gs=async(t=!0)=>{if(!c){d.warning("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ¡ç›®");return}const s=d.loading("æ­£åœ¨ç”Ÿæˆ Figma JSON...",0);try{const{layers:a,widgetId:b,pageId:m}=await yt(t),v={layers:a,...b?{widgetId:b}:{},...m?{pageId:m}:{}},I=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),C=URL.createObjectURL(I),T=document.createElement("a");T.href=C,T.download=`${c.name}-${l}.json`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(C),d.success("JSON å·²ä¸‹è½½")}catch(a){d.error((a==null?void 0:a.message)||"å¯¼å‡ºå¤±è´¥")}finally{s()}},wt=()=>{if(!c)return"";const t=c.demoUrl,s=window.__LOCAL_IP__||"localhost",a=window.location.port||(window.location.protocol==="https:"?"443":"80");return`${window.location.protocol}//${s}:${a}${t}`},ye=r.useMemo(()=>at.find(t=>t.id===J)||at[0],[J]);r.useEffect(()=>{at.some(s=>s.id===J)||N("desktop")},[J]);const[tt,jt]=r.useState({width:0,height:0});r.useEffect(()=>{if(ye.id==="desktop"||ye.width===0||!z.current){jt({width:0,height:0}),X(1);return}const t=()=>{if(!z.current)return;const s=z.current.clientWidth*.9,a=z.current.clientHeight*.9,b=ye.width,m=ye.height,C=24+8,T=(s-C)/b,H=(a-C)/m,ie=Math.min(T,H),Q=b*ie,de=m*ie;jt({width:Q,height:de}),X(1)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[ye,P]);const st=(t,s)=>{const a=t??S.width,b=s??S.height,m=document.querySelectorAll("iframe"),v=m[m.length-1];v&&v.contentWindow&&v.contentWindow.postMessage({type:"CAPTURE_SCREENSHOT",targetWidth:a,targetHeight:b},"*")};r.useEffect(()=>{if(Te&&S.contentType==="screenshot"){const t=l==="pages"?1920:500,s=l==="pages"?1080:300;S.width===t&&S.height===s&&st()}if(!Te){const t=document.querySelectorAll("iframe"),s=t[t.length-1];s&&s.contentWindow&&s.contentWindow.postMessage({type:"RESET_SCREENSHOT_STYLES"},"*")}},[Te,S.contentType,S.width,S.height]);const[xs,nt]=r.useState([]),ys=window.location.port||(window.location.protocol==="https:"?"443":"80"),ot=async()=>{try{const t=await fetch("/api/ws/clients");if(t.ok){const a=(await t.json()).clients||[];return nt(a),a}else return nt([]),[]}catch(t){return console.error("Failed to check WS clients",t),nt([]),[]}};r.useEffect(()=>{ot()},[]);const ws=async()=>{if(!c){d.warning("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ¡ç›®");return}const t=d.loading("æ­£åœ¨æ£€æŸ¥è¿æ¥...",0),s=await ot();t(),s.length===0?W.confirm({title:"æœªæ£€æµ‹åˆ° Figma è¿æ¥",content:e.jsxs("div",{children:[e.jsx("p",{children:"è¯·ç¡®ä¿ Figma æ’ä»¶å·²æ‰“å¼€å¹¶è¿æ¥åˆ°å½“å‰æœåŠ¡ã€‚"}),e.jsxs("p",{style:{color:"#999",fontSize:12},children:["å½“å‰æœåŠ¡ç«¯å£: ",ys]})]}),okText:"ä»è¦æ¨é€",cancelText:"å–æ¶ˆ",onOk:()=>bt()}):bt()},bt=async()=>{const t=d.loading("æ­£åœ¨è·å–æ•°æ®...",0);try{const{layers:s,widgetId:a,pageId:b}=await yt();if(t(),!s||!Array.isArray(s)||s.length===0){d.error("å›¾å±‚æ•°æ®ä¸ºç©ºï¼Œæ— æ³•æ¨é€");return}let m;l==="elements"?(a||d.warning("å…ƒç´ ç¼ºå°‘ widgetIdï¼Œå¯èƒ½å¯¼è‡´åŒæ­¥å¤±è´¥"),m={type:"sync-widget-content",widgetId:a||`element-${(c==null?void 0:c.name)||"unknown"}-${Date.now()}`,data:{layers:s},blurImages:!1,metadata:{source:"extension",timestamp:Date.now()}}):m={type:"sync-page-content",...b?{pageId:b}:{},data:{layers:s},blurImages:!1,metadata:{source:"extension",timestamp:Date.now()}};const v=d.loading("æ­£åœ¨æ¨é€åˆ° Figma...",0);try{const I=await fetch("/api/ws/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(I.ok)await I.json(),d.success("æ¨é€æˆåŠŸ");else{const C=await I.text();throw new Error(C||"å‘é€å¤±è´¥")}}catch(I){d.error("æ¨é€å¤±è´¥: "+I.message)}finally{v()}}catch(s){t(),d.error((s==null?void 0:s.message)||"è·å–æ•°æ®å¤±è´¥")}},js=(t,s,a,b=2)=>new Promise((m,v)=>{const I=new Image,C=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),T=URL.createObjectURL(C);I.onload=()=>{const H=document.createElement("canvas");H.width=s*b,H.height=a*b;const ie=H.getContext("2d");if(!ie){v(new Error("Could not get canvas context"));return}ie.drawImage(I,0,0,H.width,H.height),URL.revokeObjectURL(T),m(H.toDataURL("image/png"))},I.onerror=H=>{URL.revokeObjectURL(T),v(H)},I.src=T}),bs=async()=>{if(c){Qe(!0);try{const t=window.location.origin+c.jsUrl,s=await fetch(t);if(!s.ok)throw new Error(`Failed to fetch code: ${s.statusText}`);const a=await s.text();let b="";if(c){const v=`${window.location.origin}/${l}/${c.name}/hack.css`;try{const I=await fetch(v);I.ok&&(b=await I.text())}catch(I){console.warn("fetch hack.css failed",I)}}const m=async(v=!1)=>{const I=`${window.location.origin}/${l}/${c.name}`,C=["spec","prd"],T={};for(const Q of C){const de=`${I}/${Q}.md`;try{const le=await fetch(de);if(le.ok){const ce=await le.text(),he={spec:"è§„æ ¼æ–‡æ¡£",prd:"éœ€æ±‚æ–‡æ¡£"};T[Q]={name:he[Q],content:ce}}}catch(le){console.warn(`Failed to fetch ${Q}.md`,le)}}if(v){const Q=`${l}/${c.name}`,de=`${window.location.origin}/api/source?path=${encodeURIComponent(Q)}`;try{const le=await fetch(de);if(le.ok){const he=`\`\`\`tsx
${await le.text()}
\`\`\`
`;T.code={name:"å‚è€ƒä»£ç ",content:he}}}catch(le){console.warn("Failed to fetch source code",le)}}const H=Object.keys(T);return H.length>1?T:H.length===1?T[H[0]].content:null};if(S.contentType==="screenshot"&&!S.rawScreenshotUrl){d.warning("æ­£åœ¨ç”Ÿæˆæˆªå›¾ï¼Œè¯·ç¨å€™..."),Qe(!1);return}try{let v="",I="";if(S.includeConfig!=="none"&&(v=a,S.includeConfig==="codeAndDocs"||S.includeConfig==="codeAndDocsAndSource")){const pe=S.includeConfig==="codeAndDocsAndSource",we=await m(pe);we&&(I=we)}const C=l==="elements"?"å…ƒç´ ":"é¡µé¢";let T="";if(S.contentType==="title"){const pe=et("",S,c.displayName,C),we=await js(pe,S.width,S.height,2);T=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="${S.width}" height="${S.height}" viewBox="0 0 ${S.width} ${S.height}">
                            <rect width="100%" height="100%" fill="transparent" />
                            <image x="0" y="0" width="${S.width}" height="${S.height}" preserveAspectRatio="xMidYMin meet" xlink:href="${we}"/>
                        </svg>`}else T=et(S.rawScreenshotUrl,S,c.displayName,C);const ie=new DOMParser().parseFromString(T,"image/svg+xml"),Q=ie.querySelector("svg");if(!Q)throw new Error("SVG generation failed");if(v||I){const pe={code:v,spec:I};Q.setAttribute("AxExtraData",encodeURIComponent(JSON.stringify(pe)))}if(S.includeConfig!=="none"){const pe={time:Math.floor(Date.now()/1e3),config:{codeLink:t,...l==="pages"?{isFullScreen:!0}:{},...b?{hackCss:b}:{}}};Q.setAttribute("AxData",encodeURIComponent(JSON.stringify(pe)))}const le=new XMLSerializer().serializeToString(ie),ce=new Blob([le],{type:"image/svg+xml;charset=utf-8"}),he=URL.createObjectURL(ce),oe=document.createElement("a");oe.href=he,oe.download=`${c.name}.svg`,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe),URL.revokeObjectURL(he),d.success("SVG å¯¼å‡ºæˆåŠŸ"),Xe(!1)}catch(v){console.error("Image export failed:",v),d.error("å›¾ç‰‡å¯¼å‡ºå¤±è´¥")}}catch(t){d.error(`å¯¼å‡ºå¤±è´¥: ${t.message}`),console.error("å¯¼å‡ºå¤±è´¥:",t)}finally{Qe(!1)}}},vs=async t=>{if(!c)throw new Error("æœªé€‰æ‹©é¡¹ç›®");const s=window.location.origin+c.jsUrl,a=await fetch(s);if(!a.ok)throw new Error(`Failed to fetch code: ${a.statusText}`);const b=await a.text();let m="";const v=`${window.location.origin}/${l}/${c.name}/hack.css`;try{const T=await fetch(v);T.ok&&(m=await T.text())}catch{}const I=async(T=!1)=>{const H=`${window.location.origin}/${l}/${c.name}`,ie=["spec","prd"],Q={};for(const ce of ie){const he=`${H}/${ce}.md`;try{const oe=await fetch(he);if(oe.ok){const pe=await oe.text(),we={spec:"è§„æ ¼æ–‡æ¡£",prd:"éœ€æ±‚æ–‡æ¡£"};Q[ce]={name:we[ce],content:pe}}}catch(oe){console.warn(`Failed to fetch ${ce}.md`,oe)}}if(T){const ce=`${l}/${c.name}`,he=`${window.location.origin}/api/source?path=${encodeURIComponent(ce)}`;try{const oe=await fetch(he);if(oe.ok){const we=`\`\`\`tsx
${await oe.text()}
\`\`\`
`;Q.code={name:"å‚è€ƒä»£ç ",content:we}}}catch(oe){console.warn("Failed to fetch source code",oe)}}const de=Object.keys(Q);return de.length>1?Q:de.length===1?Q[de[0]].content:null},C={time:Math.floor(Date.now()/1e3),config:{code:b,...l==="pages"?{isFullScreen:!0}:{},...m?{hackCss:m}:{}}};if(t==="codeAndDocs"||t==="codeAndDocsAndSource"){const H=await I(t==="codeAndDocsAndSource");H&&(C.config.spec=H)}return JSON.stringify(C,null,2)},Ss=c?V==="spec"?c.specUrl:c.demoUrl:"",Cs=t=>{const s=window.location.origin+t.demoUrl;window.open(s,"_blank")};return e.jsxs(ze,{style:{minHeight:"100vh"},children:[F,e.jsx("style",{children:`
                .resize-handle-right {
                    cursor: ew-resize !important;
                    z-index: 100 !important;
                }
                .resize-handle-right::before {
                    content: '';
                    position: absolute;
                    right: 50%;
                    top: 50%;
                    transform: translate(50%, -50%);
                    width: 2px;
                    height: 40px;
                    background: var(--ant-color-border);
                    border-radius: 1px;
                    transition: all 0.2s;
                    z-index: 100;
                }
                .resize-handle-right:hover::before,
                .resize-handle-right:active::before {
                    background: var(--ant-color-text-secondary);
                    width: 3px;
                    height: 50px;
                }
                .resize-handle-bottom {
                    cursor: ns-resize !important;
                    z-index: 100 !important;
                }
                .resize-handle-bottom::before {
                    content: '';
                    position: absolute;
                    left: 50%;
                    bottom: 50%;
                    transform: translate(-50%, 50%);
                    width: 40px;
                    height: 2px;
                    background: var(--ant-color-border);
                    border-radius: 1px;
                    transition: all 0.2s;
                    z-index: 100;
                }
                .resize-handle-bottom:hover::before,
                .resize-handle-bottom:active::before {
                    background: var(--ant-color-text-secondary);
                    width: 50px;
                    height: 3px;
                }
                .resize-handle-bottomRight {
                    cursor: nwse-resize !important;
                    z-index: 100 !important;
                }
                .resize-handle-bottomRight::before {
                    content: '';
                    position: absolute;
                    right: 0;
                    bottom: 0;
                    width: 12px;
                    height: 12px;
                    background: var(--ant-color-border);
                    border-radius: 0 0 6px 0;
                    transition: all 0.2s;
                    z-index: 100;
                }
                .resize-handle-bottomRight:hover::before,
                .resize-handle-bottomRight:active::before {
                    background: var(--ant-color-border-secondary);
                    width: 16px;
                    height: 16px;
                }
                /* å®¹å™¨æ‚¬åœæ—¶æ˜¾ç¤ºæ‰‹æŸ„ */
                .ant-card-hoverable:hover .resize-handle-right::before,
                .ant-card-hoverable:hover .resize-handle-bottom::before,
                .ant-card-hoverable:hover .resize-handle-bottomRight::before {
                    background: var(--ant-color-border-secondary);
                }

                /* èœå•é¡¹ hover æ—¶æ˜¾ç¤ºæ›´å¤šæŒ‰é’® */
                .menu-item-wrapper .more-btn {
                    opacity: 0;
                    transition: opacity 0.2s;
                }
                .menu-item-wrapper:hover .more-btn,
                .menu-item-wrapper.is-selected .more-btn,
                .menu-item-wrapper .more-btn.ant-dropdown-open {
                    opacity: 1;
                }

                /* ç§»åŠ¨ç«¯å“åº”å¼æ ·å¼ */
                @media (max-width: 768px) {
                    /* éšè— PC ç«¯çš„å®Œæ•´å¸ƒå±€ */
                    .pc-layout {
                        display: none !important;
                    }
                    
                    /* æ˜¾ç¤ºç§»åŠ¨ç«¯ç®€åŒ–å¸ƒå±€ */
                    .mobile-layout {
                        display: block !important;
                    }
                }

                @media (min-width: 769px) {
                    /* PC ç«¯æ˜¾ç¤ºå®Œæ•´å¸ƒå±€ */
                    .pc-layout {
                        display: block !important;
                    }
                    
                    /* éšè—ç§»åŠ¨ç«¯å¸ƒå±€ */
                    .mobile-layout {
                        display: none !important;
                    }
                }

                /* ç§»åŠ¨ç«¯åˆ—è¡¨æ ·å¼ */
                .mobile-item-card {
                    background: ${o?"#1f1f1f":"#fff"};
                    border: 1px solid ${o?"#303030":"#f0f0f0"};
                    border-radius: 8px;
                    padding: 16px;
                    margin-bottom: 12px;
                    cursor: pointer;
                    transition: all 0.2s;
                }

                .mobile-item-card:hover {
                    border-color: ${o?"#177ddc":"#1890ff"};
                    box-shadow: 0 2px 8px ${o?"rgba(0,0,0,0.3)":"rgba(0,0,0,0.1)"};
                }

                .mobile-item-card:active {
                    transform: scale(0.98);
                }

                .mobile-item-title {
                    font-size: 16px;
                    font-weight: 500;
                    color: ${o?"#fff":"#000"};
                    margin-bottom: 4px;
                }

                .mobile-item-name {
                    font-size: 12px;
                    color: ${o?"#8c8c8c":"#999"};
                }
            `}),e.jsxs("div",{className:"pc-layout",children:[e.jsx($n,{collapsed:P,setCollapsed:k,selectedItem:c,viewMode:V,setViewMode:w,activeTab:l,selectedDeviceId:J,setSelectedDeviceId:N,deviceSegmentOptions:es,handleOpenInspect:ms,handleRefreshElement:us,handleCopyLocalLink:qt,handleCopyLANLink:Yt,handleDownloadZip:Zt,getLANUrl:wt,qrCodeVisible:se,setQrCodeVisible:O,wsClients:xs,checkConnection:ot,handlePushToFigma:ws,handleDownloadFigmaJson:gs,setIsExportModalOpen:Xe,handleOpenIdeFile:Xt,isDarkMode:o,setIsDarkMode:i,currentSpecDocKey:x}),e.jsxs(ze,{children:[e.jsx(mn,{collapsed:P,loading:n,activeTab:l,handleTabChange:xt,data:p,searchText:_,setSearchText:G,filteredItems:Be,selectedItem:c,handleMenuClick:ps,handleDownloadItemSource:rs,handleRenameItem:ls,handleSetReference:as,handleUnsetReference:is,handleDuplicateItem:hs,handleDeleteItem:ds,handleCopyItemPath:Qt,setCreateDialogVisible:Ze}),e.jsx(An,{containerRef:z,selectedItem:c,activeTab:l,currentDevice:ye,displaySize:tt,scale:Z,elementIframeKey:R,iframeUrl:Ss,elementIframeSize:te,setElementIframeSize:K,viewMode:V})]}),e.jsx(Dn,{visible:L,onClose:Kt,onOk:Jt,onSendPrompt:Gt,activeTab:l,createName:u,setCreateName:j,createReference:f,setCreateReference:ve,createMode:$,setCreateMode:$e,generateAxure:y,setGenerateAxure:Ue,referenceItems:B,selectedDocs:Ge,setSelectedDocs:xe,availableDocs:Ke,selectedThemes:Y,setSelectedThemes:ke,availableThemes:ne,selectedDataAssets:qe,setSelectedDataAssets:ue,availableDataAssets:Ye,selectedLibraries:Ce,setSelectedLibraries:Ie,availableLibraries:be}),e.jsx(dn,{open:Te,onClose:()=>Xe(!1),imageConfig:S,setImageConfig:fe,onDimensionChange:ss,onSwapDimensions:os,onDimensionBlur:ns,isExporting:ts,onExport:bs,onCopyConfig:vs,activeTab:l,itemName:c==null?void 0:c.name})]}),e.jsx("div",{className:"mobile-layout",style:{display:"none"},children:e.jsxs("div",{style:{padding:"16px",minHeight:"100vh",background:o?"#141414":"#f5f5f5"},children:[e.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("div",{children:e.jsxs("h1",{style:{margin:0,fontSize:"24px",fontWeight:600,color:o?"#fff":"#000"},children:["Axhub ",e.jsx("span",{style:{color:"#008F5D"},children:"Make"})]})}),e.jsx(U,{type:"text",icon:o?e.jsx(Bt,{}):e.jsx(Wt,{}),onClick:()=>i(!o)})]}),e.jsx(gt,{activeKey:l,onChange:t=>xt(t),style:{marginBottom:"16px"},items:[{key:"pages",label:`é¡µé¢ (${p.pages.length})`,icon:e.jsx(Ee,{})},{key:"elements",label:`å…ƒç´  (${p.elements.length})`,icon:e.jsx(ct,{})}]}),e.jsx(Se,{placeholder:"æœç´¢...",prefix:e.jsx(Mt,{}),value:_,onChange:t=>G(t.target.value),allowClear:!0,style:{marginBottom:"16px"}}),n?e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(Ne,{tip:"åŠ è½½ä¸­..."})}):e.jsx("div",{children:Be.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:o?"#8c8c8c":"#999"},children:["æš‚æ— ",l==="elements"?"å…ƒç´ ":"é¡µé¢"]}):Be.map(t=>e.jsxs("div",{className:"mobile-item-card",onClick:()=>Cs(t),children:[e.jsx("div",{className:"mobile-item-title",children:t.displayName}),e.jsx("div",{className:"mobile-item-name",children:t.name})]},t.name))})]})}),F,ee]})}function Hn(){const[o,i]=r.useState(()=>{try{return localStorage.getItem(Nt)==="true"}catch{return!1}}),n=g=>{i(g);try{localStorage.setItem(Nt,String(g))}catch(p){console.error("Failed to save dark mode preference:",p)}};return e.jsx(sn,{theme:ln(o),children:e.jsx(nn,{children:e.jsx(Wn,{isDarkMode:o,setIsDarkMode:n})})})}const _n=tn.createRoot(document.getElementById("root"));_n.render(e.jsx(Hn,{}));
